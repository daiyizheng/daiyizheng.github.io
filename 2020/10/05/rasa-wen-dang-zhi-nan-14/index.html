<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Rasaæ–‡æ¡£æŒ‡å—(14), å‘†å°ç—‡æ—¥è®°">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>Rasaæ–‡æ¡£æŒ‡å—(14) | å‘†å°ç—‡æ—¥è®°</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.0.0"><link rel="alternate" href="/atom.xml" title="å‘†å°ç—‡æ—¥è®°" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">å‘†å°ç—‡æ—¥è®°</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>é¦–é¡µ</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>æ ‡ç­¾</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>åˆ†ç±»</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>å½’æ¡£</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>å…³äº</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>ç•™è¨€æ¿</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>å‹æƒ…é“¾æ¥</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="æœç´¢" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">å‘†å°ç—‡æ—¥è®°</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			é¦–é¡µ
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			æ ‡ç­¾
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			åˆ†ç±»
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			å½’æ¡£
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			å…³äº
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			ç•™è¨€æ¿
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			å‹æƒ…é“¾æ¥
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/9.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Rasaæ–‡æ¡£æŒ‡å—(14)</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- æ–‡ç« å†…å®¹è¯¦æƒ… -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Rasa/">
                                <span class="chip bg-color">Rasa</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/nlp/" class="post-category">
                                nlp
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>å‘å¸ƒæ—¥æœŸ:&nbsp;&nbsp;
                    2020-10-05
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="Rasaæ ¸å¿ƒå¯¹è¯å¼•æ“"><a href="#Rasaæ ¸å¿ƒå¯¹è¯å¼•æ“" class="headerlink" title="Rasaæ ¸å¿ƒå¯¹è¯å¼•æ“"></a>Rasaæ ¸å¿ƒå¯¹è¯å¼•æ“</h1><h1 id="stories"><a href="#stories" class="headerlink" title="stories"></a>stories</h1><ul>
<li><a href="#">æ ¼å¼</a><ul>
<li><a href="#">storiesæ˜¯ç”±ä»€ä¹ˆç»„æˆçš„ï¼Ÿ</a></li>
<li><a href="#">ç”¨æˆ·ç•™è¨€</a></li>
<li><a href="#">åŠ¨ä½œ</a></li>
<li><a href="#">å¤§äº‹ä»¶</a><ul>
<li><a href="#">slotäº‹ä»¶</a></li>
<li><a href="#">è¡¨å•äº‹ä»¶</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#">checkpointså’Œor_statements</a><ul>
<li><a href="#">checkpoints</a></li>
<li><a href="#">statements</a></li>
</ul>
</li>
<li><a href="#">ç«¯åˆ°ç«¯storyè¯„ä¼°æ ¼å¼</a></li>
</ul>
<p>Rasa storyæ˜¯ä¸€ç§ç”¨äºè®­ç»ƒRasaå¯¹è¯ç®¡ç†æ¨¡å‹çš„è®­ç»ƒæ•°æ®ã€‚</p>
<p>storyæ˜¯ç”¨æˆ·ä¸AIåŠ©æ‰‹ä¹‹é—´å¯¹è¯çš„è¡¨ç¤ºï¼Œå·²è½¬æ¢ä¸ºç‰¹å®šæ ¼å¼ï¼Œå…¶ä¸­ç”¨æˆ·è¾“å…¥è¡¨ç¤ºä¸ºç›¸åº”çš„æ„å›¾ï¼ˆå¿…è¦æ—¶åŒ…æ‹¬å®ä½“ï¼‰ï¼Œè€ŒåŠ©æ‰‹çš„å“åº”è¡¨ç¤ºä¸ºç›¸åº”çš„åŠ¨ä½œåç§°ã€‚</p>
<p>Rasa Coreå¯¹è¯ç³»ç»Ÿçš„è®­ç»ƒç¤ºä¾‹ç§°ä¸º<strong>story</strong>ã€‚è¿™æ˜¯storyæ•°æ®æ ¼å¼çš„æŒ‡å—ã€‚</p>
<blockquote>
<p>æ³¨æ„</p>
<p>æ‚¨è¿˜å¯ä»¥<strong>å°†storyåˆ†å¸ƒåœ¨å¤šä¸ªæ–‡ä»¶ä¸­ï¼Œ</strong>å¹¶ä¸ºå¤§å¤šæ•°è„šæœ¬ï¼ˆä¾‹å¦‚ï¼ŒåŸ¹è®­ï¼Œå¯è§†åŒ–ï¼‰æŒ‡å®šåŒ…å«æ–‡ä»¶çš„æ–‡ä»¶å¤¹ã€‚è¿™äº›storyå°†è¢«è§†ä¸ºä¸€ä¸ªå¤§æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ã€‚</p>
</blockquote>
<h3 id="æ ¼å¼"><a href="#æ ¼å¼" class="headerlink" title="æ ¼å¼"></a>æ ¼å¼</h3><p>è¿™æ˜¯Rasa storyæ ¼å¼çš„å¯¹è¯ç¤ºä¾‹ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">##</span> greet + location/price + cuisine + num people    </span><span class="token comment" spellcheck="true">&lt;!-- name of the story - just for debugging --></span>
<span class="token list punctuation">*</span> greet
   <span class="token list punctuation">-</span> action<span class="token italic"><span class="token punctuation">_</span>ask<span class="token punctuation">_</span></span>howcanhelp
<span class="token list punctuation">*</span> inform<span class="token entity" title="&#123;">&amp;#123;</span>"location": "rome", "price": "cheap"<span class="token entity" title="&#125;">&amp;#125;</span>  <span class="token comment" spellcheck="true">&lt;!-- user utterance, in format intent&amp;#123;entities&amp;#125; --></span>
   <span class="token list punctuation">-</span> action<span class="token italic"><span class="token punctuation">_</span>on<span class="token punctuation">_</span></span>it
   <span class="token list punctuation">-</span> action<span class="token italic"><span class="token punctuation">_</span>ask<span class="token punctuation">_</span></span>cuisine
<span class="token list punctuation">*</span> inform<span class="token entity" title="&#123;">&amp;#123;</span>"cuisine": "spanish"<span class="token entity" title="&#125;">&amp;#125;</span>
   <span class="token list punctuation">-</span> action<span class="token italic"><span class="token punctuation">_</span>ask<span class="token punctuation">_</span></span>numpeople        <span class="token comment" spellcheck="true">&lt;!-- action that the bot should execute --></span>
<span class="token list punctuation">*</span> inform<span class="token entity" title="&#123;">&amp;#123;</span>"people": "six"<span class="token entity" title="&#125;">&amp;#125;</span>
   <span class="token list punctuation">-</span> action<span class="token italic"><span class="token punctuation">_</span>ack<span class="token punctuation">_</span></span>dosearch</code></pre>
<h3 id="story"><a href="#story" class="headerlink" title="story"></a>story</h3><ul>
<li>storyä»¥ä¸€ä¸ªåå­—å¼€å¤´ï¼Œåé¢å¸¦æœ‰ä¸¤ä¸ªå“ˆå¸Œã€‚æ‚¨å¯ä»¥æ ¹æ®è‡ªå·±çš„å–œå¥½æ¥å‘½åè¯¥storyï¼Œä½†æ˜¯å¯¹äºè°ƒè¯•æ¥è¯´ï¼Œä¸ºå®ƒä»¬æŒ‡å®šæè¿°æ€§åç§°å¯èƒ½éå¸¸æœ‰ç”¨ï¼<code>## story_03248462</code></li>
<li>storyçš„ç»“å°¾ç”¨æ¢è¡Œç¬¦è¡¨ç¤ºï¼Œç„¶åæ–°çš„storyå†æ¬¡ä»¥å¼€å¤´<code>##</code>ã€‚</li>
<li>ç”¨æˆ·å‘é€çš„æ¶ˆæ¯<code>*</code> ä»¥æ ¼å¼å¼€å¤´ä»¥è¡Œå¼€å¤´ã€‚<code>intent{"entity1": "value", "entity2": "value"}</code></li>
<li>æœºå™¨äººæ‰§è¡Œçš„åŠ¨ä½œä»¥ä»¥å¼€å¤´çš„è¡Œæ˜¾ç¤ºï¼Œ<code>-</code> å¹¶åŒ…å«åŠ¨ä½œçš„åç§°ã€‚</li>
<li>åŠ¨ä½œè¿”å›çš„äº‹ä»¶åœ¨è¯¥åŠ¨ä½œä¹‹åç«‹å³åœ¨çº¿ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªæ“ä½œè¿”å›ä¸€ä¸ª<code>SlotSet</code>äº‹ä»¶ï¼Œåˆ™æ˜¾ç¤ºä¸º ã€‚<code>slot{"slot_name": "value"}</code></li>
</ul>
<h3 id="ç”¨æˆ·æ¶ˆæ¯"><a href="#ç”¨æˆ·æ¶ˆæ¯" class="headerlink" title="ç”¨æˆ·æ¶ˆæ¯"></a>ç”¨æˆ·æ¶ˆæ¯</h3><p>åœ¨ç¼–å†™storyæ—¶ï¼Œæ‚¨ä¸å¿…å¤„ç†ç”¨æˆ·å‘é€çš„æ¶ˆæ¯çš„ç‰¹å®šå†…å®¹ã€‚ç›¸åï¼Œæ‚¨å¯ä»¥åˆ©ç”¨NLUç®¡é“çš„è¾“å‡ºï¼Œè¯¥è¾“å‡ºä½¿æ‚¨å¯ä»¥ä»…ä½¿ç”¨æ„å›¾å’Œå®ä½“çš„ç»„åˆæ¥å¼•ç”¨ç”¨æˆ·å¯ä»¥å‘é€çš„æ‰€æœ‰å¯èƒ½çš„æ¶ˆæ¯ï¼Œè¡¨ç¤ºåŒä¸€ä»¶äº‹ã€‚</p>
<p>åœ¨æ­¤å¤„ä¹ŸåŒ…å«å®ä½“ä¹Ÿå¾ˆé‡è¦ï¼Œå› ä¸ºç­–ç•¥ä¼šæ ¹æ®æ„å›¾å’Œå®ä½“çš„<em>ç»„åˆ</em>æ¥å­¦ä¹ é¢„æµ‹ä¸‹ä¸€ä¸ªåŠ¨ä½œï¼ˆä½†æ˜¯ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<a href="#">use_entities</a>å±æ€§æ›´æ”¹æ­¤è¡Œä¸º ï¼‰ã€‚</p>
<blockquote>
<p>è­¦å‘Š</p>
<p><code>/</code>ç¬¦å·ä¿ç•™ä¸ºåˆ†éš”ç¬¦ï¼Œç”¨äºå°†æ£€ç´¢æ„å›¾ä¸å“åº”æ–‡æœ¬æ ‡è¯†ç¬¦åˆ†å¼€ã€‚æœ‰å…³æ­¤æ ¼å¼çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…â€œ<a href="#">æ£€ç´¢æ“ä½œâ€</a>éƒ¨åˆ†ã€‚å¦‚æœä»»ä½•æ„å›¾åç§°åŒ…å«åˆ†éš”ç¬¦ï¼Œåˆ™åŒ…å«è¿™äº›storiesçš„æ–‡ä»¶å°†è¢«è§†ä¸º<a href="#">ResponseSelector</a>æ¨¡å‹çš„è®­ç»ƒæ–‡ä»¶ï¼Œè€Œå¯¹äºCoreæ¨¡å‹çš„è®­ç»ƒå°†è¢«å¿½ç•¥ã€‚`Training Data Format</p>
</blockquote>
<h3 id="åŠ¨ä½œ"><a href="#åŠ¨ä½œ" class="headerlink" title="åŠ¨ä½œ"></a>åŠ¨ä½œ</h3><p>åœ¨ç¼–å†™storiesæ—¶ï¼Œæ‚¨ä¼šé‡åˆ°ä¸¤ç§ç±»å‹çš„åŠ¨ä½œï¼šå‘å£°åŠ¨ä½œå’Œè‡ªå®šä¹‰åŠ¨ä½œã€‚è¯è¯­æ“ä½œæ˜¯æœºå™¨äººå¯ä»¥å“åº”çš„ç¡¬ç¼–ç æ¶ˆæ¯ã€‚å¦ä¸€æ–¹é¢ï¼Œè‡ªå®šä¹‰æ“ä½œæ¶‰åŠæ­£åœ¨æ‰§è¡Œçš„è‡ªå®šä¹‰ä»£ç ã€‚</p>
<p>æœºå™¨äººæ‰§è¡Œçš„æ‰€æœ‰åŠ¨ä½œï¼ˆè¯è¯­åŠ¨ä½œå’Œè‡ªå®šä¹‰åŠ¨ä½œï¼‰å‡ä»¥è¡Œå¼€å¤´ï¼Œ<code>-</code>åè·ŸåŠ¨ä½œåç§°ã€‚</p>
<p>è¯­éŸ³æ“ä½œçš„å“åº”å¿…é¡»ä»¥å‰ç¼€å¼€å¤´<code>utter_</code>ï¼Œå¹¶ä¸”å¿…é¡»ä¸åŸŸä¸­å®šä¹‰çš„å“åº”åç§°åŒ¹é…ã€‚</p>
<p>å¯¹äºè‡ªå®šä¹‰æ“ä½œï¼Œæ“ä½œåç§°æ˜¯æ‚¨é€‰æ‹©ä»<code>name</code>è‡ªå®šä¹‰æ“ä½œç±»çš„æ–¹æ³•è¿”å›çš„å­—ç¬¦ä¸²ã€‚å°½ç®¡å¯¹è‡ªå®šä¹‰åŠ¨ä½œï¼ˆä¸è¯è¯­åŠ¨ä½œä¸åŒï¼‰è¿›è¡Œå‘½åæ²¡æœ‰é™åˆ¶ï¼Œä½†æ˜¯æœ€ä½³åšæ³•æ˜¯åœ¨åç§°å‰åŠ ä¸Š<code>action_</code>ã€‚</p>
<h3 id="äº‹ä»¶"><a href="#äº‹ä»¶" class="headerlink" title="äº‹ä»¶"></a>äº‹ä»¶</h3><p>è¯¸å¦‚è®¾ç½®æ§½ä½æˆ–æ¿€æ´»/å–æ¶ˆæ¿€æ´»è¡¨æ ¼ä¹‹ç±»çš„äº‹ä»¶å¿…é¡»ä½œä¸ºstoriesçš„ä¸€éƒ¨åˆ†æ˜ç¡®åœ°å†™å‡ºã€‚å½“è‡ªå®šä¹‰åŠ¨ä½œå·²ç»æˆä¸ºstoriesçš„ä¸€éƒ¨åˆ†æ—¶ï¼Œå¿…é¡»å•ç‹¬åŒ…å«è‡ªå®šä¹‰åŠ¨ä½œè¿”å›çš„äº‹ä»¶ï¼Œè¿™ä¼¼ä¹æ˜¯å¤šä½™çš„ã€‚ä½†æ˜¯ï¼Œç”±äºRasaåœ¨è®­ç»ƒæœŸé—´æ— æ³•ç¡®å®šè¿™ä¸€äº‹å®ï¼Œå› æ­¤æ­¤æ­¥éª¤æ˜¯å¿…éœ€çš„ã€‚</p>
<p>æ‚¨å¯ä»¥<a target="_blank" rel="noopener" href="https://legacy-docs-v1.rasa.com/api/events/#events">åœ¨æ­¤å¤„</a>é˜…è¯»æœ‰å…³äº‹ä»¶çš„æ›´å¤šä¿¡æ¯ã€‚</p>
<h4 id="slotäº‹ä»¶"><a href="#slotäº‹ä»¶" class="headerlink" title="slotäº‹ä»¶"></a>slotäº‹ä»¶</h4><p>å¹¿å‘Šä½äº‹ä»¶è®°ä¸ºã€‚å¦‚æœåœ¨è‡ªå®šä¹‰åŠ¨ä½œä¸­è®¾ç½®äº†è¯¥æ’æ§½ï¼Œåˆ™ä¼šåœ¨è‡ªå®šä¹‰åŠ¨ä½œäº‹ä»¶ä¹‹åç«‹å³å°†å…¶å†™å…¥è¡Œä¸­ã€‚å¦‚æœæ‚¨çš„è‡ªå®šä¹‰æ“ä½œå°†å¹¿å‘Šä½å€¼é‡ç½®ä¸ºâ€œæ— â€ï¼Œåˆ™å¯¹åº”çš„äº‹ä»¶å°†æ˜¯ã€‚<code>- slot{"slot_name": "value"}``-slot{"slot_name": null}</code></p>
<h4 id="è¡¨å•äº‹ä»¶"><a href="#è¡¨å•äº‹ä»¶" class="headerlink" title="è¡¨å•äº‹ä»¶"></a>è¡¨å•äº‹ä»¶</h4><p>å¤„ç†storiesä¸­çš„è¡¨å•æ—¶ï¼Œéœ€è¦ç‰¢è®°ä¸‰ç§äº‹ä»¶ã€‚</p>
<ul>
<li>è¡¨å•åŠ¨ä½œäº‹ä»¶ï¼ˆä¾‹å¦‚ï¼‰åœ¨ç¬¬ä¸€æ¬¡å¯åŠ¨è¡¨å•æ—¶å°±å¼€å§‹ä½¿ç”¨ï¼Œå¹¶ä¸”åœ¨è¡¨å•å·²ç»å¤„äºæ´»åŠ¨çŠ¶æ€æ—¶åˆç»§ç»­ä½¿ç”¨è¡¨å•åŠ¨ä½œã€‚<code>- restaurant_form</code></li>
<li>åœ¨ç¬¬ä¸€ä¸ªè¡¨å•æ“ä½œäº‹ä»¶ä¹‹åç«‹å³ä½¿ç”¨è¡¨å•æ¿€æ´»äº‹ä»¶ï¼ˆä¾‹å¦‚ï¼‰ã€‚<code>- form{"name": "restaurant_form"}</code></li>
<li>è¡¨å•åœç”¨äº‹ä»¶ï¼ˆä¾‹å¦‚ï¼‰ï¼Œç”¨äºåœç”¨è¡¨å•ã€‚<code>- form{"name": null}</code></li>
</ul>
<blockquote>
<p>æ³¨æ„</p>
<p>ä¸ºäº†è§£å†³å¿˜è®°æ·»åŠ äº‹ä»¶çš„é™·é˜±ï¼Œå»ºè®®ç¼–å†™è¿™äº›æ•…äº‹çš„æ–¹æ³•æ˜¯ä½¿ç”¨<a href="#">äº¤äº’å¼å­¦ä¹ </a>ã€‚</p>
</blockquote>
<h3 id="checkpointså’ŒOR-statements"><a href="#checkpointså’ŒOR-statements" class="headerlink" title="checkpointså’ŒOR statements"></a>checkpointså’ŒOR statements</h3><p>å¦‚æœæœ‰æ£€æŸ¥ç‚¹å’ŒORè¯­å¥ï¼Œéƒ½åº”è°¨æ…ä½¿ç”¨ã€‚é€šå¸¸ï¼Œæœ‰æ›´å¥½çš„æ–¹æ³•å¯ä»¥é€šè¿‡ä½¿ç”¨è¡¨å•å’Œ/æˆ–æ£€ç´¢æ“ä½œæ¥å®ç°æ‰€éœ€çš„åŠŸèƒ½ã€‚</p>
<h4 id="checkpoints"><a href="#checkpoints" class="headerlink" title="checkpoints"></a>checkpoints</h4><p>æ‚¨å¯ä»¥ç”¨æ¥æ¨¡å—åŒ–å’Œç®€åŒ–æ‚¨çš„è®­ç»ƒæ•°æ®ã€‚æ£€æŸ¥ç‚¹å¯èƒ½æœ‰ç”¨ï¼Œä½†<strong>ä¸è¦è¿‡åº¦ä½¿ç”¨å®ƒä»¬</strong>ã€‚ä½¿ç”¨å¤§é‡æ£€æŸ¥ç‚¹å¯ä»¥è¿…é€Ÿä½¿æ‚¨çš„ç¤ºä¾‹æ•…äº‹éš¾ä»¥ç†è§£ã€‚å¦‚æœç»å¸¸åœ¨ä¸åŒçš„æ•…äº‹ä¸­é‡å¤æ‰§è¡Œæ•…äº‹å—ï¼Œåˆ™ä½¿ç”¨å®ƒä»¬å¾ˆæœ‰æ„ä¹‰ï¼Œä½†æ˜¯<em>æ²¡æœ‰</em>æ£€æŸ¥ç‚¹çš„æ•…äº‹æ›´æ˜“äºé˜…è¯»å’Œç¼–å†™ã€‚è¿™æ˜¯ä¸€ä¸ªåŒ…å«æ£€æŸ¥ç‚¹çš„ç¤ºä¾‹æ•…äº‹æ–‡ä»¶ï¼ˆè¯·æ³¨æ„ï¼Œæ‚¨ä¸€æ¬¡å¯ä»¥é™„åŠ å¤šä¸ªæ£€æŸ¥ç‚¹ï¼‰ï¼š<code>&gt; checkpoints</code></p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">##</span> first story</span>
<span class="token list punctuation">*</span> greet
   <span class="token list punctuation">-</span> action<span class="token italic"><span class="token punctuation">_</span>ask<span class="token punctuation">_</span></span>user_question
<span class="token blockquote punctuation">></span> check<span class="token italic"><span class="token punctuation">_</span>asked<span class="token punctuation">_</span></span>question

<span class="token title important"><span class="token punctuation">##</span> user affirms question</span>
<span class="token blockquote punctuation">></span> check<span class="token italic"><span class="token punctuation">_</span>asked<span class="token punctuation">_</span></span>question
<span class="token list punctuation">*</span> affirm
  <span class="token list punctuation">-</span> action<span class="token italic"><span class="token punctuation">_</span>handle<span class="token punctuation">_</span></span>affirmation
<span class="token blockquote punctuation">></span> check<span class="token italic"><span class="token punctuation">_</span>handled<span class="token punctuation">_</span></span>affirmation

<span class="token title important"><span class="token punctuation">##</span> user denies question</span>
<span class="token blockquote punctuation">></span> check<span class="token italic"><span class="token punctuation">_</span>asked<span class="token punctuation">_</span></span>question
<span class="token list punctuation">*</span> deny
  <span class="token list punctuation">-</span> action<span class="token italic"><span class="token punctuation">_</span>handle<span class="token punctuation">_</span></span>denial
<span class="token blockquote punctuation">></span> check<span class="token italic"><span class="token punctuation">_</span>handled<span class="token punctuation">_</span></span>denial

<span class="token title important"><span class="token punctuation">##</span> user leaves</span>
<span class="token blockquote punctuation">></span> check<span class="token italic"><span class="token punctuation">_</span>handled<span class="token punctuation">_</span></span>denial
<span class="token blockquote punctuation">></span> check<span class="token italic"><span class="token punctuation">_</span>handled<span class="token punctuation">_</span></span>affirmation
<span class="token list punctuation">*</span> goodbye
  <span class="token list punctuation">-</span> utter_goodbye</code></pre>
<blockquote>
<p>æ³¨æ„</p>
<p>ä¸å¸¸è§„æ•…äº‹ä¸åŒï¼Œæ£€æŸ¥ç‚¹ä¸é™äºä»ç”¨æˆ·è¾“å…¥å¼€å§‹ã€‚åªè¦åœ¨ä¸»è¦æ•…äº‹ä¸­çš„æ­£ç¡®ä½ç½®æ’å…¥æ£€æŸ¥ç‚¹ï¼Œç¬¬ä¸€ä¸ªäº‹ä»¶å°±å¯ä»¥æ˜¯è‡ªå®šä¹‰åŠ¨ä½œæˆ–å“åº”åŠ¨ä½œã€‚</p>
</blockquote>
<h4 id="OR-Statements"><a href="#OR-Statements" class="headerlink" title="OR Statements"></a>OR Statements</h4><p>ç¼–å†™ç®€çŸ­æ•…äº‹æˆ–ä»¥ç›¸åŒæ–¹å¼å¤„ç†å¤šä¸ªæ„å›¾çš„å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨<code>OR</code>è¯­å¥ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨è¦æ±‚ç”¨æˆ·ç¡®è®¤æŸä»¶äº‹ï¼Œå¹¶ä¸”æ‚¨æƒ³ä»¥ç›¸åŒçš„æ–¹å¼å¯¹å¾…<code>affirm</code> å’Œ<code>thankyou</code>æ„å›¾ã€‚ä»¥ä¸‹æ•…äº‹å°†åœ¨åŸ¹è®­æ—¶è½¬æ¢ä¸ºä¸¤ä¸ªæ•…äº‹ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">##</span> story</span>
...
  <span class="token list punctuation">-</span> utter<span class="token italic"><span class="token punctuation">_</span>ask<span class="token punctuation">_</span></span>confirm
<span class="token list punctuation">*</span> affirm OR thankyou
  <span class="token list punctuation">-</span> action<span class="token italic"><span class="token punctuation">_</span>handle<span class="token punctuation">_</span></span>affirmation</code></pre>
<p>å°±åƒæ£€æŸ¥ç‚¹ä¸€æ ·ï¼Œ<code>OR</code>è¯­å¥å¯èƒ½ä¼šå¾ˆæœ‰ç”¨ï¼Œä½†æ˜¯å¦‚æœæ‚¨ä½¿ç”¨äº†å¾ˆå¤šæ£€æŸ¥ç‚¹ï¼Œåˆ™é‡ç»„åŸŸå’Œ/æˆ–æ„å›¾å¯èƒ½ä¼šæ›´å¥½ã€‚</p>
<blockquote>
<p>è­¦å‘Š</p>
<p>è¿‡åº¦ä½¿ç”¨è¿™äº›åŠŸèƒ½ï¼ˆcheckpointså’ŒOR statementsï¼‰ä¼šå‡æ…¢è®­ç»ƒé€Ÿåº¦ã€‚</p>
</blockquote>
<h3 id="ç«¯åˆ°ç«¯storiesè¯„ä¼°æ ¼å¼"><a href="#ç«¯åˆ°ç«¯storiesè¯„ä¼°æ ¼å¼" class="headerlink" title="ç«¯åˆ°ç«¯storiesè¯„ä¼°æ ¼å¼"></a>ç«¯åˆ°ç«¯storiesè¯„ä¼°æ ¼å¼</h3><p>ç«¯åˆ°ç«¯æ•…äº‹æ ¼å¼æ˜¯ä¸€ç§å°†NLUå’ŒCoreåŸ¹è®­æ•°æ®éƒ½åˆå¹¶åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ä»¥è¿›è¡Œè¯„ä¼°çš„æ ¼å¼ã€‚é˜…è¯»æœ‰å…³<a href="#">æµ‹è¯•åŠ©æ‰‹çš„</a>æ›´å¤šä¿¡æ¯</p>
<blockquote>
<p>è­¦å‘Š</p>
<p>æ­¤æ ¼å¼ä»…ç”¨äºç«¯åˆ°ç«¯è¯„ä¼°ï¼Œè€Œä¸èƒ½ç”¨äºè®­ç»ƒã€‚</p>
</blockquote>
<h2 id="Domain"><a href="#Domain" class="headerlink" title="Domain"></a>Domain</h2><p>è¯¥<code>Domain</code>å®šä¹‰äº†ä½ çš„åŠ©æ‰‹å·¥ä½œçš„å®‡å®™ã€‚å®ƒè§„å®šäº†<code>intents</code>ï¼Œ<code>entities</code>ï¼Œ<code>slots</code>å’Œ<code>actions</code> ä½ çš„æœºå™¨äººåº”è¯¥çŸ¥é“ã€‚ï¼ˆå¯é€‰ï¼‰å®ƒè¿˜å¯ä»¥åŒ…å«<code>responses</code> æœºå™¨äººå¯ä»¥è¯´çš„å†…å®¹ã€‚</p>
<ul>
<li><a href="#">Domainçš„ç¤ºä¾‹</a></li>
<li><a href="#">è‡ªå®šä¹‰åŠ¨ä½œå’Œslot</a></li>
<li><a href="#">å“åº”</a></li>
<li><a href="#">å›¾åƒå’ŒæŒ‰é’®</a></li>
<li><a href="#">è‡ªå®šä¹‰è¾“å‡ºæœ‰æ•ˆè´Ÿè½½</a></li>
<li><a href="#">ç‰¹å®šé€šé“çš„å“åº”</a></li>
<li><a href="#">å› ç´ </a></li>
<li><a href="#">å˜ä½“</a></li>
<li><a href="#">å¿½ç•¥æŸäº›æ„å›¾å®ä½“</a></li>
<li><a href="#">ä¼šè¯é…ç½®</a></li>
</ul>
<h3 id="domainä¾‹å­"><a href="#domainä¾‹å­" class="headerlink" title="domainä¾‹å­"></a>domainä¾‹å­</h3><p>ä¾‹å¦‚ï¼Œç”±åˆ›å»ºçš„åŸŸå…·æœ‰ä»¥ä¸‹yamlå®šä¹‰ï¼š<code>rasa init</code></p>
<pre class=" language-markdown"><code class="language-markdown">intents:
  <span class="token list punctuation">-</span> greet
  <span class="token list punctuation">-</span> goodbye
  <span class="token list punctuation">-</span> affirm
  <span class="token list punctuation">-</span> deny
  <span class="token list punctuation">-</span> mood_great
  <span class="token list punctuation">-</span> mood_unhappy
  <span class="token list punctuation">-</span> bot_challenge

responses:
  utter_greet:
  <span class="token list punctuation">-</span> text: "Hey! How are you?"

  utter<span class="token italic"><span class="token punctuation">_</span>cheer<span class="token punctuation">_</span></span>up:
  <span class="token list punctuation">-</span> text: "Here is something to cheer you up:"
<span class="token code keyword">    image: "https://i.imgur.com/nGF1K8f.jpg"</span>

  utter<span class="token italic"><span class="token punctuation">_</span>did<span class="token punctuation">_</span></span>that_help:
  <span class="token list punctuation">-</span> text: "Did that help you?"

  utter_happy:
  <span class="token list punctuation">-</span> text: "Great, carry on!"

  utter_goodbye:
  <span class="token list punctuation">-</span> text: "Bye"

  utter_iamabot:
  <span class="token list punctuation">-</span> text: "I am a bot, powered by Rasa."

session<span class="token italic"><span class="token punctuation">_</span>config:
  session<span class="token punctuation">_</span></span>expiration<span class="token italic"><span class="token punctuation">_</span>time: 60
  carry<span class="token punctuation">_</span></span>over<span class="token italic"><span class="token punctuation">_</span>slots<span class="token punctuation">_</span></span>to<span class="token italic"><span class="token punctuation">_</span>new<span class="token punctuation">_</span></span>session: true</code></pre>
<p><strong>è¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</strong></p>
<p>æ‚¨çš„NLUæ¨¡å‹å°†å®šä¹‰<code>intents</code>å’Œ<code>entities</code>ï¼Œæ‚¨éœ€è¦å°†å…¶åŒ…æ‹¬åœ¨åŸŸä¸­ã€‚æœ¬<code>entities</code>èŠ‚åˆ—å‡ºäº†æ‚¨çš„NLUç®¡é“ä¸­ä»»ä½•<a href="#">å®ä½“æå–å™¨</a>æå–çš„æ‰€æœ‰<a href="#">å®ä½“</a>ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">entities:
   <span class="token list punctuation">-</span> PERSON          # entity extracted by SpacyEntityExtractor
   <span class="token list punctuation">-</span> time            # entity extracted by DucklingHTTPExtractor
   <span class="token list punctuation">-</span> membership_type # custom entity extracted by CRFEntityExtractor
   <span class="token list punctuation">-</span> priority        # custom entity extracted by CRFEntityExtractor</code></pre>
<p><a href="#">slotä¸­åŒ…å«</a>æ‚¨è¦åœ¨å¯¹è¯æœŸé—´è·Ÿè¸ªçš„ä¿¡æ¯ã€‚ç§°ä¸ºç±»åˆ«slotçš„<code>risk_level</code>å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">slots:
   risk_level:
<span class="token code keyword">      type: categorical</span>
<span class="token code keyword">      values:</span>
<span class="token code keyword">      - low</span>
<span class="token code keyword">      - medium</span>
<span class="token code keyword">      - high</span></code></pre>
<p><a href="#">åœ¨è¿™é‡Œï¼Œ</a>æ‚¨å¯ä»¥æ‰¾åˆ°Rasa Coreå®šä¹‰çš„æ’æ§½ç±»å‹çš„å®Œæ•´åˆ—è¡¨ï¼Œä»¥åŠå°†å…¶åŒ…å«åœ¨åŸŸæ–‡ä»¶ä¸­çš„è¯­æ³•ã€‚</p>
<p><a href="#">åŠ¨ä½œ</a>æ˜¯æ‚¨çš„æœºå™¨äººå®é™…ä¸Šå¯ä»¥åšçš„äº‹æƒ…ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªåŠ¨ä½œå¯ä»¥ï¼š</p>
<ul>
<li>å›åº”ç”¨æˆ·</li>
<li>è¿›è¡Œå¤–éƒ¨APIè°ƒç”¨ï¼Œ</li>
<li>æŸ¥è¯¢æ•°æ®åº“ï¼Œæˆ–</li>
<li>å‡ ä¹ä»»ä½•ä¸œè¥¿ï¼</li>
</ul>
<h3 id="è‡ªå®šä¹‰åŠ¨ä½œå’Œæ§½ä½"><a href="#è‡ªå®šä¹‰åŠ¨ä½œå’Œæ§½ä½" class="headerlink" title="è‡ªå®šä¹‰åŠ¨ä½œå’Œæ§½ä½"></a>è‡ªå®šä¹‰åŠ¨ä½œå’Œæ§½ä½</h3><p>è¦å¼•ç”¨æ‚¨åŸŸä¸­çš„æ’æ§½ï¼Œæ‚¨éœ€è¦æŒ‰å…¶<strong>æ¨¡å—è·¯å¾„</strong>å¯¹å…¶è¿›è¡Œå¼•ç”¨ã€‚è¦å¼•ç”¨è‡ªå®šä¹‰æ“ä½œï¼Œè¯·ä½¿ç”¨å…¶<strong>åç§°</strong>ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªåä¸ºæ¨¡å—<code>my_actions</code>åŒ…å«ä¸€ä¸ªç±»<code>MyAwesomeAction</code>å’Œæ¨¡å—<code>my_slots</code>åŒ…å« <code>MyAwesomeSlot</code>ï¼Œå°†æ·»åŠ è¿™äº›è¡Œåˆ°åŸŸæ–‡ä»¶ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">actions:
  <span class="token list punctuation">-</span> my<span class="token italic"><span class="token punctuation">_</span>custom<span class="token punctuation">_</span></span>action
  ...

slots:
  <span class="token list punctuation">-</span> my_slots.MyAwesomeSlot</code></pre>
<p>åœ¨æ­¤ç¤ºä¾‹<code>name</code>ä¸­<code>MyAwesomeAction</code>éœ€è¦è¿”å› çš„åŠŸèƒ½<code>my_custom_action</code>ï¼ˆæœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§<a href="#">Custom Actions</a>ï¼‰ã€‚</p>
<h3 id="å“åº”"><a href="#å“åº”" class="headerlink" title="å“åº”"></a>å“åº”</h3><p>å“åº”æ˜¯æœºå™¨äººå°†å‘å›ç»™ç”¨æˆ·çš„æ¶ˆæ¯ã€‚æœ‰ä¸¤ç§ä½¿ç”¨è¿™äº›å“åº”çš„æ–¹æ³•ï¼š</p>
<ol>
<li><p>å¦‚æœå“åº”çš„åç§°ä»¥å¼€å¤´<code>utter_</code>ï¼Œåˆ™è¯¥å“åº”å¯ä»¥ç›´æ¥ç”¨ä½œæ“ä½œã€‚æ‚¨å¯ä»¥å°†å“åº”æ·»åŠ åˆ°åŸŸä¸­ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">responses:
  utter_greet:
  <span class="token list punctuation">-</span> text: "Hey! How are you?"</code></pre>
<p>ä¹‹åï¼Œæ‚¨å¯ä»¥å°†å“åº”ç”¨ä½œæ•…äº‹ä¸­çš„åŠ¨ä½œï¼š</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">##</span> greet the user</span>
<span class="token list punctuation">*</span> intent_greet
  <span class="token list punctuation">-</span> utter_greet</code></pre>
<p>å½“<code>utter_greet</code>ä½œä¸ºæ“ä½œè¿è¡Œæ—¶ï¼Œå®ƒå°†æŠŠå“åº”ä¸­çš„æ¶ˆæ¯å‘é€å›ç”¨æˆ·ã€‚</p>
</li>
<li><p>æ‚¨å¯ä»¥ä½¿ç”¨å“åº”ï¼Œä½¿ç”¨è°ƒåº¦ç¨‹åºä»æ‚¨çš„è‡ªå®šä¹‰æ“ä½œç”Ÿæˆå“åº”æ¶ˆæ¯ï¼š <code>dispatcher.utter_message(template="utter_greet")</code>ã€‚è¿™ä½¿æ‚¨å¯ä»¥ä»å®é™…å‰¯æœ¬ä¸­åˆ†ç¦»å‡ºç”Ÿæˆæ¶ˆæ¯çš„é€»è¾‘ã€‚åœ¨æ‚¨çš„è‡ªå®šä¹‰æ“ä½œä»£ç ä¸­ï¼Œæ‚¨å¯ä»¥æ ¹æ®ä»¥ä¸‹å“åº”å‘é€æ¶ˆæ¯ï¼š</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> rasa_sdk<span class="token punctuation">.</span>actions <span class="token keyword">import</span> Action

<span class="token keyword">class</span> <span class="token class-name">ActionGreet</span><span class="token punctuation">(</span>Action<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">def</span> <span class="token function">name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token string">'action_greet'</span>

  <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> dispatcher<span class="token punctuation">,</span> tracker<span class="token punctuation">,</span> domain<span class="token punctuation">)</span><span class="token punctuation">:</span>
      dispatcher<span class="token punctuation">.</span>utter_message<span class="token punctuation">(</span>template<span class="token operator">=</span><span class="token string">"utter_greet"</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></code></pre>
</li>
</ol>
<h3 id="å›¾åƒå’ŒæŒ‰é’®"><a href="#å›¾åƒå’ŒæŒ‰é’®" class="headerlink" title="å›¾åƒå’ŒæŒ‰é’®"></a>å›¾åƒå’ŒæŒ‰é’®</h3><p>Domainçš„yamlæ–‡ä»¶ä¸­å®šä¹‰çš„å“åº”ä¹Ÿå¯ä»¥åŒ…å«å›¾åƒå’ŒæŒ‰é’®ï¼š</p>
<pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">responses</span><span class="token punctuation">:</span>
  <span class="token key atrule">utter_greet</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">text</span><span class="token punctuation">:</span> <span class="token string">"Hey! How are you?"</span>
    <span class="token key atrule">buttons</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">title</span><span class="token punctuation">:</span> <span class="token string">"great"</span>
      <span class="token key atrule">payload</span><span class="token punctuation">:</span> <span class="token string">"great"</span>
    <span class="token punctuation">-</span> <span class="token key atrule">title</span><span class="token punctuation">:</span> <span class="token string">"super sad"</span>
      <span class="token key atrule">payload</span><span class="token punctuation">:</span> <span class="token string">"super sad"</span>
  <span class="token key atrule">utter_cheer_up</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">text</span><span class="token punctuation">:</span> <span class="token string">"Here is something to cheer you up:"</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> <span class="token string">"https://i.imgur.com/nGF1K8f.jpg"</span></code></pre>
<blockquote>
<p>æ³¨æ„</p>
<p>è¯·è®°ä½ï¼Œå¦‚ä½•æ˜¾ç¤ºå®šä¹‰çš„æŒ‰é’®å–å†³äºè¾“å‡ºé€šé“çš„å®ç°ã€‚ä¾‹å¦‚ï¼Œå‘½ä»¤è¡Œæ— æ³•æ˜¾ç¤ºæŒ‰é’®æˆ–å›¾åƒï¼Œè€Œæ˜¯å°è¯•é€šè¿‡æ‰“å°é€‰é¡¹æ¥æ¨¡ä»¿å®ƒä»¬ã€‚</p>
</blockquote>
<h3 id="è‡ªå®šä¹‰è¾“å‡ºæœ‰æ•ˆè½½è·"><a href="#è‡ªå®šä¹‰è¾“å‡ºæœ‰æ•ˆè½½è·" class="headerlink" title="è‡ªå®šä¹‰è¾“å‡ºæœ‰æ•ˆè½½è·"></a>è‡ªå®šä¹‰è¾“å‡ºæœ‰æ•ˆè½½è·</h3><p>æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨<code>custom:</code>é”®å°†ä»»æ„è¾“å‡ºå‘é€åˆ°è¾“å‡ºé€šé“ ã€‚è¯·æ³¨æ„ï¼Œç”±äºåŸŸä¸ºyamlæ ¼å¼ï¼Œå› æ­¤jsonæœ‰æ•ˆè´Ÿè½½åº”é¦–å…ˆè½¬æ¢ä¸ºyamlæ ¼å¼ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå°½ç®¡æ—¥æœŸé€‰æ‹©å™¨ä¸æ˜¯å“åº”ä¸­å®šä¹‰çš„å‚æ•°ï¼Œå› ä¸ºå¤§å¤šæ•°æ¸ é“ä¸æ”¯æŒå®ƒä»¬ï¼Œä½†æ˜¯å¯ä»¥åƒè¿™æ ·å‘é€Slackæ—¥æœŸé€‰æ‹©å™¨ï¼š</p>
<pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">responses</span><span class="token punctuation">:</span>
  <span class="token key atrule">utter_take_bet</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">custom</span><span class="token punctuation">:</span>
      <span class="token key atrule">blocks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> section
        <span class="token key atrule">text</span><span class="token punctuation">:</span>
          <span class="token key atrule">text</span><span class="token punctuation">:</span> <span class="token string">"Make a bet on when the world will end:"</span>
          <span class="token key atrule">type</span><span class="token punctuation">:</span> mrkdwn
        <span class="token key atrule">accessory</span><span class="token punctuation">:</span>
          <span class="token key atrule">type</span><span class="token punctuation">:</span> datepicker
          <span class="token key atrule">initial_date</span><span class="token punctuation">:</span> <span class="token string">'2019-05-21'</span>
          <span class="token key atrule">placeholder</span><span class="token punctuation">:</span>
            <span class="token key atrule">type</span><span class="token punctuation">:</span> plain_text
            <span class="token key atrule">text</span><span class="token punctuation">:</span> Select a date</code></pre>
<h3 id="é€šé“ç‰¹å¼‚æ€§åº”ç­”"><a href="#é€šé“ç‰¹å¼‚æ€§åº”ç­”" class="headerlink" title="é€šé“ç‰¹å¼‚æ€§åº”ç­”"></a>é€šé“ç‰¹å¼‚æ€§åº”ç­”</h3><p>å¯¹äºæ¯ä¸ªå“åº”ï¼Œæ‚¨å¯ä»¥æœ‰å¤šä¸ª<strong>å“åº”æ¨¡æ¿</strong>ï¼ˆè¯·å‚é˜…<a href="#">å˜ä½“</a>ï¼‰ã€‚å¦‚æœæ‚¨æœ‰æŸäº›ä»…å¸Œæœ›å‘é€åˆ°ç‰¹å®šé¢‘é“çš„å“åº”æ¨¡æ¿ï¼Œåˆ™å¯ä»¥ä½¿ç”¨<code>channel:</code>é”®æŒ‡å®šæ­¤æ¨¡æ¿ã€‚è¯¥å€¼åº”ä¸<code>name()</code>é€šé“<code>OutputChannel</code> ç±»çš„æ–¹æ³•ä¸­å®šä¹‰çš„åç§°åŒ¹é…ã€‚å¦‚æœåˆ›å»ºä»…åœ¨æŸäº›é€šé“ä¸­èµ·ä½œç”¨çš„è‡ªå®šä¹‰è¾“å‡ºæœ‰æ•ˆè´Ÿè½½ï¼Œåˆ™ç‰¹å®šäºé€šé“çš„å“åº”ç‰¹åˆ«æœ‰ç”¨ã€‚</p>
<pre class=" language-markdown"><code class="language-markdown">responses:
  utter<span class="token italic"><span class="token punctuation">_</span>ask<span class="token punctuation">_</span></span>game:
  <span class="token list punctuation">-</span> text: "Which game would you like to play?"
<span class="token code keyword">    channel: "slack"</span>
<span class="token code keyword">    custom:</span>
<span class="token code keyword">      - # payload for Slack dropdown menu to choose a game</span>
  <span class="token list punctuation">-</span> text: "Which game would you like to play?"
<span class="token code keyword">    buttons:</span>
<span class="token code keyword">    - title: "Chess"</span>
<span class="token code keyword">      payload: '/inform&amp;#123;"game": "chess"&amp;#125;'</span>
<span class="token code keyword">    - title: "Checkers"</span>
<span class="token code keyword">      payload: '/inform&amp;#123;"game": "checkers"&amp;#125;'</span>
<span class="token code keyword">    - title: "Fortnite"</span>
<span class="token code keyword">      payload: '/inform&amp;#123;"game": "fortnite"&amp;#125;'</span></code></pre>
<p>æ¯æ¬¡æ‚¨çš„æ¼«æ¸¸å™¨å¯»æ‰¾å“åº”æ—¶ï¼Œå®ƒå°†é¦–å…ˆæ£€æŸ¥ä»¥æŸ¥çœ‹æ‰€è¿æ¥é€šé“æ˜¯å¦æœ‰ä»»ä½•ç‰¹å®šäºé€šé“çš„å“åº”æ¨¡æ¿ã€‚å¦‚æœæœ‰ï¼Œå®ƒå°†<strong>ä»…ä»</strong>è¿™äº›å“åº”æ¨¡æ¿ä¸­è¿›è¡Œé€‰æ‹©ã€‚å¦‚æœæœªæ‰¾åˆ°ç‰¹å®šäºé€šé“çš„å“åº”æ¨¡æ¿ï¼Œå®ƒå°†ä»ä»»ä½•æœªå®šä¹‰çš„å“åº”æ¨¡æ¿ä¸­è¿›è¡Œé€‰æ‹©<code>channel</code>ã€‚å› æ­¤ï¼Œä¼˜è‰¯ä½œæ³•æ˜¯å§‹ç»ˆä¸ºæ¯ä¸ªæœª<code>channel</code>æŒ‡å®šçš„å“åº”è‡³å°‘æ‹¥æœ‰ä¸€ä¸ªå“åº”æ¨¡æ¿ï¼Œä»¥ä¾¿æ‚¨çš„æœºå™¨äººå¯ä»¥åœ¨æ‰€æœ‰ç¯å¢ƒä¸­åšå‡ºå“åº”ï¼ŒåŒ…æ‹¬åœ¨Shellå’Œäº¤äº’å¼å­¦ä¹ ä¸­ã€‚</p>
<h2 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a><a target="_blank" rel="noopener" href="https://legacy-docs-v1.rasa.com/core/domains/#id9">å˜é‡</a></h2><p>æ‚¨è¿˜å¯ä»¥åœ¨å“åº”ä¸­ä½¿ç”¨<strong>å˜é‡</strong>æ¥æ’å…¥å¯¹è¯æœŸé—´æ”¶é›†çš„ä¿¡æ¯ã€‚æ‚¨å¯ä»¥åœ¨è‡ªå®šä¹‰pythonä»£ç ä¸­æ‰§è¡Œæ­¤æ“ä½œï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªåŠ¨æ’æ§½å¡«å……æœºåˆ¶æ‰§è¡Œæ­¤æ“ä½œã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æœ‰è¿™æ ·çš„ç­”å¤ï¼š</p>
<pre><code>responses:
  utter_greet:
  - text: "Hey, &amp;#123;name&amp;#125;. How are you?"</code></pre>
<p>Rasaä¼šè‡ªåŠ¨ä½¿ç”¨åœ¨åä¸ºçš„æ’æ§½ä¸­æ‰¾åˆ°çš„å€¼å¡«å……è¯¥å˜é‡ <code>name</code>ã€‚</p>
<p>åœ¨è‡ªå®šä¹‰ä»£ç ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æ£€ç´¢å“åº”ï¼š</p>
<pre><code>class ActionCustom(Action):
   def name(self):
      return "action_custom"

   def run(self, dispatcher, tracker, domain):
      # send utter default response to user
      dispatcher.utter_message(template="utter_default")
      # ... other code
      return []</code></pre>
<p>å¦‚æœå“åº”åŒ…å«ç”¨è¡¨ç¤ºçš„å˜é‡ï¼Œåˆ™<code>{my_variable}</code> å¯ä»¥é€šè¿‡å°†å®ƒä»¬ä½œä¸ºå…³é”®å­—å‚æ•°ä¼ é€’ç»™æ¥æä¾›å­—æ®µçš„å€¼<code>utter_message</code>ï¼š</p>
<pre><code>dispatcher.utter_message(template="utter_greet", my_variable="my text")</code></pre>
<h3 id="å˜ä½“"><a href="#å˜ä½“" class="headerlink" title="å˜ä½“"></a>å˜ä½“</h3><p>å¦‚æœè¦éšæœºæ›´æ”¹å‘é€ç»™ç”¨æˆ·çš„å“åº”ï¼Œåˆ™å¯ä»¥åˆ—å‡ºå¤šä¸ª<strong>å“åº”æ¨¡æ¿</strong>ï¼ŒRasaä¼šéšæœºé€‰æ‹©å…¶ä¸­ä¹‹ä¸€ï¼Œä¾‹å¦‚ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">responses:
  utter_greeting:
  <span class="token list punctuation">-</span> text: "Hey, <span class="token entity" title="&#123;">&amp;#123;</span>name<span class="token entity" title="&#125;">&amp;#125;</span>. How are you?"
  <span class="token list punctuation">-</span> text: "Hey, <span class="token entity" title="&#123;">&amp;#123;</span>name<span class="token entity" title="&#125;">&amp;#125;</span>. How is your day going?"</code></pre>
<h3 id="å¿½ç•¥æŸäº›æ„å›¾çš„å®ä½“"><a href="#å¿½ç•¥æŸäº›æ„å›¾çš„å®ä½“" class="headerlink" title="å¿½ç•¥æŸäº›æ„å›¾çš„å®ä½“"></a>å¿½ç•¥æŸäº›æ„å›¾çš„å®ä½“</h3><p>å¦‚æœå¸Œæœ›æŸäº›æ„å›¾å¿½ç•¥æ‰€æœ‰å®ä½“ï¼Œåˆ™å¯ä»¥å°†å‚æ•°æ·»åŠ åˆ°åŸŸæ–‡ä»¶ä¸­çš„æ„å›¾ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<code>use_entities: []</code></p>
<pre><code>intents:
  - greet:
      use_entities: []</code></pre>
<p>è¦å¿½ç•¥æŸäº›å®ä½“æˆ–æ˜ç¡®åœ°åªè€ƒè™‘æŸäº›å®ä½“ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹è¯­æ³•ï¼š</p>
<pre><code>intents:
- greet:
    use_entities:
      - name
      - first_name
    ignore_entities:
      - location
      - age</code></pre>
<p>è¿™æ„å‘³ç€é’ˆå¯¹è¿™äº›æ„å›¾çš„æ’é™¤å®ä½“å°†ä¸å…·æœ‰åŠŸèƒ½ï¼Œå› æ­¤ä¸ä¼šå½±å“ä¸‹ä¸€ä¸ªåŠ¨ä½œé¢„æµ‹ã€‚å½“æ‚¨æœ‰æ„ä¸åœ¨æ„è¦æ‹¾å–çš„å®ä½“æ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨ã€‚å¦‚æœæ‚¨åœ¨æ²¡æœ‰æ­¤å‚æ•°çš„æƒ…å†µä¸‹æŒ‰å¸¸è§„åˆ—å‡ºæ‚¨çš„æ„å›¾ï¼Œåˆ™å®ä½“å°†æ­£å¸¸åŒ–ã€‚</p>
<blockquote>
<p>æ³¨æ„</p>
<p>å¦‚æœæ‚¨ç¡®å®å¸Œæœ›è¿™äº›å®ä½“ä¸å½±å“åŠ¨ä½œé¢„æµ‹ï¼Œå»ºè®®æ‚¨ä½¿ç”¨ç›¸åŒçš„typeåç§°åˆ¶ä½œå¹¿å‘Šä½<code>unfeaturized</code>ã€‚</p>
</blockquote>
<h3 id="ä¼šè¯é…ç½®"><a href="#ä¼šè¯é…ç½®" class="headerlink" title="ä¼šè¯é…ç½®"></a>ä¼šè¯é…ç½®</h3><p>å¯¹è¯ä¼šè¯ä»£è¡¨åŠ©æ‰‹å’Œç”¨æˆ·ä¹‹é—´çš„å¯¹è¯ã€‚ä¼šè¯ä¼šè¯å¯ä»¥é€šè¿‡ä¸‰ç§æ–¹å¼å¼€å§‹ï¼š</p>
<blockquote>
<ol>
<li>ç”¨æˆ·å¼€å§‹ä¸åŠ©æ‰‹è¿›è¡Œå¯¹è¯ï¼Œ</li>
<li>ç”¨æˆ·åœ¨ä¸€æ®µå¯é…ç½®çš„ä¸æ´»åŠ¨æ—¶é—´åå‘é€ç¬¬ä¸€æ¡æ¶ˆæ¯ï¼Œæˆ–è€…</li>
<li>æ‰‹åŠ¨ä¼šè¯å¼€å§‹ç”±<code>/session_start</code>æ„å›¾æ¶ˆæ¯è§¦å‘ã€‚</li>
</ol>
</blockquote>
<p>æ‚¨å¯ä»¥åœ¨<code>session_config</code>å¯†é’¥ä¸‹çš„åŸŸä¸­å®šä¹‰é—²ç½®æ—¶é—´æ®µï¼Œä¹‹ååœ¨è¯¥é—²ç½®æ—¶é—´æ®µå†…è§¦å‘æ–°çš„ä¼šè¯ä¼šè¯ã€‚ <code>session_expiration_time</code>å®šä¹‰é—²ç½®æ—¶é—´ï¼ˆä»¥åˆ†é’Ÿä¸ºå•ä½ï¼‰ï¼Œä¹‹åæ–°ä¼šè¯å°†å¼€å§‹ã€‚<code>carry_over_slots_to_new_session</code>ç¡®å®šæ˜¯å¦åº”å°†ç°æœ‰è®¾ç½®çš„æ—¶éš™è½¬å…¥æ–°ä¼šè¯ã€‚</p>
<p>é»˜è®¤ä¼šè¯é…ç½®å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">session<span class="token italic"><span class="token punctuation">_</span>config:
  session<span class="token punctuation">_</span></span>expiration<span class="token italic"><span class="token punctuation">_</span>time: 60  # value in minutes, 0 means infinitely long
  carry<span class="token punctuation">_</span></span>over<span class="token italic"><span class="token punctuation">_</span>slots<span class="token punctuation">_</span></span>to<span class="token italic"><span class="token punctuation">_</span>new<span class="token punctuation">_</span></span>session: true  # set to false to forget slots between sessions</code></pre>
<p>è¿™æ„å‘³ç€ï¼Œå¦‚æœç”¨æˆ·åœ¨é—²ç½®60åˆ†é’Ÿåå‘é€äº†ä»–ä»¬çš„ç¬¬ä¸€æ¡æ¶ˆæ¯ï¼Œåˆ™ä¼šè§¦å‘ä¸€ä¸ªæ–°çš„ä¼šè¯ä¼šè¯ï¼Œå¹¶ä¸”æ‰€æœ‰ç°æœ‰çš„æ—¶éš™éƒ½å°†è¢«å¸¦å…¥æ–°çš„ä¼šè¯ä¸­ã€‚å°†å€¼è®¾ç½®<code>session_expiration_time</code>ä¸º0æ„å‘³ç€ä¼šè¯å°†ä¸ä¼šç»“æŸï¼ˆè¯·æ³¨æ„ï¼Œè¯¥<code>action_session_start</code>æ“ä½œä»å°†åœ¨ä¼šè¯å¼€å§‹æ—¶è§¦å‘ï¼‰ã€‚</p>
<blockquote>
<p>æ³¨æ„</p>
<p>ä¼šè¯å¼€å§‹ä¼šè§¦å‘é»˜è®¤æ“ä½œ<code>action_session_start</code>ã€‚å®ƒçš„é»˜è®¤å®ç°å°†æ‰€æœ‰ç°æœ‰çš„æ’æ§½ç§»åˆ°æ–°ä¼šè¯ä¸­ã€‚è¯·æ³¨æ„ï¼Œæ‰€æœ‰å¯¹è¯å‡ä»¥å¼€å¤´<code>action_session_start</code>ã€‚è¦†ç›–æ­¤æ“ä½œå¯ä»¥ä¾‹å¦‚ç”¨äºä½¿ç”¨æ¥è‡ªå¤–éƒ¨APIè°ƒç”¨çš„æ’æ§½åˆå§‹åŒ–è·Ÿè¸ªå™¨ï¼Œæˆ–ä½¿ç”¨æ¼«æ¸¸å™¨æ¶ˆæ¯å¼€å§‹å¯¹è¯ã€‚æœ‰å…³<a href="#">è‡ªå®šä¹‰ä¼šè¯å¼€å§‹æ“ä½œ</a>çš„æ–‡æ¡£ å‘æ‚¨å±•ç¤ºäº†å¦‚ä½•æ‰§è¡Œæ­¤æ“ä½œã€‚</p>
</blockquote>
<h2 id="å“åº”-1"><a href="#å“åº”-1" class="headerlink" title="å“åº”"></a>å“åº”</h2><p>å¦‚æœæ‚¨å¸Œæœ›åŠ©æ‰‹å“åº”ç”¨æˆ·æ¶ˆæ¯ï¼Œåˆ™éœ€è¦ç®¡ç†è¿™äº›å“åº”ã€‚åœ¨æ‚¨çš„æœºå™¨äººçš„è®­ç»ƒæ•°æ®ä¸­ï¼Œæ‚¨çš„æ•…äº‹ä¸­ï¼Œæ‚¨æŒ‡å®šäº†æœºå™¨äººåº”è¯¥æ‰§è¡Œçš„åŠ¨ä½œã€‚è¿™äº›æ“ä½œå¯ä»¥ä½¿ç”¨å“åº”å°†æ¶ˆæ¯å‘é€å›ç”¨æˆ·ã€‚</p>
<p>æœ‰ä¸‰ç§æ–¹æ³•å¯ä»¥ç®¡ç†è¿™äº›å“åº”ï¼š</p>
<ol>
<li>å›å¤é€šå¸¸å­˜å‚¨åœ¨æ‚¨çš„åŸŸæ–‡ä»¶ä¸­ï¼Œè¯·å‚è§<a href="#">æ­¤å¤„</a></li>
<li>æ£€ç´¢åŠ¨ä½œå“åº”æ˜¯è®­ç»ƒæ•°æ®çš„ä¸€éƒ¨åˆ†ï¼Œè¯·å‚è§<a href="#">æ­¤å¤„</a></li>
<li>æ‚¨è¿˜å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰NLGæœåŠ¡ä»¥ç”Ÿæˆå“åº”ï¼Œè¯·å‚è§<a href="#">æ­¤å¤„</a></li>
</ol>
<h3 id="åœ¨åŸŸä¸­åŒ…æ‹¬å“åº”"><a href="#åœ¨åŸŸä¸­åŒ…æ‹¬å“åº”" class="headerlink" title="åœ¨åŸŸä¸­åŒ…æ‹¬å“åº”"></a>åœ¨åŸŸä¸­åŒ…æ‹¬å“åº”</h3><p>é»˜è®¤æ ¼å¼æ˜¯å°†å“åº”åŒ…å«åœ¨åŸŸæ–‡ä»¶ä¸­ã€‚ç„¶åï¼Œè¯¥æ–‡ä»¶åŒ…å«å¯¹æ‰€æœ‰è‡ªå®šä¹‰æ“ä½œï¼Œå¯ç”¨å®ä½“ï¼Œæ’æ§½å’Œæ„å›¾çš„å¼•ç”¨ã€‚</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> all hashtags are comments :)</span>
intents:
 <span class="token list punctuation">-</span> greet
 <span class="token list punctuation">-</span> default
 <span class="token list punctuation">-</span> goodbye
 <span class="token list punctuation">-</span> affirm
 <span class="token list punctuation">-</span> thank_you
 <span class="token list punctuation">-</span> change<span class="token italic"><span class="token punctuation">_</span>bank<span class="token punctuation">_</span></span>details
 <span class="token list punctuation">-</span> simple
 <span class="token list punctuation">-</span> hello
 <span class="token list punctuation">-</span> why
 <span class="token list punctuation">-</span> next_intent

entities:
 <span class="token list punctuation">-</span> name

slots:
  name:
<span class="token code keyword">    type: text</span>

responses:
  utter_greet:
<span class="token code keyword">    - text: "hey there &amp;#123;name&amp;#125;!"  # &amp;#123;name&amp;#125; will be filled by slot (same name) or by custom action</span>
  utter_channel:
<span class="token code keyword">    - text: "this is a default channel"</span>
<span class="token code keyword">    - text: "you're talking to me on slack!"  # if you define channel-specific utterances, the bot will pick</span>
<span class="token code keyword">      channel: "slack"                        # from those when talking on that specific channel</span>
  utter_goodbye:
<span class="token code keyword">    - text: "goodbye ğŸ˜¢"   # multiple responses - bot will randomly pick one of them</span>
<span class="token code keyword">    - text: "bye bye ğŸ˜¢"</span>
  utter<span class="token italic"><span class="token punctuation">_</span>default:   # utterance sent by action<span class="token punctuation">_</span></span>default_fallback
<span class="token code keyword">    - text: "sorry, I didn't get that, can you rephrase it?"</span></code></pre>
<p>åœ¨æ­¤ç¤ºä¾‹åŸŸæ–‡ä»¶ä¸­ï¼Œè¯¥éƒ¨åˆ†<code>responses</code>åŒ…å«åŠ©æ‰‹ç”¨äºå‘ç”¨æˆ·å‘é€æ¶ˆæ¯çš„å“åº”ã€‚</p>
<blockquote>
<p>æ³¨æ„</p>
<p>å¦‚æœè¦æ›´æ”¹æ–‡æœ¬æˆ–æ¼«æ¸¸å™¨å“åº”çš„ä»»ä½•å…¶ä»–éƒ¨åˆ†ï¼Œåˆ™éœ€è¦é‡æ–°åŸ¹è®­åŠ©æ‰‹ï¼Œç„¶åæ‰èƒ½æ¥å—è¿™äº›æ›´æ”¹ã€‚</p>
</blockquote>
<blockquote>
<p>æ³¨æ„</p>
<p>æ•…äº‹ä¸­ä½¿ç”¨çš„å“åº”åº”<code>stories</code> åœ¨domain.ymlæ–‡ä»¶çš„éƒ¨åˆ†ä¸­åˆ—å‡ºã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œ<code>utter_channel</code> æ•…äº‹ä¸­æœªä½¿ç”¨å“åº”ï¼Œå› æ­¤è¯¥éƒ¨åˆ†ä¸­æœªåˆ—å‡ºè¯¥å“åº”ã€‚</p>
</blockquote>
<p>æœ‰å…³è¿™äº›å“åº”æ ¼å¼çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§æœ‰å…³åŸŸæ–‡ä»¶æ ¼å¼çš„æ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="https://legacy-docs-v1.rasa.com/core/domains/#domain-responses">Responses</a>ã€‚</p>
<h3 id="ä¸ºæœºå™¨äººå“åº”åˆ›å»ºè‡ªå·±çš„NLGæœåŠ¡"><a href="#ä¸ºæœºå™¨äººå“åº”åˆ›å»ºè‡ªå·±çš„NLGæœåŠ¡" class="headerlink" title="ä¸ºæœºå™¨äººå“åº”åˆ›å»ºè‡ªå·±çš„NLGæœåŠ¡"></a>ä¸ºæœºå™¨äººå“åº”åˆ›å»ºè‡ªå·±çš„NLGæœåŠ¡</h3><p>åœ¨æŸäº›å·¥ä½œæµç¨‹ä¸­ï¼Œä»…å¯¹æœºå™¨äººè¿›è¡Œå†åŸ¹è®­ä»¥æ›´æ”¹æ–‡æœ¬å‰¯æœ¬å¯èƒ½ä¸æ˜¯æœ€ä½³é€‰æ‹©ã€‚å› æ­¤ï¼ŒCoreè¿˜å…è®¸æ‚¨å°†å“åº”ç”Ÿæˆå¤–åŒ…å¹¶å°†å…¶ä¸å¯¹è¯å­¦ä¹ åŒºåˆ†å¼€ã€‚</p>
<p>åŠ©æ‰‹ä»å°†å­¦ä¹ é¢„æµ‹åŠ¨ä½œå¹¶æ ¹æ®è¿‡å»çš„å¯¹è¯å¯¹ç”¨æˆ·è¾“å…¥åšå‡ºååº”ï¼Œä½†æ˜¯åŠ©æ‰‹å‘é€å›ç”¨æˆ·çš„å“åº”æ˜¯åœ¨Rasa Coreä¹‹å¤–ç”Ÿæˆçš„ã€‚</p>
<p>å¦‚æœåŠ©æ‰‹æƒ³å‘ç”¨æˆ·å‘é€æ¶ˆæ¯ï¼Œå®ƒå°†é€šè¿‡<code>POST</code>è¯·æ±‚è°ƒç”¨å¤–éƒ¨HTTPæœåŠ¡å™¨ã€‚è¦é…ç½®æ­¤ç«¯ç‚¹ï¼Œæ‚¨éœ€è¦åˆ›å»ºä¸€ä¸ª<code>endpoints.yml</code>å¹¶å°†å…¶ä¼ é€’ç»™<code>run</code> æˆ–<code>server</code>è„šæœ¬ã€‚çš„å†…å®¹<code>endpoints.yml</code>åº”ä¸º</p>
<pre class=" language-markdown"><code class="language-markdown">nlg:
  url: http://localhost:5055/nlg    # url of the nlg endpoint
  <span class="token title important"><span class="token punctuation">#</span> you can also specify additional parameters, if you need them:</span>
  <span class="token title important"><span class="token punctuation">#</span> headers:</span>
  <span class="token title important"><span class="token punctuation">#</span>   my-custom-header: value</span>
  <span class="token title important"><span class="token punctuation">#</span> token: "my_authentication_token"    # will be passed as a get parameter</span>
  <span class="token title important"><span class="token punctuation">#</span> basic_auth:</span>
  <span class="token title important"><span class="token punctuation">#</span>   username: user</span>
  <span class="token title important"><span class="token punctuation">#</span>   password: pass</span>
<span class="token title important"><span class="token punctuation">#</span> example of redis external tracker store config</span>
tracker<span class="token italic"><span class="token punctuation">_</span>store:
  type: redis
  url: localhost
  port: 6379
  db: 0
  password: password
  record<span class="token punctuation">_</span></span>exp: 30000
<span class="token title important"><span class="token punctuation">#</span> example of mongoDB external tracker store config</span>
<span class="token title important"><span class="token punctuation">#</span>tracker_store:</span>
  <span class="token title important"><span class="token punctuation">#</span>type: mongod</span>
  <span class="token title important"><span class="token punctuation">#</span>url: mongodb://localhost:27017</span>
  <span class="token title important"><span class="token punctuation">#</span>db: rasa</span>
  <span class="token title important"><span class="token punctuation">#</span>user: username</span>
  <span class="token title important"><span class="token punctuation">#</span>password: password</span></code></pre>
<p>ç„¶ååœ¨å¯åŠ¨æœåŠ¡å™¨æ—¶å°†<code>enable-api</code>æ ‡å¿—ä¼ é€’ç»™å‘½ä»¤ï¼š<code>rasa run</code></p>
<pre class=" language-shell"><code class="language-shell">rasa run \
   --enable-api \
   -m examples/babi/models \
   --log-file out.log \
   --endpoints endpoints.yml</code></pre>
<p><code>POST</code>å‘é€åˆ°ç«¯ç‚¹çš„è¯·æ±‚çš„ä¸»ä½“å°†å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"tracker"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"latest_message"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"text"</span><span class="token operator">:</span> <span class="token string">"/greet"</span><span class="token punctuation">,</span>
      <span class="token property">"intent_ranking"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"confidence"</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"greet"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">"intent"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"confidence"</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"greet"</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      <span class="token property">"entities"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"sender_id"</span><span class="token operator">:</span> <span class="token string">"22ae96a6-85cd-11e8-b1c3-f40f241f6547"</span><span class="token punctuation">,</span>
    <span class="token property">"paused"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">"latest_event_time"</span><span class="token operator">:</span> <span class="token number">1531397673.293572</span><span class="token punctuation">,</span>
    <span class="token property">"slots"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"name"</span><span class="token operator">:</span> <span class="token null">null</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"events"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"timestamp"</span><span class="token operator">:</span> <span class="token number">1531397673.291998</span><span class="token punctuation">,</span>
        <span class="token property">"event"</span><span class="token operator">:</span> <span class="token string">"action"</span><span class="token punctuation">,</span>
        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"action_listen"</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"timestamp"</span><span class="token operator">:</span> <span class="token number">1531397673.293572</span><span class="token punctuation">,</span>
        <span class="token property">"parse_data"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"text"</span><span class="token operator">:</span> <span class="token string">"/greet"</span><span class="token punctuation">,</span>
          <span class="token property">"intent_ranking"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
              <span class="token property">"confidence"</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
              <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"greet"</span>
            &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token property">"intent"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"confidence"</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"greet"</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
          <span class="token property">"entities"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        <span class="token property">"event"</span><span class="token operator">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span>
        <span class="token property">"text"</span><span class="token operator">:</span> <span class="token string">"/greet"</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    <span class="token punctuation">]</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"arguments"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>&amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"template"</span><span class="token operator">:</span> <span class="token string">"utter_greet"</span><span class="token punctuation">,</span>
  <span class="token property">"channel"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"collector"</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span></code></pre>
<p>ç„¶åï¼Œç«¯ç‚¹éœ€è¦ä½¿ç”¨ç”Ÿæˆçš„å“åº”è¿›è¡Œå“åº”ï¼š</p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"text"</span><span class="token operator">:</span> <span class="token string">"hey there"</span><span class="token punctuation">,</span>
    <span class="token property">"buttons"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"image"</span><span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>
    <span class="token property">"elements"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"attachments"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span></code></pre>
<p>ç„¶åï¼ŒRasaå°†ä½¿ç”¨æ­¤å“åº”å¹¶å°†å…¶å‘é€å›ç”¨æˆ·ã€‚</p>
<h2 id="ä¸»åŠ¨é€šè¿‡å¤–éƒ¨äº‹ä»¶ä¸ç”¨æˆ·è”ç³»"><a href="#ä¸»åŠ¨é€šè¿‡å¤–éƒ¨äº‹ä»¶ä¸ç”¨æˆ·è”ç³»" class="headerlink" title="ä¸»åŠ¨é€šè¿‡å¤–éƒ¨äº‹ä»¶ä¸ç”¨æˆ·è”ç³»"></a>ä¸»åŠ¨é€šè¿‡å¤–éƒ¨äº‹ä»¶ä¸ç”¨æˆ·è”ç³»</h2><p>æ‚¨å¯èƒ½å¸Œæœ›ä¸»åŠ¨ä¸ç”¨æˆ·è”ç³»ï¼Œä¾‹å¦‚æ˜¾ç¤ºé•¿æ—¶é—´è¿è¡Œçš„åå°æ“ä½œçš„è¾“å‡ºæˆ–å°†å¤–éƒ¨äº‹ä»¶é€šçŸ¥ç»™ç”¨æˆ·ã€‚è¦äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·<a target="_blank" rel="noopener" href="https://github.com/RasaHQ/rasa/tree/master/examples/reminderbot/README.md">reminderbot</a>åœ¨èä¾‹å­ç›®å½•æˆ–å¯è€ƒè™‘<a href="#">æé†’å’Œå¤–éƒ¨äº‹ä»¶</a>ã€‚</p>
<h2 id="åŠ¨ä½œ-1"><a href="#åŠ¨ä½œ-1" class="headerlink" title="åŠ¨ä½œ"></a>åŠ¨ä½œ</h2><p>åŠ¨ä½œæ˜¯æ‚¨çš„æœºå™¨äººæ ¹æ®ç”¨æˆ·è¾“å…¥è¿è¡Œçš„ä¸œè¥¿ã€‚Rasaä¸­æœ‰å››ç§åŠ¨ä½œï¼š</p>
<blockquote>
<ol>
<li><strong>è¯è¯­æ“ä½œ</strong>ï¼šä»å¼€å§‹<code>utter_</code>å¹¶å‘ç”¨æˆ·å‘é€ç‰¹å®šæ¶ˆæ¯ã€‚</li>
<li><strong>æ£€ç´¢åŠ¨ä½œ</strong>ï¼š<code>respond_</code>ä»¥æ£€ç´¢æ¨¡å‹é€‰æ‹©çš„æ¶ˆæ¯å¼€å¤´å¹¶å‘é€æ¶ˆæ¯ã€‚</li>
<li><strong>è‡ªå®šä¹‰æ“ä½œ</strong>ï¼šè¿è¡Œä»»æ„ä»£ç å¹¶å‘é€ä»»æ„æ•°é‡çš„æ¶ˆæ¯ï¼ˆæˆ–ä¸å‘é€ä»»ä½•æ¶ˆæ¯ï¼‰ã€‚</li>
<li><strong>é»˜è®¤åŠ¨ä½œ</strong>ï¼šä¾‹å¦‚<code>action_listen</code>ï¼Œ<code>action_restart</code>ï¼Œ <code>action_default_fallback</code>ã€‚</li>
</ol>
</blockquote>
<ul>
<li><a href="#">è¯è¯­åŠ¨ä½œ</a></li>
<li><a href="#">æ£€ç´¢åŠ¨ä½œ</a></li>
<li><a href="#">è‡ªå®šä¹‰åŠ¨ä½œ</a><ul>
<li><a href="#">ç”¨Pythonç¼–å†™çš„è‡ªå®šä¹‰åŠ¨ä½œ</a></li>
</ul>
</li>
<li><a href="#">ç”¨å…¶ä»–ä»£ç æ‰§è¡ŒåŠ¨ä½œ</a></li>
<li><a href="#">é»˜è®¤åŠ¨ä½œ</a></li>
</ul>
<h3 id="è¯è¯­åŠ¨ä½œ"><a href="#è¯è¯­åŠ¨ä½œ" class="headerlink" title="è¯è¯­åŠ¨ä½œ"></a>è¯è¯­åŠ¨ä½œ</h3><p>è¦å®šä¹‰è¯­éŸ³æ“ä½œï¼ˆ<code>ActionUtterTemplate</code>ï¼‰ï¼Œè¯·å‘ä»¥ä»¥ä¸‹å†…å®¹å¼€å¤´çš„åŸŸæ–‡ä»¶æ·»åŠ å“åº”<code>utter_</code>ï¼š</p>
<pre><code>responses:
  utter_my_message:
    - "this is what I want my action to say!"</code></pre>
<p>é€šå¸¸ç”¨æ¥å¼€å¤´å‘å£°åŠ¨ä½œçš„åç§°<code>utter_</code>ã€‚å¦‚æœç¼ºå°‘æ­¤å‰ç¼€ï¼Œæ‚¨ä»ç„¶å¯ä»¥åœ¨è‡ªå®šä¹‰æ“ä½œä¸­ä½¿ç”¨å“åº”ï¼Œä½†æ˜¯ä¸èƒ½å°†å“åº”ç›´æ¥é¢„æµ‹ä¸ºå®ƒè‡ªå·±çš„æ“ä½œã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§<a href="#">å“åº”</a>ã€‚</p>
<p>å¦‚æœä½¿ç”¨å¤–éƒ¨NLGæœåŠ¡ï¼Œåˆ™æ— éœ€åœ¨åŸŸä¸­æŒ‡å®šå“åº”ï¼Œä½†ä»éœ€è¦å°†è¯è¯­åç§°æ·»åŠ åˆ°åŸŸçš„æ“ä½œåˆ—è¡¨ä¸­ã€‚</p>
<h3 id="æ£€ç´¢æ“ä½œ"><a href="#æ£€ç´¢æ“ä½œ" class="headerlink" title="æ£€ç´¢æ“ä½œ"></a>æ£€ç´¢æ“ä½œ</h3><p>æ£€ç´¢æ“ä½œä½¿å¤„ç†è¯¸å¦‚chitchatå’ŒFAQä¹‹ç±»çš„å¤§é‡ç›¸ä¼¼æ„å›¾å˜å¾—æ›´åŠ å®¹æ˜“ã€‚è¯·å‚é˜…<a href="#">æ£€ç´¢æ“ä½œ</a>ä»¥äº†è§£æ›´å¤šä¿¡æ¯ã€‚</p>
<h3 id="è‡ªå®šä¹‰åŠ¨ä½œ"><a href="#è‡ªå®šä¹‰åŠ¨ä½œ" class="headerlink" title="è‡ªå®šä¹‰åŠ¨ä½œ"></a>è‡ªå®šä¹‰åŠ¨ä½œ</h3><p>ä¸€ä¸ªåŠ¨ä½œå¯ä»¥è¿è¡Œæ‚¨æƒ³è¦çš„ä»»ä½•ä»£ç ã€‚è‡ªå®šä¹‰æ“ä½œå¯ä»¥æ‰“å¼€ç¯ï¼Œå°†äº‹ä»¶æ·»åŠ åˆ°æ—¥å†ï¼Œæ£€æŸ¥ç”¨æˆ·çš„é“¶è¡Œä½™é¢ï¼Œæˆ–è€…æ‚¨å¯ä»¥æƒ³è±¡çš„å…¶ä»–ä»»ä½•äº‹æƒ…ã€‚</p>
<p>å½“é¢„æµ‹åˆ°è‡ªå®šä¹‰æ“ä½œæ—¶ï¼ŒRasaä¼šè°ƒç”¨æ‚¨å¯ä»¥æŒ‡å®šçš„ç«¯ç‚¹ã€‚è¯¥ç»ˆç»“ç‚¹åº”è¯¥æ˜¯å“åº”æ­¤è°ƒç”¨ï¼Œè¿è¡Œä»£ç å¹¶æœ‰é€‰æ‹©åœ°è¿”å›ä¿¡æ¯ä»¥ä¿®æ”¹å¯¹è¯çŠ¶æ€çš„WebæœåŠ¡å™¨ã€‚</p>
<p>è¦æŒ‡å®šï¼Œæ‚¨çš„åŠ¨ä½œæœåŠ¡å™¨ä½¿ç”¨<code>endpoints.yml</code>ï¼š</p>
<pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">action_endpoint</span><span class="token punctuation">:</span>
  <span class="token key atrule">url</span><span class="token punctuation">:</span> <span class="token string">"http://localhost:5055/webhook"</span></code></pre>
<p>å¹¶ä½¿ç”¨å°†å…¶ä¼ é€’ç»™è„šæœ¬ã€‚<code>--endpoints endpoints.yml</code></p>
<p>æ‚¨å¯ä»¥ä½¿ç”¨node.jsï¼Œ.NETï¼Œjavaæˆ–ä»»ä½•å…¶ä»–è¯­è¨€åˆ›å»ºåŠ¨ä½œæœåŠ¡å™¨ï¼Œå¹¶åœ¨å…¶ä¸­å®šä¹‰æ‚¨çš„åŠ¨ä½œ-ä½†æ˜¯æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå°å‹python SDKï¼Œå¯ä»¥ä½¿åœ¨é‚£é‡Œçš„å¼€å‘æ›´åŠ è½»æ¾ã€‚</p>
<blockquote>
<p>æ³¨æ„</p>
<p>Rasaä½¿ç”¨ç¥¨è¯é”å®šæœºåˆ¶æ¥ç¡®ä¿æ¥è‡ªç›¸åŒå¯¹è¯IDçš„ä¼ å…¥æ¶ˆæ¯ä¸ä¼šäº’ç›¸å¹²æ‰°ï¼Œå¹¶ä¸”ä¼šä»¥æ­£ç¡®çš„é¡ºåºè¿›è¡Œå¤„ç†ã€‚å¦‚æœæ‚¨å¸Œæœ›æ‚¨çš„è‡ªå®šä¹‰æ“ä½œéœ€è¦60ç§’é’Ÿä»¥ä¸Šæ‰èƒ½è¿è¡Œï¼Œè¯·å°†<code>TICKET_LOCK_LIFETIME</code>ç¯å¢ƒå˜é‡è®¾ç½®ä¸ºæ‚¨çš„æœŸæœ›å€¼ã€‚</p>
</blockquote>
<h4 id="ç”¨Pythonç¼–å†™çš„è‡ªå®šä¹‰åŠ¨ä½œ"><a href="#ç”¨Pythonç¼–å†™çš„è‡ªå®šä¹‰åŠ¨ä½œ" class="headerlink" title="ç”¨Pythonç¼–å†™çš„è‡ªå®šä¹‰åŠ¨ä½œ"></a>ç”¨Pythonç¼–å†™çš„è‡ªå®šä¹‰åŠ¨ä½œ</h4><p>å¯¹äºç”¨pythonç¼–å†™çš„åŠ¨ä½œï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæ–¹ä¾¿çš„<a href="#">Rasa SDK</a>ï¼Œå¯ä¸ºæ‚¨å¯åŠ¨è¯¥åŠ¨ä½œæœåŠ¡å™¨ã€‚</p>
<h3 id="ç”¨å…¶ä»–ä»£ç æ‰§è¡ŒåŠ¨ä½œ"><a href="#ç”¨å…¶ä»–ä»£ç æ‰§è¡ŒåŠ¨ä½œ" class="headerlink" title="ç”¨å…¶ä»–ä»£ç æ‰§è¡ŒåŠ¨ä½œ"></a>ç”¨å…¶ä»–ä»£ç æ‰§è¡ŒåŠ¨ä½œ</h3><p>Rasaä¼šå°†HTTP<code>POST</code>è¯·æ±‚å‘é€åˆ°æ‚¨çš„æœåŠ¡å™¨ï¼Œå…¶ä¸­åŒ…å«æœ‰å…³è¦è¿è¡Œçš„æ“ä½œçš„ä¿¡æ¯ã€‚æ­¤å¤–ï¼Œæ­¤è¯·æ±‚å°†åŒ…å«æœ‰å…³å¯¹è¯çš„æ‰€æœ‰ä¿¡æ¯ã€‚<a href="#">Action Server</a>æ˜¾ç¤ºäº†è¯¦ç»†çš„APIè§„èŒƒã€‚</p>
<p>ä½œä¸ºå¯¹æ¥è‡ªRasaçš„æ“ä½œè°ƒç”¨çš„å“åº”ï¼Œæ‚¨å¯ä»¥ä¿®æ”¹è·Ÿè¸ªå™¨ï¼Œä¾‹å¦‚é€šè¿‡è®¾ç½®æ’æ§½å¹¶å°†å“åº”å‘é€å›ç”¨æˆ·ã€‚æ‰€æœ‰ä¿®æ”¹éƒ½æ˜¯ä½¿ç”¨äº‹ä»¶å®Œæˆçš„ã€‚åœ¨<a href="#">Events</a>ä¸­æœ‰æ‰€æœ‰å¯èƒ½çš„äº‹ä»¶ç±»å‹çš„åˆ—è¡¨ã€‚</p>
<h3 id="é»˜è®¤åŠ¨ä½œ"><a href="#é»˜è®¤åŠ¨ä½œ" class="headerlink" title="é»˜è®¤åŠ¨ä½œ"></a>é»˜è®¤åŠ¨ä½œ</h3><p>å¯ç”¨çš„é»˜è®¤æ“ä½œæ˜¯ï¼š</p>
<table>
<thead>
<tr>
<th><code>action_listen</code></th>
<th>åœæ­¢é¢„æµ‹æ›´å¤šåŠ¨ä½œå¹¶ç­‰å¾…ç”¨æˆ·è¾“å…¥ã€‚</th>
</tr>
</thead>
<tbody><tr>
<td><code>action_restart</code></td>
<td>é‡è®¾æ•´ä¸ªå¯¹è¯ã€‚å¯ä»¥åœ¨å¯¹è¯æœŸé—´é€šè¿‡è¾“å…¥<code>/restart</code> æ˜¯å¦åœ¨ç­–ç•¥é…ç½®ä¸­åŒ…æ‹¬<a href="#">æ˜ å°„ç­–ç•¥</a>æ¥è§¦å‘ã€‚</td>
</tr>
<tr>
<td><code>action_session_start</code></td>
<td>å¼€å§‹ä¸€ä¸ªæ–°çš„å¯¹è¯ä¼šè¯ã€‚å ç”¨æ‰€æœ‰å·²è®¾ç½®çš„æ—¶æ®µï¼Œæ ‡è®°æ–°å¯¹è¯ä¼šè¯çš„å¼€å§‹å¹¶é‡æ–°åº”ç”¨ç°æœ‰<code>SlotSet</code> äº‹ä»¶ã€‚<code>session_expiration_time</code>åœ¨åŸŸçš„â€œ<a href="#">ä¼šè¯â€é…ç½®ä¸­</a>çš„å‚æ•°å®šä¹‰çš„ä¸æ´»åŠ¨æ—¶é—´è¿‡åï¼Œå°†è‡ªåŠ¨è§¦å‘æ­¤æ“ä½œ ã€‚å¯ä»¥åœ¨é€šè¯è¿‡ç¨‹ä¸­é€šè¿‡è¾“å…¥æ‰‹åŠ¨è§¦å‘<code>/session_start</code>ã€‚æ‰€æœ‰å¯¹è¯å‡ä»¥å¼€å¤´<code>action_session_start</code>ã€‚</td>
</tr>
<tr>
<td><code>action_default_fallback</code></td>
<td>æ’¤æ¶ˆä¸Šä¸€æ¡ç”¨æˆ·æ¶ˆæ¯ï¼ˆå¥½åƒç”¨æˆ·æœªå‘é€è¯¥æ¶ˆæ¯ï¼Œå¹¶ä¸”æ¼«æ¸¸å™¨æœªåšå‡ºååº”ï¼‰ï¼Œå¹¶è¯´å‡ºæ¼«æ¸¸å™¨ä¸ç†è§£çš„æ¶ˆæ¯ã€‚è¯·å‚é˜…<a href="#">åå¤‡æ“ä½œ</a>ã€‚</td>
</tr>
<tr>
<td><code>action_deactivate_form</code></td>
<td>åœç”¨æ´»åŠ¨è¡¨æ ¼å¹¶é‡ç½®è¯·æ±‚çš„æ’æ§½ã€‚å¦è¯·å‚é˜…<a href="#">å¤„ç†ä¸æ„‰å¿«çš„é“è·¯</a>ã€‚</td>
</tr>
<tr>
<td><code>action_revert_fallback_events</code></td>
<td>è¿˜åŸåœ¨TwoStageFallbackPolicyæœŸé—´å‘ç”Ÿçš„äº‹ä»¶ã€‚è¯·å‚é˜…<a href="#">åå¤‡æ“ä½œ</a>ã€‚</td>
</tr>
<tr>
<td><code>action_default_ask_affirmation</code></td>
<td>è¦æ±‚ç”¨æˆ·ç¡®è®¤å…¶æ„å›¾ã€‚å»ºè®®ä½¿ç”¨è‡ªå®šä¹‰æ“ä½œè¦†ç›–æ­¤é»˜è®¤æ“ä½œï¼Œä»¥è·å–æ›´æœ‰æ„ä¹‰çš„æç¤ºã€‚</td>
</tr>
<tr>
<td><code>action_default_ask_rephrase</code></td>
<td>è¦æ±‚ç”¨æˆ·é‡æ–°è¡¨è¾¾è‡ªå·±çš„æ„å›¾ã€‚</td>
</tr>
<tr>
<td><code>action_back</code></td>
<td>æ’¤æ¶ˆä¸Šä¸€æ¡ç”¨æˆ·æ¶ˆæ¯ï¼ˆå¥½åƒç”¨æˆ·æœªå‘é€è¯¥æ¶ˆæ¯ï¼Œå¹¶ä¸”æ¼«æ¸¸å™¨æœªåšå‡ºååº”ï¼‰ã€‚å¯ä»¥åœ¨å¯¹è¯æœŸé—´é€šè¿‡è¾“å…¥<code>/back</code>æ˜¯å¦åœ¨ç­–ç•¥é…ç½®ä¸­åŒ…å«MappingPolicyæ¥è§¦å‘ã€‚</td>
</tr>
</tbody></table>
<p>å¯ä»¥è¦†ç›–æ‰€æœ‰é»˜è®¤æ“ä½œã€‚ä¸ºæ­¤ï¼Œè¯·å°†æ“ä½œåç§°æ·»åŠ åˆ°æ‚¨åŸŸä¸­çš„æ“ä½œåˆ—è¡¨ä¸­ï¼š</p>
<pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">actions</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> action_default_ask_affirmation</code></pre>
<p>ç„¶åï¼ŒRasaå°†è°ƒç”¨æ‚¨çš„æ“ä½œç»ˆç»“ç‚¹ï¼Œå¹¶å°†å…¶è§†ä¸ºå…¶ä»–æ‰€æœ‰è‡ªå®šä¹‰æ“ä½œã€‚</p>
<h2 id="æé†’å’Œå¤–éƒ¨äº‹ä»¶"><a href="#æé†’å’Œå¤–éƒ¨äº‹ä»¶" class="headerlink" title="æé†’å’Œå¤–éƒ¨äº‹ä»¶"></a>æé†’å’Œå¤–éƒ¨äº‹ä»¶</h2><p>è¯¥<code>ReminderScheduled</code>äº‹ä»¶å’Œ <a href="#">trigger_intentç«¯ç‚¹</a>ä½¿æ‚¨çš„åŠ©æ‰‹å¯ä»¥åœ¨ç»™å®šæ—¶é—´æ®µå†…æé†’æ‚¨æœ‰å…³äº‹ç‰©çš„ä¿¡æ¯ï¼Œæˆ–å“åº”å¤–éƒ¨äº‹ä»¶ï¼ˆå…¶ä»–åº”ç”¨ç¨‹åºï¼Œä¼ æ„Ÿå™¨ç­‰ï¼‰ã€‚æ‚¨å¯ä»¥<a target="_blank" rel="noopener" href="https://github.com/RasaHQ/rasa/tree/master/examples/reminderbot/README.md">åœ¨æ­¤å¤„</a>æ‰¾åˆ°å®ç°è¿™äº›åŠŸèƒ½çš„å®Œæ•´ç¤ºä¾‹åŠ©æ‰‹ ã€‚</p>
<ul>
<li><a href="#">æé†’äº‹é¡¹</a><ul>
<li><a href="#">å®‰æ’æé†’</a></li>
<li><a href="#">å–æ¶ˆæé†’</a></li>
</ul>
</li>
<li><a href="#">å¤–éƒ¨æ´»åŠ¨</a><ul>
<li><a href="#">è·å–å¯¹è¯ID</a></li>
<li><a href="#">åº”å¯¹å¤–éƒ¨äº‹ä»¶</a></li>
</ul>
</li>
</ul>
<h3 id="æé†’"><a href="#æé†’" class="headerlink" title="æé†’"></a>æé†’</h3><p>å¯èƒ½éœ€è¦åœ¨ä¸€æ®µæ—¶é—´åæé†’æ‚¨ä¸€äº›äº‹æƒ…ï¼Œè€Œä¸æ˜¯ä½¿ç”¨å¤–éƒ¨ä¼ æ„Ÿå™¨ã€‚ä¸ºæ­¤ï¼ŒRasaæä¾›äº†ç‰¹æ®Šäº‹ä»¶<code>ReminderScheduled</code>å’Œå¦ä¸€ä¸ªäº‹ä»¶<code>ReminderCancelled</code>ï¼Œä»¥å–æ¶ˆå®‰æ’æé†’æ—¶é—´ã€‚</p>
<h3 id="è®¡åˆ’æé†’"><a href="#è®¡åˆ’æé†’" class="headerlink" title="è®¡åˆ’æé†’"></a>è®¡åˆ’æé†’</h3><p>å‡è®¾æ‚¨å¸Œæœ›åŠ©æ‰‹æé†’æ‚¨åœ¨5ç§’é’Ÿå†…æ‰“ç”µè¯ç»™æœ‹å‹ã€‚ï¼ˆæ‚¨å¯èƒ½éœ€è¦æ›´é•¿çš„æ—¶é—´è·¨åº¦ï¼Œä½†æ˜¯ä¸ºäº†è¿›è¡Œæµ‹è¯•ï¼Œå°†å…¶è®¾ä¸º5ç§’ã€‚ï¼‰å› æ­¤ï¼Œæˆ‘ä»¬<code>ask_remind_call</code>ä½¿ç”¨ä¸€äº›NLUæ•°æ®å®šä¹‰äº†ä¸€ä¸ªæ„å›¾ï¼Œ</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">##</span> intent:ask_remind_call</span>
<span class="token list punctuation">-</span> remind me to call <span class="token url">[Albert](name)</span>
<span class="token list punctuation">-</span> remind me to call <span class="token url">[Susan](name)</span>
<span class="token list punctuation">-</span> later I have to call <span class="token url">[Daksh](name)</span>
<span class="token list punctuation">-</span> later I have to call <span class="token url">[Anna](name)</span>
...</code></pre>
<p>å¹¶å°†æ­¤æ„å›¾ä¸æ–°çš„è‡ªå®šä¹‰æ“ä½œç›¸å…³è”<code>action_set_reminder</code>ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æä¾›åŸ¹è®­æ•…äº‹ï¼ˆæ¨èç»™æ›´å¤æ‚çš„åŠ©æ‰‹ï¼‰æˆ–ä½¿ç”¨<a href="#">Mapping Policyå»ºç«‹è”ç³»</a>ã€‚</p>
<p>è‡ªå®šä¹‰æ“ä½œ<code>action_set_reminder</code>åº”å®‰æ’ä¸€ä¸ªæé†’ï¼Œè¯¥æé†’åœ¨5ç§’é’Ÿåè§¦å‘<code>EXTERNAL_reminder</code>ç”¨æˆ·åœ¨å…¶ä¸Šä¸€æ¡æ¶ˆæ¯ä¸­æä¾›çš„æ‰€æœ‰å®ä½“çš„æ„å›¾ï¼ˆç±»ä¼¼äºå¤–éƒ¨äº‹ä»¶ï¼‰ï¼š</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">ActionSetReminder</span><span class="token punctuation">(</span>Action<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Schedules a reminder, supplied with the last message's entities."""</span>

    <span class="token keyword">def</span> <span class="token function">name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Text<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"action_set_reminder"</span>

    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>
        self<span class="token punctuation">,</span>
        dispatcher<span class="token punctuation">:</span> CollectingDispatcher<span class="token punctuation">,</span>
        tracker<span class="token punctuation">:</span> Tracker<span class="token punctuation">,</span>
        domain<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span>Text<span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> List<span class="token punctuation">[</span>Dict<span class="token punctuation">[</span>Text<span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>

        dispatcher<span class="token punctuation">.</span>utter_message<span class="token punctuation">(</span><span class="token string">"I will remind you in 5 seconds."</span><span class="token punctuation">)</span>

        date <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> datetime<span class="token punctuation">.</span>timedelta<span class="token punctuation">(</span>seconds<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
        entities <span class="token operator">=</span> tracker<span class="token punctuation">.</span>latest_message<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"entities"</span><span class="token punctuation">)</span>

        reminder <span class="token operator">=</span> ReminderScheduled<span class="token punctuation">(</span>
            <span class="token string">"EXTERNAL_reminder"</span><span class="token punctuation">,</span>
            trigger_date_time<span class="token operator">=</span>date<span class="token punctuation">,</span>
            entities<span class="token operator">=</span>entities<span class="token punctuation">,</span>
            name<span class="token operator">=</span><span class="token string">"my_reminder"</span><span class="token punctuation">,</span>
            kill_on_user_message<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>

        <span class="token keyword">return</span> <span class="token punctuation">[</span>reminder<span class="token punctuation">]</span></code></pre>
<p>è¯·æ³¨æ„ï¼Œè¿™éœ€è¦<code>datetime</code>å’Œ<code>rasa_sdk.events</code>è½¯ä»¶åŒ…ã€‚</p>
<p>æœ€åï¼Œæˆ‘ä»¬å®šä¹‰å¦ä¸€ä¸ªè‡ªå®šä¹‰åŠ¨ä½œ<code>action_react_to_reminder</code>å¹¶å°†å…¶é“¾æ¥åˆ°<code>EXTERNAL_reminder</code>æ„å›¾ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token list punctuation">-</span> EXTERNAL<span class="token italic"><span class="token punctuation">_</span>reminder:
  triggers: action<span class="token punctuation">_</span></span>react<span class="token italic"><span class="token punctuation">_</span>to<span class="token punctuation">_</span></span>reminder</code></pre>
<p>å…¶ä¸­ï¼Œ<code>action_react_to_reminder</code>ä¸º</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">ActionReactToReminder</span><span class="token punctuation">(</span>Action<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Reminds the user to call someone."""</span>

    <span class="token keyword">def</span> <span class="token function">name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Text<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"action_react_to_reminder"</span>

    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>
        self<span class="token punctuation">,</span>
        dispatcher<span class="token punctuation">:</span> CollectingDispatcher<span class="token punctuation">,</span>
        tracker<span class="token punctuation">:</span> Tracker<span class="token punctuation">,</span>
        domain<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span>Text<span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> List<span class="token punctuation">[</span>Dict<span class="token punctuation">[</span>Text<span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>

        name <span class="token operator">=</span> next<span class="token punctuation">(</span>tracker<span class="token punctuation">.</span>get_latest_entity_values<span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"someone"</span><span class="token punctuation">)</span>
        dispatcher<span class="token punctuation">.</span>utter_message<span class="token punctuation">(</span>f<span class="token string">"Remember to call &amp;#123;name&amp;#125;!"</span><span class="token punctuation">)</span>

        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></code></pre>
<p>é™¤äº†è‡ªå®šä¹‰æ“ä½œï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ç®€å•çš„å“åº”æ¨¡æ¿ã€‚ä½†æ˜¯åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è¦åˆ©ç”¨æé†’å¯ä»¥æºå¸¦å®ä½“çš„äº‹å®ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥åœ¨æ­¤è‡ªå®šä¹‰æ“ä½œä¸­å¤„ç†å®ä½“ã€‚</p>
<blockquote>
<p>è­¦å‘Š</p>
<p>æ¯å½“æ‚¨å…³é—­RasaæœåŠ¡å™¨æ—¶ï¼Œæé†’éƒ½ä¼šè¢«å–æ¶ˆã€‚</p>
</blockquote>
<blockquote>
<p>è­¦å‘Š</p>
<p>å½“å‰æé†’ï¼ˆRasa 1.8ï¼‰ä¸é€‚ç”¨äºrasa shellã€‚æ‚¨å¿…é¡»ä½¿ç”¨<a href="#">æ­£åœ¨è¿è¡Œçš„Rasa XæœåŠ¡å™¨</a>æ¥æµ‹è¯•å®ƒä»¬ ã€‚</p>
</blockquote>
<blockquote>
<p>æ³¨æ„</p>
<p>ä¸»åŠ¨è”ç³»ç”¨æˆ·å–å†³äºæ¸ é“çš„èƒ½åŠ›ï¼Œå› æ­¤å¹¶éæ¯ä¸ªæ¸ é“éƒ½æ”¯æŒã€‚å¦‚æœæ‚¨çš„é¢‘é“ä¸æ”¯æŒå®ƒï¼Œè¯·è€ƒè™‘ä½¿ç”¨<a href="#">CallbackInput</a>é¢‘é“å°†æ¶ˆæ¯å‘é€åˆ°<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Webhook">webhook</a>ã€‚</p>
</blockquote>
<h3 id="å–æ¶ˆæé†’"><a href="#å–æ¶ˆæé†’" class="headerlink" title="å–æ¶ˆæé†’"></a>å–æ¶ˆæé†’</h3><p>æœ‰æ—¶ï¼Œç”¨æˆ·å¯èƒ½æƒ³å–æ¶ˆä»–ä¹‹å‰å·²å®‰æ’çš„æé†’ã€‚å‘åŠ©æ‰‹æ·»åŠ æ­¤åŠŸèƒ½çš„ä¸€ç§ç®€å•æ–¹æ³•æ˜¯åˆ›å»ºä¸€ä¸ªæ„å›¾ï¼Œ<code>ask_forget_reminders</code>ç„¶åè®©åŠ©æ‰‹é€šè¿‡è‡ªå®šä¹‰æ“ä½œï¼ˆä¾‹å¦‚</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">ForgetReminders</span><span class="token punctuation">(</span>Action<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Cancels all reminders."""</span>

    <span class="token keyword">def</span> <span class="token function">name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Text<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"action_forget_reminders"</span>

    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>
        self<span class="token punctuation">,</span> dispatcher<span class="token punctuation">,</span> tracker<span class="token punctuation">:</span> Tracker<span class="token punctuation">,</span> domain<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span>Text<span class="token punctuation">,</span> Any<span class="token punctuation">]</span>
    <span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> List<span class="token punctuation">[</span>Dict<span class="token punctuation">[</span>Text<span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>

        dispatcher<span class="token punctuation">.</span>utter_message<span class="token punctuation">(</span>f<span class="token string">"Okay, I'll cancel all your reminders."</span><span class="token punctuation">)</span>

        <span class="token comment" spellcheck="true"># Cancel all reminders</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>ReminderCancelled<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span></code></pre>
<p>åœ¨è¿™é‡Œï¼Œ<code>ReminderCancelled()</code>åªéœ€å–æ¶ˆå½“å‰é¢„å®šçš„æ‰€æœ‰æé†’ã€‚æˆ–è€…ï¼Œæ‚¨å¯ä»¥æä¾›ä¸€äº›å‚æ•°æ¥ç¼©å°è¦å–æ¶ˆçš„æé†’çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼Œ</p>
<ul>
<li><code>ReminderCancelled(intent="greet")</code> æ•…æ„å–æ¶ˆæ‰€æœ‰æé†’ <code>greet</code></li>
<li><code>ReminderCancelled(entities={...})</code> å–æ¶ˆç»™å®šå®ä½“çš„æ‰€æœ‰æé†’</li>
<li><code>ReminderCancelled("...")</code>å–æ¶ˆ<code>...</code>æ‚¨åœ¨åˆ›å»ºè¿‡ç¨‹ä¸­æä¾›çš„å…·æœ‰ç»™å®šåç§°â€œ â€çš„å”¯ä¸€æé†’</li>
</ul>
<h3 id="å¤–éƒ¨äº‹ä»¶"><a href="#å¤–éƒ¨äº‹ä»¶" class="headerlink" title="å¤–éƒ¨äº‹ä»¶"></a>å¤–éƒ¨äº‹ä»¶</h3><p>å‡è®¾æ‚¨è¦ä»å…¶ä»–è®¾å¤‡å‘é€æ¶ˆæ¯ä»¥æ›´æ”¹æ­£åœ¨è¿›è¡Œçš„å¯¹è¯çš„è¿‡ç¨‹ã€‚ä¾‹å¦‚ï¼Œè¿æ¥åˆ°Raspberry Piçš„ä¸€äº›æ¹¿åº¦ä¼ æ„Ÿå™¨åº”é€šçŸ¥æ‚¨çš„ç§äººåŠ©ç†æ‚¨æœ€å–œæ¬¢çš„æ¤ç‰©éœ€è¦æµ‡æ°´ï¼Œç„¶åæ‚¨çš„åŠ©ç†åº”å°†æ­¤æ¶ˆæ¯è½¬å‘ç»™æ‚¨ã€‚</p>
<p>ä¸ºæ­¤ï¼Œæ‚¨çš„Raspberry Piéœ€è¦å‘å¯¹è¯çš„<a href="#">trigger_intentç«¯ç‚¹</a>å‘é€ä¸€æ¡æ¶ˆæ¯ã€‚é¡¾åæ€ä¹‰ï¼Œè¿™å°†ç”¨æˆ·æ„å›¾ï¼ˆå¯èƒ½ä¸å®ä½“ï¼‰æ³¨å…¥åˆ°æ‚¨çš„å¯¹è¯ä¸­ã€‚å› æ­¤ï¼Œå¯¹äºRasaæ¥è¯´ï¼Œå‡ ä¹å°±åƒæ‚¨è¾“å…¥çš„æ¶ˆæ¯ä¸€æ ·ï¼Œæ ¹æ®æ­¤æ„å›¾å’Œè¿™äº›å®ä½“è¿›è¡Œäº†åˆ†ç±»ã€‚ç„¶åï¼ŒRasaéœ€è¦ä½¿ç”¨è¯¸å¦‚çš„æ“ä½œæ¥å“åº”æ­¤è¾“å…¥<code>action_warn_dry</code>ã€‚å°†æ­¤æ“ä½œä¸æ„å›¾è”ç³»èµ·æ¥çš„æœ€ç®€å•ï¼Œæœ€å¯é çš„æ–¹æ³•æ˜¯é€šè¿‡â€œ<a href="#">æ˜ å°„ç­–ç•¥â€</a>ã€‚</p>
<h3 id="è·å–ä¼šè¯"><a href="#è·å–ä¼šè¯" class="headerlink" title="è·å–ä¼šè¯"></a>è·å–ä¼šè¯</h3><p>æˆ‘ä»¬éœ€è¦çš„ç¬¬ä¸€ä»¶äº‹æ˜¯ä¼ æ„Ÿå™¨åº”å‘å…¶å‘é€é€šçŸ¥çš„ä¼šè¯çš„ä¼šè¯IDã€‚ä¸€ç§ç®€å•çš„æ–¹æ³•æ˜¯å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰åŠ¨ä½œï¼ˆè¯·å‚é˜…<a href="#">Custom Actions</a>ï¼‰ï¼Œè¯¥<a href="#">åŠ¨ä½œ</a>åœ¨å¯¹è¯ä¸­æ˜¾ç¤ºIDã€‚ä¾‹å¦‚ï¼š</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">ActionTellID</span><span class="token punctuation">(</span>Action<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Informs the user about the conversation ID."""</span>

    <span class="token keyword">def</span> <span class="token function">name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Text<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"action_tell_id"</span>

    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>
        self<span class="token punctuation">,</span> dispatcher<span class="token punctuation">,</span> tracker<span class="token punctuation">:</span> Tracker<span class="token punctuation">,</span> domain<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span>Text<span class="token punctuation">,</span> Any<span class="token punctuation">]</span>
    <span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> List<span class="token punctuation">[</span>Dict<span class="token punctuation">[</span>Text<span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>

        conversation_id <span class="token operator">=</span> tracker<span class="token punctuation">.</span>sender_id

        dispatcher<span class="token punctuation">.</span>utter_message<span class="token punctuation">(</span>
            f<span class="token string">"The ID of this conversation is: "</span> f<span class="token string">"&amp;#123;conversation_id&amp;#125;."</span>
        <span class="token punctuation">)</span>

        dispatcher<span class="token punctuation">.</span>utter_message<span class="token punctuation">(</span>
            f<span class="token string">"Trigger an intent with "</span>
            f<span class="token string">'curl -H "Content-Type: application/json" '</span>
            f<span class="token string">'-X POST -d \'&amp;#123;&amp;#123;"name": "EXTERNAL_dry_plant", '</span>
            f'<span class="token string">"entities"</span><span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;&amp;#123;"plant": "Orchid"&amp;#125;&amp;#125;&amp;#125;&amp;#125;\' '</span>
            f<span class="token string">"http://localhost:5005/conversations/&amp;#123;conversation_id&amp;#125;/"</span>
            f<span class="token string">"trigger_intent"</span>
        <span class="token punctuation">)</span>

        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></code></pre>
<p>å¦å¤–ï¼Œæˆ‘ä»¬è¿˜å£°æ˜ä¸€ä¸ªintent <code>ask_id</code>ï¼Œä¸ºå…¶å®šä¹‰ä¸€äº›NLUæ•°æ®ï¼Œå¹¶å°†ä¸¤è€…<code>action_tell_id</code>å’Œ æ·»åŠ <code>ask_id</code>åˆ°åŸŸæ–‡ä»¶ä¸­ï¼Œåœ¨è¯¥æ–‡ä»¶ä¸­æˆ‘ä»¬æŒ‡å®šä¸€ä¸ªåº”è§¦å‘å¦ä¸€ä¸ªï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">intents:
  <span class="token list punctuation">-</span> ask_id:
<span class="token code keyword">    triggers: action_tell_id</span></code></pre>
<p>ç°åœ¨ï¼Œå½“æ‚¨è¯¢é—®â€œæ­¤å¯¹è¯çš„IDæ˜¯ä»€ä¹ˆï¼Ÿâ€æ—¶ï¼ŒåŠ©æ‰‹å°†å›ç­”â€œè¯¥å¯¹è¯çš„IDä¸ºï¼š38cc25d7e23e4dde800353751b7c2d3eâ€ã€‚</p>
<p>å¦‚æœæ‚¨å¸Œæœ›åŠ©æ‰‹è‡ªåŠ¨é“¾æ¥åˆ°Raspberry Piï¼Œåˆ™å¿…é¡»ç¼–å†™ä¸€ä¸ªè‡ªå®šä¹‰æ“ä½œï¼Œä»¥åœ¨å¯¹è¯å¼€å§‹æ—¶é€šçŸ¥Piæœ‰å…³å¯¹è¯çš„IDï¼ˆè¯·å‚é˜…<a href="#">è‡ªå®šä¹‰ä¼šè¯å¼€å§‹æ“ä½œ</a>ï¼‰ã€‚</p>
<h3 id="å“åº”å¤–éƒ¨äº‹ä»¶"><a href="#å“åº”å¤–éƒ¨äº‹ä»¶" class="headerlink" title="å“åº”å¤–éƒ¨äº‹ä»¶"></a>å“åº”å¤–éƒ¨äº‹ä»¶</h3><p>ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¼šè¯IDï¼Œæˆ‘ä»¬éœ€è¦å‡†å¤‡åŠ©æ‰‹ï¼Œä»¥ä¾¿åŠ©æ‰‹å“åº”æ¥è‡ªä¼ æ„Ÿå™¨çš„æ¶ˆæ¯ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª<code>EXTERNAL_dry_plant</code>æ²¡æœ‰ä»»ä½•NLUæ•°æ®çš„æ–°æ„å›¾ã€‚æ­¤æ„å›¾ç¨åå°†ç”±å¤–éƒ¨ä¼ æ„Ÿå™¨è§¦å‘ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä»¥æ„å›¾åç§°å¼€å¤´ï¼Œ<code>EXTERNAL_</code>ä»¥è¡¨æ˜è¿™ä¸æ˜¯ç”¨æˆ·è¦è¯´çš„ï¼Œä½†æ˜¯æ‚¨å¯ä»¥éšæ„å‘½åè¯¥æ„å›¾ã€‚</p>
<p>åœ¨åŸŸæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬ç°åœ¨å°†æ„å›¾<code>EXTERNAL_dry_plant</code>ä¸å¦ä¸€ä¸ªè‡ªå®šä¹‰æ“ä½œ<code>action_warn_dry</code>ï¼ˆä¾‹å¦‚ï¼Œ</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">ActionWarnDry</span><span class="token punctuation">(</span>Action<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Informs the user that a plant needs water."""</span>

    <span class="token keyword">def</span> <span class="token function">name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Text<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"action_warn_dry"</span>

    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>
        self<span class="token punctuation">,</span>
        dispatcher<span class="token punctuation">:</span> CollectingDispatcher<span class="token punctuation">,</span>
        tracker<span class="token punctuation">:</span> Tracker<span class="token punctuation">,</span>
        domain<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span>Text<span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> List<span class="token punctuation">[</span>Dict<span class="token punctuation">[</span>Text<span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>

        plant <span class="token operator">=</span> next<span class="token punctuation">(</span>tracker<span class="token punctuation">.</span>get_latest_entity_values<span class="token punctuation">(</span><span class="token string">"plant"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"someone"</span><span class="token punctuation">)</span>
        dispatcher<span class="token punctuation">.</span>utter_message<span class="token punctuation">(</span>f<span class="token string">"Your &amp;#123;plant&amp;#125; needs some water!"</span><span class="token punctuation">)</span>

        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></code></pre>
<p>ç°åœ¨ï¼Œå½“æ‚¨ä¸idè¿›è¡Œå¯¹è¯æ—¶<code>38cc25d7e23e4dde800353751b7c2d3e</code>ï¼Œç„¶åè¿è¡Œ</p>
<pre class=" language-shell"><code class="language-shell">curl -H "Content-Type: application/json" -X POST -d '&#123;"name": "EXTERNAL_dry_plant", "entities": &#123;"plant": "Orchid"&#125;&#125;' http://localhost:5005/conversations/38cc25d7e23e4dde800353751b7c2d3e/trigger_intent</code></pre>
<p>åœ¨ç»ˆç«¯ä¸Šï¼Œæ‚¨çš„åŠ©æ‰‹ä¼šè¯´ï¼šâ€œæ‚¨çš„å…°èŠ±éœ€è¦ä¸€äº›æ°´ï¼â€ã€‚</p>
<h2 id="Policies"><a href="#Policies" class="headerlink" title="Policies"></a>Policies</h2><ul>
<li><a href="#">é…ç½®ç­–ç•¥</a><ul>
<li><a href="%EF%BC%83">æœ€å¤§å†å²</a></li>
<li><a href="#">æ•°æ®æ‰©å……</a></li>
</ul>
</li>
<li><a href="#">åŠ¨ä½œé€‰æ‹©</a></li>
<li><a href="#">å‡¯æ‹‰æ–¯æ”¿ç­–</a></li>
<li><a href="#">è¯å‘é‡ç­–ç•¥</a></li>
<li><a href="#">TEDç­–ç•¥</a></li>
<li><a href="#">æ˜ å°„ç­–ç•¥</a></li>
<li><a href="#">è®°å¿†ç­–ç•¥</a></li>
<li><a href="#">å¢å¼ºè®°å¿†ç­–ç•¥</a></li>
<li><a href="#">å›é€€ç­–ç•¥</a></li>
<li><a href="#">ä¸¤é˜¶æ®µå›é€€ç­–ç•¥</a></li>
<li><a href="#">è¡¨æ ¼ç­–ç•¥</a></li>
</ul>
<h3 id="é…ç½®ç­–ç•¥"><a href="#é…ç½®ç­–ç•¥" class="headerlink" title="é…ç½®ç­–ç•¥"></a>é…ç½®ç­–ç•¥</h3><p>è¯¥<code>rasa.core.policies.Policy</code>ç­å†³å®šé‡‡å–åœ¨è°ˆè¯çš„æ¯ä¸€æ­¥ä½•ç§è¡ŒåŠ¨ã€‚</p>
<p>æœ‰å¤šç§ç­–ç•¥å¯ä¾›é€‰æ‹©ï¼Œæ‚¨å¯ä»¥åœ¨ä¸€ä¸ªä¸­åŒ…å«å¤šä¸ªç­–ç•¥<a target="_blank" rel="noopener" href="https://legacy-docs-v1.rasa.com/api/agent/#rasa.core.agent.Agent"><code>rasa.core.agent.Agent</code></a>ã€‚</p>
<blockquote>
<p>æ³¨æ„</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œä»£ç†åœ¨æ¯æ¡ç”¨æˆ·æ¶ˆæ¯ä¹‹åæœ€å¤šå¯ä»¥é¢„æµ‹10ä¸ªä¸‹ä¸€æ­¥æ“ä½œã€‚è¦æ›´æ–°æ­¤å€¼ï¼Œå¯ä»¥å°†ç¯å¢ƒå˜é‡<code>MAX_NUMBER_OF_PREDICTIONS</code> è®¾ç½®ä¸ºæ‰€éœ€çš„æœ€å¤§é¢„æµ‹æ•°ã€‚</p>
</blockquote>
<p>é¡¹ç›®çš„<code>config.yml</code>æ–‡ä»¶å¸¦æœ‰ä¸€ä¸ª<code>policies</code>å¯†é’¥ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¯¥å¯†é’¥æ¥è‡ªå®šä¹‰åŠ©æ‰‹ä½¿ç”¨çš„ç­–ç•¥ã€‚åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæœ€åä¸¤è¡Œæ˜¾ç¤ºäº†å¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰ç­–ç•¥ç±»å¹¶å°†å‚æ•°ä¼ é€’ç»™å®ƒã€‚</p>
<pre class=" language-markdown"><code class="language-markdown">policies:
  <span class="token list punctuation">-</span> name: "KerasPolicy"
<span class="token code keyword">    featurizer:</span>
<span class="token code keyword">    - name: MaxHistoryTrackerFeaturizer</span>
<span class="token code keyword">      max_history: 5</span>
<span class="token code keyword">      state_featurizer:</span>
<span class="token code keyword">        - name: BinarySingleStateFeaturizer</span>
  <span class="token list punctuation">-</span> name: "MemoizationPolicy"
<span class="token code keyword">    max_history: 5</span>
  <span class="token list punctuation">-</span> name: "FallbackPolicy"
<span class="token code keyword">    nlu_threshold: 0.4</span>
<span class="token code keyword">    core_threshold: 0.3</span>
<span class="token code keyword">    fallback_action_name: "my_fallback_action"</span>
  <span class="token list punctuation">-</span> name: "path.to.your.policy.class"
<span class="token code keyword">    arg1: "..."</span></code></pre>
<h4 id="æœ€å¤§å†å²"><a href="#æœ€å¤§å†å²" class="headerlink" title="æœ€å¤§å†å²"></a>æœ€å¤§å†å²</h4><p>Rasaæ ¸å¿ƒç­–ç•¥çš„ä¸€ä¸ªé‡è¦è¶…å‚æ•°æ˜¯<code>max_history</code>ã€‚è¿™å¯æ§åˆ¶æ¨¡å‹æŸ¥çœ‹å¤šå°‘å¯¹è¯å†å²è®°å½•ï¼Œä»¥å†³å®šä¸‹ä¸€æ­¥åº”é‡‡å–çš„è¡ŒåŠ¨ã€‚</p>
<p>æ‚¨å¯ä»¥<code>max_history</code>é€šè¿‡å°†å…¶ä¼ é€’åˆ°<code>Featurizer</code> ç­–ç•¥é…ç½®yamlæ–‡ä»¶ä¸­çš„ç­–ç•¥æ¥è¿›è¡Œè®¾ç½®ã€‚</p>
<blockquote>
<p>æ³¨æ„</p>
<p>ä»…ä¼š<code>MaxHistoryTrackerFeaturizer</code>ä½¿ç”¨æœ€é•¿å†å²è®°å½•ï¼Œè€Œ<code>FullDialogueTrackerFeaturizer</code>æ€»æ˜¯ä¼šæŸ¥çœ‹å®Œæ•´çš„å¯¹è¯å†å²è®°å½•ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§<a href="#">ä¼šè¯</a>åŠŸèƒ½åŒ–ã€‚</p>
</blockquote>
<p>ä¸¾ä¾‹æ¥è¯´ï¼Œå‡è®¾æ‚¨æœ‰ä¸€ä¸ª<code>out_of_scope</code>æè¿°ç¦»é¢˜ç”¨æˆ·æ¶ˆæ¯çš„æ„å›¾ã€‚å¦‚æœæ‚¨çš„æœºå™¨äººè¿ç»­å¤šæ¬¡çœ‹åˆ°æ­¤æ„å›¾ï¼Œåˆ™å¯èƒ½è¦å‘Šè¯‰ç”¨æˆ·æ‚¨å¯ä»¥æä¾›å“ªäº›å¸®åŠ©ã€‚å› æ­¤æ‚¨çš„æ•…äº‹å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token list punctuation">*</span> out<span class="token italic"><span class="token punctuation">_</span>of<span class="token punctuation">_</span></span>scope
   <span class="token list punctuation">-</span> utter_default
<span class="token list punctuation">*</span> out<span class="token italic"><span class="token punctuation">_</span>of<span class="token punctuation">_</span></span>scope
   <span class="token list punctuation">-</span> utter_default
<span class="token list punctuation">*</span> out<span class="token italic"><span class="token punctuation">_</span>of<span class="token punctuation">_</span></span>scope
   <span class="token list punctuation">-</span> utter<span class="token italic"><span class="token punctuation">_</span>help<span class="token punctuation">_</span></span>message</code></pre>
<p>ä¸ºäº†ä½¿Rasa Coreå­¦ä¹ è¿™ç§æ¨¡å¼ï¼Œ<code>max_history</code> å¿…é¡»è‡³å°‘ä¸º4ã€‚</p>
<p>å¦‚æœå¢åŠ <code>max_history</code>ï¼Œæ‚¨çš„æ¨¡å‹å°†å˜å¾—æ›´å¤§ï¼Œå¹¶ä¸”è®­ç»ƒå°†èŠ±è´¹æ›´é•¿çš„æ—¶é—´ã€‚å¦‚æœæ‚¨æŒæ¡ä¸€äº›å°†æ¥å¯èƒ½ä¼šå½±å“å¯¹è¯çš„ä¿¡æ¯ï¼Œåˆ™åº”å°†å…¶å­˜å‚¨ä¸ºæ’æ§½ã€‚æ’æ§½ä¿¡æ¯å§‹ç»ˆå¯ç”¨äºæ¯ä¸ªåŠŸèƒ½å—ã€‚</p>
<h4 id="æ•°æ®æ‰©å……"><a href="#æ•°æ®æ‰©å……" class="headerlink" title="æ•°æ®æ‰©å……"></a>æ•°æ®æ‰©å……</h4><p>è®­ç»ƒæ¨¡å‹æ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒRasa Coreå°†é€šè¿‡éšæœºå°†æ•…äº‹æ–‡ä»¶ä¸­çš„æ•…äº‹ç²˜åˆåœ¨ä¸€èµ·æ¥åˆ›å»ºæ›´é•¿çš„æ•…äº‹ã€‚è¿™æ˜¯å› ä¸ºå¦‚æœæ‚¨æœ‰ä»¥ä¸‹æ•…äº‹ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> thanks</span>
<span class="token list punctuation">*</span> thankyou
   <span class="token list punctuation">-</span> utter_youarewelcome

<span class="token title important"><span class="token punctuation">#</span> bye</span>
<span class="token list punctuation">*</span> goodbye
   <span class="token list punctuation">-</span> utter_goodbye</code></pre>
<p>å®é™…ä¸Šï¼Œæ‚¨å®é™…ä¸Šæƒ³æ•™è‡ªå·±çš„ç­–ç•¥åœ¨ä¸ç›¸å…³æ—¶<strong>å¿½ç•¥</strong>å¯¹è¯å†å²è®°å½•ï¼Œè€Œæ— è®ºä»¥å‰å‘ç”Ÿäº†ä»€ä¹ˆï¼Œéƒ½åªéœ€ä»¥ç›¸åŒçš„åŠ¨ä½œè¿›è¡Œå“åº”å³å¯ã€‚</p>
<p>æ‚¨å¯ä»¥ä½¿ç”¨<code>--augmentation</code>æ ‡å¿—æ›´æ”¹æ­¤è¡Œä¸ºã€‚å…è®¸æ‚¨è®¾ç½®<code>augmentation_factor</code>ã€‚è¯¥<code>augmentation_factor</code>å†³å®šè®¸å¤šå¢å¼ºçš„æ•…äº‹æ˜¯å¦‚ä½•è®­ç»ƒä¸­çš„å­é‡‡æ ·ã€‚æ‰©å¢åçš„æ•…äº‹åœ¨è®­ç»ƒä¹‹å‰ä¼šè¿›è¡ŒäºŒæ¬¡æŠ½æ ·ï¼Œå› ä¸ºå®ƒä»¬çš„æ•°é‡ä¼šå¾ˆå¿«å˜å¾—éå¸¸å¤§ï¼Œæˆ‘ä»¬å¸Œæœ›å¯¹å…¶è¿›è¡Œé™åˆ¶ã€‚æ ·æœ¬æ•…äº‹çš„æ•°é‡æ˜¯<code>augmentation_factor</code>x10ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰©å……è®¾ç½®ä¸º20ï¼Œæœ€å¤šå¯ç”Ÿæˆ200ä¸ªæ‰©å……æ•…äº‹ã€‚</p>
<p><code>--augmentation 0</code>ç¦ç”¨æ‰€æœ‰å¢å¼ºè¡Œä¸ºã€‚åŸºäºå¤‡å¿˜å½•çš„ç­–ç•¥ä¸å—æ‰©å……çš„å½±å“ï¼ˆä¸æ— å…³<code>augmentation_factor</code>ï¼‰ï¼Œå¹¶ä¸”ä¼šè‡ªåŠ¨å¿½ç•¥æ‰€æœ‰æ‰©å……çš„æ•…äº‹ã€‚</p>
<h3 id="è¡ŒåŠ¨é€‰æ‹©"><a href="#è¡ŒåŠ¨é€‰æ‹©" class="headerlink" title="è¡ŒåŠ¨é€‰æ‹©"></a>è¡ŒåŠ¨é€‰æ‹©</h3><p>åœ¨ä»»ä½•æ—¶å€™ï¼Œé…ç½®ä¸­å®šä¹‰çš„æ¯ä¸ªç­–ç•¥éƒ½ä¼šä»¥ä¸€å®šçš„ç½®ä¿¡åº¦é¢„æµ‹ä¸‹ä¸€ä¸ªåŠ¨ä½œã€‚æœ‰å…³æ¯ä¸ªç­–ç•¥å¦‚ä½•åšå‡ºå†³ç­–çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·é˜…è¯»ä¸‹é¢çš„ç­–ç•¥è¯´æ˜ã€‚ç„¶åï¼Œæœºå™¨äººçš„ä¸‹ä¸€ä¸ªåŠ¨ä½œç”±å…·æœ‰æœ€é«˜ç½®ä¿¡åº¦çš„é¢„æµ‹ç­–ç•¥å†³å®šã€‚</p>
<p>åœ¨ä¸¤ä¸ªç­–ç•¥ä»¥ç›¸åŒçš„ç½®ä¿¡åº¦è¿›è¡Œé¢„æµ‹çš„æƒ…å†µä¸‹ï¼ˆä¾‹å¦‚ï¼Œâ€œå¤‡å¿˜å’Œæ˜ å°„ç­–ç•¥â€å§‹ç»ˆä»¥0æˆ–1çš„ç½®ä¿¡åº¦è¿›è¡Œé¢„æµ‹ï¼‰ï¼Œå°†è€ƒè™‘ç­–ç•¥çš„ä¼˜å…ˆçº§ã€‚Rasaç­–ç•¥å…·æœ‰é»˜è®¤ä¼˜å…ˆçº§ï¼Œè¿™äº›é»˜è®¤ä¼˜å…ˆçº§è¢«è®¾ç½®ä¸ºç¡®ä¿å¹³å±€æ—¶çš„é¢„æœŸç»“æœã€‚å®ƒä»¬çœ‹èµ·æ¥åƒè¿™æ ·ï¼Œæ•°å­—è¶Šé«˜ä¼˜å…ˆçº§è¶Šé«˜ï¼š</p>
<p>5ï¼Œ <code>FormPolicy</code></p>
<p>4.<code>FallbackPolicy</code>å’Œ<code>TwoStageFallbackPolicy</code></p>
<p>3.<code>MemoizationPolicy</code>å’Œ<code>AugmentedMemoizationPolicy</code></p>
<p>2ã€‚ <code>MappingPolicy</code></p>
<p>1.<code>TEDPolicy</code>ï¼Œ<code>EmbeddingPolicy</code>ï¼Œ<code>KerasPolicy</code>ï¼Œå’Œ<code>SklearnPolicy</code></p>
<p>æ­¤ä¼˜å…ˆçº§å±‚æ¬¡ç»“æ„å¯ç¡®ä¿ï¼Œä¾‹å¦‚ï¼Œå¦‚æœæœ‰æ„å›¾ä¸æ˜ å°„çš„åŠ¨ä½œï¼Œä½†NLUç½®ä¿¡åº¦ä¸åœ¨ä¹‹ä¸Š<code>nlu_threshold</code>ï¼Œåˆ™è¯¥æ¼«æ¸¸å™¨ä»å°†å›é€€ã€‚é€šå¸¸ï¼Œä¸å»ºè®®æ¯ä¸ªä¼˜å…ˆçº§ä½¿ç”¨ä¸€ä¸ªä»¥ä¸Šçš„ç­–ç•¥ï¼Œå¹¶ä¸”æŸäº›ä¼˜å…ˆçº§ç›¸åŒçš„ç­–ç•¥ï¼ˆä¾‹å¦‚ä¸¤ä¸ªåå¤‡ç­–ç•¥ï¼‰ä¸¥æ ¼ä¸èƒ½ä¸€å¹¶ä½¿ç”¨ã€‚</p>
<p>å¦‚æœæ‚¨åˆ›å»ºè‡ªå·±çš„ç­–ç•¥ï¼Œè¯·ä½¿ç”¨è¿™äº›ä¼˜å…ˆçº§ä½œä¸ºç¡®å®šç­–ç•¥ä¼˜å…ˆçº§çš„æŒ‡å—ã€‚å¦‚æœæ‚¨çš„ç­–ç•¥æ˜¯æœºå™¨å­¦ä¹ ç­–ç•¥ï¼Œåˆ™å®ƒå¾ˆå¯èƒ½åº”è¯¥å…·æœ‰ä¼˜å…ˆçº§1ï¼Œä¸Rasaæœºå™¨å­¦ä¹ ç­–ç•¥ç›¸åŒã€‚</p>
<blockquote>
<p>è­¦å‘Š</p>
<p>æ‰€æœ‰ç­–ç•¥ä¼˜å…ˆçº§éƒ½å¯ä»¥é€šè¿‡é…ç½®ä¸­çš„<code>priority:</code>å‚æ•°è¿›è¡Œé…ç½®ï¼Œä½†æ˜¯æˆ‘ä»¬<strong>ä¸å»ºè®®</strong>åœ¨ç‰¹å®šæƒ…å†µï¼ˆä¾‹å¦‚è‡ªå®šä¹‰ç­–ç•¥ï¼‰ä¹‹å¤–æ›´æ”¹å®ƒä»¬ã€‚è¿™æ ·åšå¯èƒ½ä¼šå¯¼è‡´æ„æƒ³ä¸åˆ°çš„æœºå™¨äººè¡Œä¸ºã€‚</p>
</blockquote>
<h3 id="Kerasæ”¿ç­–"><a href="#Kerasæ”¿ç­–" class="headerlink" title="Kerasæ”¿ç­–"></a>Kerasæ”¿ç­–</h3><p>åœ¨<code>KerasPolicy</code>ä½¿ç”¨ä¸­å®ç°çš„ç¥ç»ç½‘ç»œ <a target="_blank" rel="noopener" href="http://keras.io/">Keras</a>é€‰æ‹©ä¸‹ä¸€ä¸ªåŠ¨ä½œã€‚é»˜è®¤ä½“ç³»ç»“æ„åŸºäºLSTMï¼Œä½†æ˜¯æ‚¨å¯ä»¥è¦†ç›–è¯¥ <code>KerasPolicy.model_architecture</code>æ–¹æ³•ä»¥å®ç°è‡ªå·±çš„ä½“ç³»ç»“æ„ã€‚</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">model_architecture</span><span class="token punctuation">(</span>
    self<span class="token punctuation">,</span> input_shape<span class="token punctuation">:</span> Tuple<span class="token punctuation">[</span>int<span class="token punctuation">,</span> int<span class="token punctuation">]</span><span class="token punctuation">,</span> output_shape<span class="token punctuation">:</span> Tuple<span class="token punctuation">[</span>int<span class="token punctuation">,</span> Optional<span class="token punctuation">[</span>int<span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models<span class="token punctuation">.</span>Sequential<span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Build a keras model and return a compiled model."""</span>

    <span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> Sequential
    <span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> <span class="token punctuation">(</span>
        Masking<span class="token punctuation">,</span>
        LSTM<span class="token punctuation">,</span>
        Dense<span class="token punctuation">,</span>
        TimeDistributed<span class="token punctuation">,</span>
        Activation<span class="token punctuation">,</span>
    <span class="token punctuation">)</span>

    <span class="token comment" spellcheck="true"># Build Model</span>
    model <span class="token operator">=</span> Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment" spellcheck="true"># the shape of the y vector of the labels,</span>
    <span class="token comment" spellcheck="true"># determines which output from rnn will be used</span>
    <span class="token comment" spellcheck="true"># to calculate the loss</span>
    <span class="token keyword">if</span> len<span class="token punctuation">(</span>output_shape<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token comment" spellcheck="true"># y is (num examples, num features) so</span>
        <span class="token comment" spellcheck="true"># only the last output from the rnn is used to</span>
        <span class="token comment" spellcheck="true"># calculate the loss</span>
        model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Masking<span class="token punctuation">(</span>mask_value<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> input_shape<span class="token operator">=</span>input_shape<span class="token punctuation">)</span><span class="token punctuation">)</span>
        model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>LSTM<span class="token punctuation">(</span>self<span class="token punctuation">.</span>rnn_size<span class="token punctuation">,</span> dropout<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span>input_dim<span class="token operator">=</span>self<span class="token punctuation">.</span>rnn_size<span class="token punctuation">,</span> units<span class="token operator">=</span>output_shape<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> len<span class="token punctuation">(</span>output_shape<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
        <span class="token comment" spellcheck="true"># y is (num examples, max_dialogue_len, num features) so</span>
        <span class="token comment" spellcheck="true"># all the outputs from the rnn are used to</span>
        <span class="token comment" spellcheck="true"># calculate the loss, therefore a sequence is returned and</span>
        <span class="token comment" spellcheck="true"># time distributed layer is used</span>

        <span class="token comment" spellcheck="true"># the first value in input_shape is max dialogue_len,</span>
        <span class="token comment" spellcheck="true"># it is set to None, to allow dynamic_rnn creation</span>
        <span class="token comment" spellcheck="true"># during prediction</span>
        model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Masking<span class="token punctuation">(</span>mask_value<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> input_shape<span class="token operator">=</span><span class="token punctuation">(</span>None<span class="token punctuation">,</span> input_shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>LSTM<span class="token punctuation">(</span>self<span class="token punctuation">.</span>rnn_size<span class="token punctuation">,</span> return_sequences<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> dropout<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>TimeDistributed<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span>units<span class="token operator">=</span>output_shape<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span>
            <span class="token string">"Cannot construct the model because"</span>
            <span class="token string">"length of output_shape = &amp;#123;&amp;#125; "</span>
            <span class="token string">"should be 1 or 2."</span>
            <span class="token string">""</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>len<span class="token punctuation">(</span>output_shape<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>

    model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Activation<span class="token punctuation">(</span><span class="token string">"softmax"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    model<span class="token punctuation">.</span>compile<span class="token punctuation">(</span>
        loss<span class="token operator">=</span><span class="token string">"categorical_crossentropy"</span><span class="token punctuation">,</span> optimizer<span class="token operator">=</span><span class="token string">"rmsprop"</span><span class="token punctuation">,</span> metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"accuracy"</span><span class="token punctuation">]</span>
    <span class="token punctuation">)</span>

    <span class="token keyword">if</span> common_utils<span class="token punctuation">.</span>obtain_verbosity<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>
        model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> model</code></pre>
<p>è®­ç»ƒåœ¨è¿™é‡Œè¿›è¡Œï¼š</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">train</span><span class="token punctuation">(</span>
    self<span class="token punctuation">,</span>
    training_trackers<span class="token punctuation">:</span> List<span class="token punctuation">[</span>DialogueStateTracker<span class="token punctuation">]</span><span class="token punctuation">,</span>
    domain<span class="token punctuation">:</span> Domain<span class="token punctuation">,</span>
    <span class="token operator">**</span>kwargs<span class="token punctuation">:</span> Any<span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> None<span class="token punctuation">:</span>

    np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span>self<span class="token punctuation">.</span>random_seed<span class="token punctuation">)</span>
    tf<span class="token punctuation">.</span>random<span class="token punctuation">.</span>set_seed<span class="token punctuation">(</span>self<span class="token punctuation">.</span>random_seed<span class="token punctuation">)</span>

    training_data <span class="token operator">=</span> self<span class="token punctuation">.</span>featurize_for_training<span class="token punctuation">(</span>training_trackers<span class="token punctuation">,</span> domain<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># noinspection PyPep8Naming</span>
    shuffled_X<span class="token punctuation">,</span> shuffled_y <span class="token operator">=</span> training_data<span class="token punctuation">.</span>shuffled_X_y<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> self<span class="token punctuation">.</span>model <span class="token keyword">is</span> None<span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>model <span class="token operator">=</span> self<span class="token punctuation">.</span>model_architecture<span class="token punctuation">(</span>
            shuffled_X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> shuffled_y<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
        <span class="token punctuation">)</span>

    logger<span class="token punctuation">.</span>debug<span class="token punctuation">(</span>
        f<span class="token string">"Fitting model with &amp;#123;training_data.num_examples()&amp;#125; total samples and a "</span>
        f<span class="token string">"validation split of &amp;#123;self.validation_split&amp;#125;."</span>
    <span class="token punctuation">)</span>

    <span class="token comment" spellcheck="true"># filter out kwargs that cannot be passed to fit</span>
    self<span class="token punctuation">.</span>_train_params <span class="token operator">=</span> self<span class="token punctuation">.</span>_get_valid_params<span class="token punctuation">(</span>
        self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>fit<span class="token punctuation">,</span> <span class="token operator">**</span>self<span class="token punctuation">.</span>_train_params
    <span class="token punctuation">)</span>

    self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>
        shuffled_X<span class="token punctuation">,</span>
        shuffled_y<span class="token punctuation">,</span>
        epochs<span class="token operator">=</span>self<span class="token punctuation">.</span>epochs<span class="token punctuation">,</span>
        batch_size<span class="token operator">=</span>self<span class="token punctuation">.</span>batch_size<span class="token punctuation">,</span>
        shuffle<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
        verbose<span class="token operator">=</span>common_utils<span class="token punctuation">.</span>obtain_verbosity<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token operator">**</span>self<span class="token punctuation">.</span>_train_params<span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>current_epoch <span class="token operator">=</span> self<span class="token punctuation">.</span>epochs

    logger<span class="token punctuation">.</span>debug<span class="token punctuation">(</span><span class="token string">"Done fitting Keras Policy model."</span><span class="token punctuation">)</span></code></pre>
<p>æ‚¨å¯ä»¥é€šè¿‡è¦†ç›–è¿™äº›æ–¹æ³•æ¥å®ç°æ‚¨é€‰æ‹©çš„æ¨¡å‹ï¼Œæˆ–è€…<code>KerasPolicy</code>ä½¿ç”¨pre-definedè¿›è¡Œåˆå§‹åŒ–ã€‚<code>keras model</code></p>
<p>ä¸ºäº†è·å¾—ç›¸åŒè¾“å…¥çš„å¯é‡å¤è®­ç»ƒç»“æœï¼Œæ‚¨å¯ä»¥å°†çš„<code>random_seed</code>å±æ€§è®¾ç½®<code>KerasPolicy</code>ä¸ºä»»ä½•æ•´æ•°ã€‚</p>
<h3 id="åµŒå…¥ç­–ç•¥"><a href="#åµŒå…¥ç­–ç•¥" class="headerlink" title="åµŒå…¥ç­–ç•¥"></a>åµŒå…¥ç­–ç•¥</h3><blockquote>
<p>è­¦å‘Š</p>
<p><code>EmbeddingPolicy</code>å·²é‡å‘½åä¸º<code>TEDPolicy</code>ã€‚è¯·ä½¿ç”¨<a href="#">TEDç­–ç•¥ï¼Œ</a>è€Œä¸è¦<code>EmbeddingPolicy</code> åœ¨ç­–ç•¥é…ç½®ä¸­ä½¿ç”¨ã€‚è¯¥ç­–ç•¥çš„åŠŸèƒ½ä¿æŒä¸å˜ã€‚</p>
</blockquote>
<h3 id="TEDç­–ç•¥"><a href="#TEDç­–ç•¥" class="headerlink" title="TEDç­–ç•¥"></a>TEDç­–ç•¥</h3><p>è¯¥å˜å‹å™¨åµŒå…¥å¯¹è¯ï¼ˆTEDï¼‰çš„æ”¿ç­–æ˜¯åœ¨æè¿° <a target="_blank" rel="noopener" href="https://arxiv.org/abs/1910.00486">æˆ‘ä»¬çš„è®ºæ–‡</a>ã€‚</p>
<p>è¯¥ç­–ç•¥å…·æœ‰é¢„å®šä¹‰çš„ä½“ç³»ç»“æ„ï¼ŒåŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š</p>
<blockquote>
<ul>
<li>å°†æ¯ä¸ªæ—¶é—´æ­¥éª¤çš„ç”¨æˆ·è¾“å…¥ï¼ˆç”¨æˆ·æ„å›¾å’Œå®ä½“ï¼‰ï¼Œå…ˆå‰çš„ç³»ç»ŸåŠ¨ä½œï¼Œæ—¶éš™å’Œæ´»åŠ¨å½¢å¼è¿æ¥åˆ°è¾“å…¥å‘é‡ä¸­ï¼Œä»¥ä¼ é€’ç»™é¢„å˜å‹å™¨åµŒå…¥å±‚ï¼›</li>
<li>é¦ˆå…¥å˜å‹å™¨ï¼›</li>
<li>åœ¨å˜å‹å™¨çš„è¾“å‡ºä¸Šæ–½åŠ ä¸€ä¸ªå¯†é›†å±‚ï¼Œä»¥ä¾¿åœ¨æ¯ä¸ªæ—¶é—´æ­¥é•¿ä¸­åµŒå…¥å¯¹è¯ï¼›</li>
<li>åœ¨æ¯ä¸ªæ—¶é—´æ­¥éª¤åº”ç”¨å¯†é›†å±‚ä¸ºç³»ç»Ÿæ“ä½œåˆ›å»ºåµŒå…¥ï¼›</li>
<li>è®¡ç®—å¯¹è¯åµŒå…¥å’ŒåµŒå…¥å¼ç³»ç»ŸåŠ¨ä½œä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚æ­¤æ­¥éª¤åŸºäº<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1709.03856">StarSpaceçš„</a>æƒ³æ³•ã€‚</li>
</ul>
</blockquote>
<p>å»ºè®®ä½¿ç”¨<code>state_featurizer=LabelTokenizerSingleStateFeaturizer(...)</code> ï¼ˆæœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§<a href="#">å¯¹è¯</a>åŠŸèƒ½ï¼‰ã€‚</p>
<p><strong>ç»„æ€ï¼š</strong></p>
<p>å¯ä»¥å°†é…ç½®å‚æ•°ä½œä¸ºå‚æ•°ä¼ é€’åˆ°<code>TEDPolicy</code>é…ç½®æ–‡ä»¶ä¸­ã€‚å¦‚æœè¦è°ƒæ•´æ¨¡å‹ï¼Œè¯·é¦–å…ˆä¿®æ”¹ä»¥ä¸‹å‚æ•°ï¼š</p>
<ul>
<li><code>epochs</code>ï¼šæ­¤å‚æ•°è®¾ç½®ç®—æ³•æŸ¥çœ‹è®­ç»ƒæ•°æ®çš„æ¬¡æ•°ï¼ˆé»˜è®¤å€¼ï¼šï¼‰<code>1</code>ã€‚ä¸€ä¸ª<code>epoch</code>æ˜¯ç­‰äºä¸€ä¸ªç›´ä¼ å’Œæ‰€æœ‰çš„è®­ç»ƒä¾‹å­ä¹‹ä¸€å‘é€šè¡Œã€‚æœ‰æ—¶ï¼Œæ¨¡å‹éœ€è¦æ›´å¤šçš„æ—¶æœŸæ‰èƒ½æ­£ç¡®å­¦ä¹ ã€‚æœ‰æ—¶æ›´å¤šçš„æ—¶æœŸä¸ä¼šå½±å“æ€§èƒ½ã€‚æ—¶æœŸæ•°è¶Šå°‘ï¼Œæ¨¡å‹è®­ç»ƒè¶Šå¿«ã€‚</li>
<li><code>hidden_layers_sizes</code>ï¼šæ­¤å‚æ•°å…è®¸æ‚¨å®šä¹‰å¯¹è¯å’Œæ„å›¾çš„å‰é¦ˆå±‚æ•°åŠå…¶è¾“å‡ºå°ºå¯¸ï¼ˆé»˜è®¤å€¼ï¼šï¼‰ã€‚åˆ—è¡¨ä¸­çš„æ¯ä¸ªæ¡ç›®éƒ½å¯¹åº”ä¸€ä¸ªå‰é¦ˆå±‚ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè®¾ç½®ï¼Œæˆ‘ä»¬å°†åœ¨å˜å‹å™¨å‰é¢æ·»åŠ ä¸¤ä¸ªå‰é¦ˆå±‚ã€‚è¾“å…¥ä»¤ç‰Œçš„çŸ¢é‡ï¼ˆæ¥è‡ªå¯¹è¯ï¼‰å°†ä¼ é€’åˆ°è¿™äº›å±‚ã€‚ç¬¬ä¸€å±‚çš„è¾“å‡ºå°ºå¯¸ä¸º256ï¼Œç¬¬äºŒå±‚çš„è¾“å‡ºå°ºå¯¸ä¸º128ã€‚å¦‚æœä½¿ç”¨ç©ºåˆ—è¡¨ï¼ˆé»˜è®¤è¡Œä¸ºï¼‰ï¼Œåˆ™ä¸ä¼šæ·»åŠ å‰é¦ˆå±‚ã€‚ç¡®ä¿ä»…ä½¿ç”¨æ­£æ•´æ•°ã€‚é€šå¸¸ï¼Œä½¿ç”¨2çš„å¹‚æ•°ã€‚åŒæ ·ï¼Œé€šå¸¸çš„åšæ³•æ˜¯åœ¨åˆ—è¡¨ä¸­å‡å°å€¼ï¼šä¸‹ä¸€ä¸ªå€¼å°äºæˆ–ç­‰äºå‰ä¸€ä¸ªå€¼ã€‚<code>dialogue: [], label: []  dialogue: [256, 128]</code></li>
<li><code>number_of_transformer_layers</code>ï¼šæ­¤å‚æ•°è®¾ç½®è¦ä½¿ç”¨çš„å˜å‹å™¨å±‚æ•°ï¼ˆé»˜è®¤å€¼ï¼šï¼‰<code>1</code>ã€‚å˜å‹å™¨å±‚çš„æ•°é‡ä¸è¦ç”¨äºæ¨¡å‹çš„å˜å‹å™¨å—ç›¸å¯¹åº”ã€‚</li>
<li><code>transformer_size</code>ï¼šæ­¤å‚æ•°è®¾ç½®å˜å‹å™¨ä¸­çš„å•ä½æ•°ï¼ˆé»˜è®¤å€¼ï¼šï¼‰<code>128</code>ã€‚ä»å˜å‹å™¨å‡ºæ¥çš„çŸ¢é‡å°†å…·æœ‰ç»™å®šçš„<code>transformer_size</code>ã€‚</li>
<li><code>weight_sparsity</code>ï¼šæ­¤å‚æ•°å®šä¹‰äº†æ¨¡å‹ä¸­æ‰€æœ‰å‰é¦ˆå±‚çš„å†…æ ¸æƒé‡çš„åˆ†æ•°ï¼Œå°†å…¶è®¾ç½®ä¸º0ï¼ˆé»˜è®¤å€¼ï¼šï¼‰<code>0.8</code>ã€‚è¯¥å€¼åº”ä»‹äº0å’Œ1ä¹‹é—´ã€‚å¦‚æœè®¾ç½®<code>weight_sparsity</code> ä¸º0ï¼Œåˆ™æ²¡æœ‰å†…æ ¸æƒé‡å°†è®¾ç½®ä¸º0ï¼Œè¯¥å±‚å°†å……å½“æ ‡å‡†å‰é¦ˆå±‚ã€‚æ‚¨ä¸åº”å°†å…¶è®¾ç½®<code>weight_sparsity</code>ä¸º1ï¼Œå› ä¸ºè¿™å°†å¯¼è‡´æ‰€æœ‰å†…æ ¸æƒé‡å‡ä¸º0ï¼Œå³æ¨¡å‹æ— æ³•å­¦ä¹ ã€‚</li>
</ul>
<blockquote>
<p>è­¦å‘Š</p>
<p>å°†é€‚å½“çš„æ•°å­—ï¼ˆä¾‹å¦‚50ï¼‰<code>epochs</code>ä¼ é€’ç»™<code>TEDPolicy</code>ï¼Œå¦åˆ™è¯¥ç­–ç•¥å°†ä»…é’ˆå¯¹<code>1</code>æ—¶ä»£è¿›è¡Œè®­ç»ƒã€‚</p>
</blockquote>
<blockquote>
<p>è­¦å‘Š</p>
<p><code>max_history</code>æ­¤æ”¿ç­–çš„é»˜è®¤è®¾ç½®ä¸º<code>None</code>ï¼Œå®ƒå°†ä½¿ç”¨ <code>FullDialogueTrackerFeaturizer</code>ã€‚æˆ‘ä»¬å»ºè®®å°†<code>max_history</code>å€¼è®¾ç½®ä¸ºä¸€å®šçš„å€¼ï¼Œä»¥ä¾¿<code>MaxHistoryTrackerFeaturizer</code>ç”¨äº<strong>æ›´å¿«çš„è®­ç»ƒ</strong>ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§<a href="#">ä¼šè¯</a>åŠŸèƒ½åŒ–ã€‚æˆ‘ä»¬å»ºè®®å¢åŠ <code>batch_size</code>çš„<code>MaxHistoryTrackerFeaturizer</code> ï¼ˆä¾‹å¦‚ï¼‰`â€batch_sizeâ€: [32, 64]</p>
</blockquote>
<p>ä¸Šé¢çš„é…ç½®å‚æ•°æ˜¯æ‚¨åº”è¯¥é…ç½®çš„å‚æ•°ï¼Œä»¥ä½¿æ¨¡å‹é€‚åˆæ•°æ®ã€‚ä½†æ˜¯ï¼Œå­˜åœ¨å¯ä»¥è°ƒæ•´çš„å…¶ä»–å‚æ•°ã€‚</p>
<h3 id="æ˜ å°„ç­–ç•¥"><a href="#æ˜ å°„ç­–ç•¥" class="headerlink" title="æ˜ å°„ç­–ç•¥"></a>æ˜ å°„ç­–ç•¥</h3><p>è¯¥<code>MappingPolicy</code>å¯ç”¨äºç›´æ¥æ˜ å°„åˆ°æ„å›¾åŠ¨ä½œã€‚é€šè¿‡ç»™æ„å›¾èµ‹äºˆå±æ€§æ¥åˆ†é…æ˜ å°„<code>triggers</code>ï¼Œä¾‹å¦‚ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">intents:
 <span class="token list punctuation">-</span> ask<span class="token italic"><span class="token punctuation">_</span>is<span class="token punctuation">_</span></span>bot:
<span class="token code keyword">     triggers: action_is_bot</span></code></pre>
<p>ä¸€ä¸ªæ„å›¾æœ€å¤šåªèƒ½æ˜ å°„åˆ°ä¸€ä¸ªåŠ¨ä½œã€‚ä¸€æ—¦æœºå™¨äººæ”¶åˆ°è§¦å‘æ„å›¾çš„æ¶ˆæ¯ï¼Œå®ƒå°†è¿è¡Œæ˜ å°„çš„åŠ¨ä½œã€‚ä¹‹åï¼Œå®ƒå°†ç›‘å¬ä¸‹ä¸€æ¡æ¶ˆæ¯ã€‚éšç€ä¸‹ä¸€æ¡ç”¨æˆ·æ¶ˆæ¯ï¼Œå°†æ¢å¤æ­£å¸¸é¢„æµ‹ã€‚</p>
<p>å¦‚æœæ‚¨ä¸å¸Œæœ›æ„å›¾åŠ¨ä½œæ˜ å°„å½±å“å¯¹è¯å†å²è®°å½•ï¼Œåˆ™æ˜ å°„åŠ¨ä½œå¿…é¡»è¿”å›ä¸€ä¸ª<code>UserUtteranceReverted()</code> äº‹ä»¶ã€‚è¿™å°†ä»å¯¹è¯å†å²è®°å½•ä¸­åˆ é™¤ç”¨æˆ·çš„æœ€æ–°æ¶ˆæ¯åŠå…¶åå‘ç”Ÿçš„ä»»ä½•äº‹ä»¶ã€‚è¿™æ„å‘³ç€æ‚¨ä¸åº”åœ¨æ•…äº‹ä¸­åŒ…æ‹¬æ„å›¾-è¡ŒåŠ¨äº’åŠ¨ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœç”¨æˆ·é—®â€œæ‚¨æ˜¯æœºå™¨äººå—ï¼Ÿâ€ åœ¨æµç¨‹ä¸­é—´åç¦»ä¸»é¢˜çš„æƒ…å†µä¸‹ï¼Œæ‚¨å¯èƒ½æƒ³è¦å›ç­”è€Œä¸ä¼šå½±å“ä¸‹ä¸€åŠ¨ä½œé¢„æµ‹çš„äº¤äº’ä½œç”¨ã€‚è§¦å‘çš„è‡ªå®šä¹‰æ“ä½œå¯ä»¥æ‰§è¡Œä»»ä½•æ“ä½œï¼Œä½†è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œè¯¥ç¤ºä¾‹è°ƒåº¦æœºå™¨äººçš„è¯è¯­ï¼Œç„¶åè¿˜åŸäº¤äº’ï¼š</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">ActionIsBot</span><span class="token punctuation">(</span>Action<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token triple-quoted-string string">"""Revertible mapped action for utter_is_bot"""</span>

<span class="token keyword">def</span> <span class="token function">name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">"action_is_bot"</span>

<span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> dispatcher<span class="token punctuation">,</span> tracker<span class="token punctuation">,</span> domain<span class="token punctuation">)</span><span class="token punctuation">:</span>
    dispatcher<span class="token punctuation">.</span>utter_template<span class="token punctuation">(</span>template<span class="token operator">=</span><span class="token string">"utter_is_bot"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>UserUtteranceReverted<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span></code></pre>
<blockquote>
<p>æ³¨æ„</p>
<p>å¦‚æœæ‚¨<code>MappingPolicy</code>ç›´æ¥ä½¿ç”¨ï¼ˆä¾‹å¦‚ï¼‰æ¥é¢„æµ‹æœºå™¨äººè¯´è¯çš„è¡Œä¸º ï¼Œåˆ™è¿™äº›äº¤äº’å¿…é¡»è¿›å…¥æ‚¨çš„æ•…äº‹ï¼Œå› ä¸ºåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ²¡æœ‰äº¤äº’ä½œç”¨ï¼Œå¹¶ä¸”æ„å›¾å’Œæ˜ å°„çš„å“åº”åŠ¨ä½œå°†å‡ºç°åœ¨å¯¹è¯å†å²è®°å½•ä¸­ã€‚<code>triggers: utter_{} UserUtteranceReverted()</code></p>
</blockquote>
<blockquote>
<p>æ³¨æ„</p>
<p>è¯¥MappingPolicyè¿˜è´Ÿè´£æ‰§è¡Œé»˜è®¤æ“ä½œ<code>action_back</code> å’Œ<code>action_restart</code>å“åº”<code>/back</code>å’Œ<code>/restart</code>ã€‚å¦‚æœæ‚¨çš„ç­–ç•¥ç¤ºä¾‹ä¸­æœªåŒ…å«æ­¤å†…å®¹ï¼Œåˆ™è¿™äº›æ„å›¾å°†æ— æ•ˆã€‚</p>
</blockquote>
<h3 id="è®°å¿†æ”¿ç­–"><a href="#è®°å¿†æ”¿ç­–" class="headerlink" title="è®°å¿†æ”¿ç­–"></a>è®°å¿†æ”¿ç­–</h3><p>åœ¨<code>MemoizationPolicy</code>åˆšåˆšè®°ä½åœ¨ä½ çš„è®­ç»ƒæ•°æ®çš„è°ˆè¯ã€‚å®ƒé¢„æµ‹æœ‰ä¿¡å¿ƒä¸‹ä¸€ä¸ªåŠ¨ä½œ<code>1.0</code> ï¼Œå¦‚æœåœ¨è®­ç»ƒæ•°æ®ä¸­å­˜åœ¨è¿™ä¸€ç¡®åˆ‡çš„è°ˆè¯ï¼Œå¦åˆ™é¢„æµ‹<code>None</code>å……æ»¡ä¿¡å¿ƒ<code>0.0</code>ã€‚</p>
<h3 id="å¢å¼ºè®°å¿†ç­–ç•¥"><a href="#å¢å¼ºè®°å¿†ç­–ç•¥" class="headerlink" title="å¢å¼ºè®°å¿†ç­–ç•¥"></a>å¢å¼ºè®°å¿†ç­–ç•¥</h3><p>è¯¥<code>AugmentedMemoizationPolicy</code>è®°å¾—ä»è®­ç»ƒçš„æ•…äº‹é•¿è¾¾ä¾‹å­<code>max_history</code>è½¬å¼¯ï¼Œå°±åƒ<code>MemoizationPolicy</code>ã€‚æ­¤å¤–ï¼Œå®ƒå…·æœ‰é—å¿˜æœºåˆ¶ï¼Œå¯ä»¥é—å¿˜å¯¹è¯å†å²è®°å½•ä¸­çš„æŸäº›æ­¥éª¤ï¼Œå¹¶å°è¯•åœ¨å†å²å‡å°‘çš„æ•…äº‹ä¸­æ‰¾åˆ°åŒ¹é…é¡¹ã€‚å®ƒé¢„æµ‹æœ‰ä¿¡å¿ƒä¸‹ä¸€ä¸ªåŠ¨ä½œ<code>1.0</code> ï¼Œå¦‚æœå‘ç°åŒ¹é…ï¼Œå¦åˆ™å°±é¢„æµ‹<code>None</code>æœ‰ä¿¡å¿ƒ<code>0.0</code>ã€‚</p>
<blockquote>
<p>æ³¨æ„</p>
<p>å¦‚æœæ‚¨åœ¨å¯¹è¯ä¸­æ— æ³•åœ¨è®­ç»ƒæ•…äº‹ä¸­è®¾ç½®åœ¨é¢„æµ‹æ—¶é—´å†…è®¾ç½®çš„æŸäº›æ—¶æ®µï¼ˆä¾‹å¦‚ï¼Œåœ¨ä»¥æé†’å¼€å¤´çš„è®­ç»ƒæ•…äº‹ä¸­ï¼Œæœªè®¾ç½®æ‰€æœ‰å…ˆå‰çš„æ—¶æ®µï¼‰ï¼Œè¯·ç¡®ä¿å°†æ²¡æœ‰æ’æ§½çš„ç›¸å…³æ•…äº‹æ·»åŠ åˆ°è®­ç»ƒæ•°æ®ä¸­ä¹Ÿä¸€æ ·ã€‚</p>
</blockquote>
<h3 id="åå¤‡æ”¿ç­–"><a href="#åå¤‡æ”¿ç­–" class="headerlink" title="åå¤‡æ”¿ç­–"></a>åå¤‡æ”¿ç­–</h3><p>æ‰€è¿°<code>FallbackPolicy</code>Aè°ƒç”¨<a href="#">å›é€€æ“ä½œ</a>ï¼Œå¦‚æœå‘ç”Ÿä»¥ä¸‹æƒ…å†µä¸­çš„è‡³å°‘ä¸€ä¸ªï¼š</p>
<ol>
<li>æ„å›¾è¯†åˆ«åœ¨ä¸‹é¢æœ‰ä¿¡å¿ƒ<code>nlu_threshold</code>ã€‚</li>
<li>æ’åæœ€é«˜çš„æ„å›¾çš„ç½®ä¿¡åº¦ä¸æ’åç¬¬äºŒçš„æ„å›¾ç›¸å·®å°äº<code>ambiguity_threshold</code>ã€‚</li>
<li>æ²¡æœ‰ä¸€é¡¹å¯¹è¯æ”¿ç­–èƒ½å¤Ÿé¢„æµ‹é‡‡å–é«˜äºä¿¡å¿ƒçš„è¡ŒåŠ¨<code>core_threshold</code>ã€‚</li>
</ol>
<p><strong>ç»„æ€ï¼š</strong></p>
<p>é˜ˆå€¼å’Œå›é€€æ“ä½œå¯ä»¥åœ¨ç­–ç•¥é…ç½®æ–‡ä»¶ä¸­ä½œä¸ºä»¥ä¸‹å‚æ•°è¿›è¡Œè°ƒæ•´<code>FallbackPolicy</code>ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">policies:
  <span class="token list punctuation">-</span> name: "FallbackPolicy"
<span class="token code keyword">    nlu_threshold: 0.3</span>
<span class="token code keyword">    ambiguity_threshold: 0.1</span>
<span class="token code keyword">    core_threshold: 0.3</span>
<span class="token code keyword">    fallback_action_name: 'action_default_fallback'</span></code></pre>
<table>
<thead>
<tr>
<th><code>nlu_threshold</code></th>
<th>æ¥å—NLUé¢„æµ‹æ‰€éœ€çš„æœ€ä½ç½®ä¿¡åº¦</th>
</tr>
</thead>
<tbody><tr>
<td><code>ambiguity_threshold</code></td>
<td>æœ€é«˜æ„å›¾çš„ç½®ä¿¡åº¦å¿…é¡»è¶…è¿‡ç¬¬äºŒé«˜æ„å›¾çš„ç½®ä¿¡åº¦çš„æœ€å°æ•°é‡ã€‚</td>
</tr>
<tr>
<td><code>core_threshold</code></td>
<td>æ¥å—Rasa Coreçš„åŠ¨ä½œé¢„æµ‹æ‰€éœ€çš„æœ€ä½ç½®ä¿¡åº¦</td>
</tr>
<tr>
<td><code>fallback_action_name</code></td>
<td>å¦‚æœæ„å›¾æˆ–æ“ä½œçš„ç½®ä¿¡åº¦ä½äºå„è‡ªçš„é˜ˆå€¼ï¼Œåˆ™è°ƒç”¨<a href="#">åå¤‡æ“ä½œçš„</a>åç§°</td>
</tr>
</tbody></table>
<p>æ‚¨è¿˜å¯ä»¥<code>FallbackPolicy</code>åœ¨pythonä»£ç ä¸­é…ç½®ï¼š</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> rasa<span class="token punctuation">.</span>core<span class="token punctuation">.</span>policies<span class="token punctuation">.</span>fallback <span class="token keyword">import</span> FallbackPolicy
<span class="token keyword">from</span> rasa<span class="token punctuation">.</span>core<span class="token punctuation">.</span>policies<span class="token punctuation">.</span>keras_policy <span class="token keyword">import</span> KerasPolicy
<span class="token keyword">from</span> rasa<span class="token punctuation">.</span>core<span class="token punctuation">.</span>agent <span class="token keyword">import</span> Agent

fallback <span class="token operator">=</span> FallbackPolicy<span class="token punctuation">(</span>fallback_action_name<span class="token operator">=</span><span class="token string">"action_default_fallback"</span><span class="token punctuation">,</span>
                          core_threshold<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>
                          nlu_threshold<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>
                          ambiguity_threshold<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span>

agent <span class="token operator">=</span> Agent<span class="token punctuation">(</span><span class="token string">"domain.yml"</span><span class="token punctuation">,</span> policies<span class="token operator">=</span><span class="token punctuation">[</span>KerasPolicy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fallback<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre>
<blockquote>
<p>æ³¨æ„</p>
<p>æ‚¨å¯ä»¥åœ¨é…ç½®ä¸­åŒ…å«<code>FallbackPolicy</code>æˆ– <code>TwoStageFallbackPolicy</code>ï¼Œä½†ä¸èƒ½åŒæ—¶åŒ…å«ä¸¤è€…ã€‚</p>
</blockquote>
<h3 id="ä¸¤é˜¶æ®µå›é€€ç­–ç•¥"><a href="#ä¸¤é˜¶æ®µå›é€€ç­–ç•¥" class="headerlink" title="ä¸¤é˜¶æ®µå›é€€ç­–ç•¥"></a>ä¸¤é˜¶æ®µå›é€€ç­–ç•¥</h3><p>è¯¥<code>TwoStageFallbackPolicy</code>æ‰‹æŸ„ä½NLUä¿¡å¿ƒå¤šä¸ªé˜¶æ®µï¼Œè¯•å›¾æ¾„æ¸…å¯¹ç”¨æˆ·è¾“å…¥ã€‚</p>
<ul>
<li>å¦‚æœNLUé¢„æµ‹çš„ç½®ä¿¡åº¦å¾—åˆ†ä½æˆ–ä¸æ˜æ˜¾é«˜äºæ’åç¬¬äºŒçš„é¢„æµ‹ï¼Œåˆ™è¦æ±‚ç”¨æˆ·ç¡®è®¤æ„å›¾çš„åˆ†ç±»ã€‚<ul>
<li>å¦‚æœä»–ä»¬è‚¯å®šäº†ï¼Œé‚£ä¹ˆæ•…äº‹å°†ç»§ç»­ï¼Œå°±å¥½åƒä»ä¸€å¼€å§‹å°±å¯¹æ„å›¾è¿›è¡Œäº†é«˜åº¦è‡ªä¿¡çš„åˆ†ç±»ã€‚</li>
<li>å¦‚æœä»–ä»¬æ‹’ç»ï¼Œåˆ™è¦æ±‚ç”¨æˆ·é‡æ–°è¡¨è¾¾ä»–ä»¬çš„æ¶ˆæ¯ã€‚</li>
</ul>
</li>
<li>æ”¹å†™<ul>
<li>å¦‚æœé‡æ–°è¡¨è¾¾æ„å›¾çš„åˆ†ç±»æ˜¯ç¡®å®šçš„ï¼Œåˆ™æ•…äº‹å°†ç»§ç»­ï¼Œå°±å¥½åƒç”¨æˆ·ä»ä¸€å¼€å§‹å°±å…·æœ‰æ­¤æ„å›¾ã€‚</li>
<li>å¦‚æœæªè¾çš„æ„å›¾æ²¡æœ‰è¢«é«˜å¯ä¿¡åº¦åˆ†ç±»ï¼Œåˆ™è¦æ±‚ç”¨æˆ·ç¡®è®¤åˆ†ç±»çš„æ„å›¾ã€‚</li>
</ul>
</li>
<li>ç¬¬äºŒæ¬¡ç¡®è®¤<ul>
<li>å¦‚æœç”¨æˆ·ç¡®è®¤äº†æ­¤æ„å›¾ï¼Œåˆ™æ•…äº‹å°†ç»§ç»­ï¼Œå°±åƒç”¨æˆ·ä»ä¸€å¼€å§‹å°±å…·æœ‰æ­¤æ„å›¾ä¸€æ ·ã€‚</li>
<li>å¦‚æœç”¨æˆ·æ‹’ç»ï¼Œåˆ™å°†åŸå§‹æ„å›¾åˆ†ç±»ä¸ºæŒ‡å®šçš„ <code>deny_suggestion_intent_name</code>ï¼Œå¹¶è§¦å‘æœ€ç»ˆçš„åå¤‡æ“ä½œï¼ˆä¾‹å¦‚ï¼Œç§»äº¤ç»™äººç±»ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<p><strong>ç»„æ€ï¼š</strong></p>
<p>è¦ä½¿ç”¨<code>TwoStageFallbackPolicy</code>ï¼Œè¯·åœ¨æ‚¨çš„ç­–ç•¥é…ç½®ä¸­åŒ…æ‹¬ä»¥ä¸‹å†…å®¹ã€‚</p>
<pre class=" language-markdown"><code class="language-markdown">policies:
  <span class="token list punctuation">-</span> name: TwoStageFallbackPolicy
<span class="token code keyword">    nlu_threshold: 0.3</span>
<span class="token code keyword">    ambiguity_threshold: 0.1</span>
<span class="token code keyword">    core_threshold: 0.3</span>
<span class="token code keyword">    fallback_core_action_name: "action_default_fallback"</span>
<span class="token code keyword">    fallback_nlu_action_name: "action_default_fallback"</span>
<span class="token code keyword">    deny_suggestion_intent_name: "out_of_scope"</span></code></pre>
<table>
<thead>
<tr>
<th><code>nlu_threshold</code></th>
<th>æ¥å—NLUé¢„æµ‹æ‰€éœ€çš„æœ€ä½ç½®ä¿¡åº¦</th>
</tr>
</thead>
<tbody><tr>
<td><code>ambiguity_threshold</code></td>
<td>æœ€é«˜æ„å›¾çš„ç½®ä¿¡åº¦å¿…é¡»è¶…è¿‡ç¬¬äºŒé«˜æ„å›¾çš„ç½®ä¿¡åº¦çš„æœ€å°æ•°é‡ã€‚</td>
</tr>
<tr>
<td><code>core_threshold</code></td>
<td>æ¥å—Rasa Coreçš„åŠ¨ä½œé¢„æµ‹æ‰€éœ€çš„æœ€ä½ç½®ä¿¡åº¦</td>
</tr>
<tr>
<td><code>fallback_core_action_name</code></td>
<td>å¦‚æœRasa CoreåŠ¨ä½œé¢„æµ‹çš„å¯ä¿¡åº¦ä½äºï¼Œåˆ™è°ƒç”¨ çš„<a href="#">åå¤‡åŠ¨ä½œçš„</a>åç§°<code>core_threshold</code>ã€‚è¯¥è¡ŒåŠ¨æ˜¯ä¸ºäº†æå‡ºå…¬è®¤çš„æ„å›¾</td>
</tr>
<tr>
<td><code>fallback_nlu_action_name</code></td>
<td>å¦‚æœRasa NLUæ„å‘åˆ†ç±»çš„ç½®ä¿¡åº¦ä½äºï¼Œåˆ™è°ƒç”¨ çš„<a href="#">åå¤‡æ“ä½œçš„</a>åç§°<code>nlu_threshold</code>ã€‚ç”¨æˆ·ç¬¬äºŒæ¬¡æ‹’ç»æ—¶è°ƒç”¨æ­¤æ“ä½œ</td>
</tr>
<tr>
<td><code>deny_suggestion_intent_name</code></td>
<td>æ„å‘çš„åç§°ï¼Œç”¨äºæ£€æµ‹ç”¨æˆ·æ˜¯å¦æ‹’ç»å»ºè®®çš„æ„å‘</td>
</tr>
</tbody></table>
<blockquote>
<p>æ³¨æ„</p>
<p>æ‚¨å¯ä»¥åœ¨é…ç½®ä¸­åŒ…å«<code>FallbackPolicy</code>æˆ– <code>TwoStageFallbackPolicy</code>ï¼Œä½†ä¸èƒ½åŒæ—¶åŒ…å«ä¸¤è€…ã€‚</p>
</blockquote>
<h3 id="è¡¨å•ç­–ç•¥"><a href="#è¡¨å•ç­–ç•¥" class="headerlink" title="è¡¨å•ç­–ç•¥"></a>è¡¨å•ç­–ç•¥</h3><p>çš„<code>FormPolicy</code>æ˜¯çš„ä¸€ä¸ªæ‰©å±•<code>MemoizationPolicy</code>ï¼Œå…¶å¤„ç†çš„å½¢å¼å¡«å……ã€‚ä¸€æ—¦<code>FormAction</code>è¢«è°ƒç”¨æ—¶ï¼Œ <code>FormPolicy</code>å°†ä¸æ–­é¢„æµ‹<code>FormAction</code>ï¼Œç›´åˆ°è¡¨æ ¼ä¸­çš„æ‰€æœ‰å¿…éœ€çš„æ§½åˆ†é…ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§<a href="#">Forms</a>ã€‚</p>
<h2 id="æ§½ä½"><a href="#æ§½ä½" class="headerlink" title="æ§½ä½"></a>æ§½ä½</h2><ul>
<li><a href="#">ä»€ä¹ˆæ˜¯æ§½ä½ï¼Ÿ</a></li>
<li><a href="#">Rasaå¦‚ä½•ä½¿ç”¨æ§½ä½</a></li>
<li><a href="#">æ§½ä½å¦‚ä½•è®¾ç½®</a><ul>
<li><a href="#">ä»NLUè®¾ç½®çš„æ§½ä½</a></li>
<li><a href="#">ç‚¹å‡»æŒ‰é’®æ§½ä½è®¾ç½®</a></li>
<li><a href="#">åŠ¨ä½œè®¾å®šçš„æ§½ä½</a></li>
</ul>
</li>
<li><a href="#">æ§½ä½ç±»å‹</a><ul>
<li><a href="#">æ–‡å­—æ§½ä½</a></li>
<li><a href="#">å¸ƒå°”æ§½ä½</a></li>
<li><a href="#">åˆ†ç±»æ§½ä½</a></li>
<li><a href="#">æµ®ç‚¹æ§½ä½</a></li>
<li><a href="#">æ•°ç»„æ§½ä½</a></li>
<li><a href="#">Unfeaturizedæ§½ä½</a></li>
</ul>
</li>
<li><a href="#">è‡ªå®šä¹‰å¹¿å‘Šä½ç±»å‹</a></li>
</ul>
<h3 id="ä»€ä¹ˆæ˜¯æ§½ä½ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯æ§½ä½ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯æ§½ä½ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯æ§½ä½ï¼Ÿ</h3><p><strong>æ’æ§½æ˜¯æ‚¨çš„æœºå™¨äººçš„è®°å¿†ã€‚</strong>å®ƒä»¬å……å½“é”®å€¼å­˜å‚¨ï¼Œå¯ç”¨äºå­˜å‚¨ç”¨æˆ·æä¾›çš„ä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œä»–ä»¬çš„å®¶ä¹¡åŸå¸‚ï¼‰ä»¥åŠæœ‰å…³å¤–ç•Œçš„ä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œæ•°æ®åº“æŸ¥è¯¢çš„ç»“æœï¼‰ã€‚</p>
<p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ‚¨å¸Œæœ›å¹¿å‘Šä½å½±å“å¯¹è¯çš„è¿›è¡Œæ–¹å¼ã€‚å¯¹äºä¸åŒçš„è¡Œä¸ºï¼Œæœ‰ä¸åŒçš„æ’æ§½ç±»å‹ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çš„ç”¨æˆ·æä¾›äº†ä»–ä»¬çš„å±…ä½åŸå¸‚ï¼Œåˆ™æ‚¨å¯èƒ½æœ‰ä¸€ä¸ª<code>text</code>åä¸ºçš„å¹¿å‘Šä½<code>home_city</code>ã€‚å¦‚æœç”¨æˆ·è¦æ±‚å¤©æ°”ï¼Œè€Œæ‚¨<em>ä¸</em>çŸ¥é“ä»–ä»¬çš„å®¶ä¹¡ï¼Œåˆ™å¿…é¡»å‘ä»–ä»¬è¯¢é—®ã€‚ä¸€ä¸ª<code>text</code>æ’æ§½åªå‘Šè¯‰èæ ¸å¿ƒçš„æ’æ§½æ˜¯å¦å…·æœ‰ä»·å€¼ã€‚å¹¿å‘Šä½çš„å…·ä½“å€¼<code>text</code>ï¼ˆä¾‹å¦‚ç­åŠ ç½—å°”ï¼Œçº½çº¦æˆ–é¦™æ¸¯ï¼‰æ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚</p>
<p>å¦‚æœè¯¥å€¼æœ¬èº«å¾ˆé‡è¦ï¼Œè¯·ä½¿ç”¨<code>categorical</code>æˆ–<code>bool</code>æ’æ§½ã€‚ä¹Ÿæœ‰<code>float</code>å’Œ<code>list</code>æ’æ§½ã€‚å¦‚æœæ‚¨åªæƒ³å­˜å‚¨ä¸€äº›æ•°æ®ï¼Œä½†åˆä¸æƒ³å½±å“å¯¹è¯çš„æµç¨‹ï¼Œè¯·ä½¿ç”¨<code>unfeaturized</code>æ’æ§½ã€‚</p>
<h3 id="Rasaå¦‚ä½•ä½¿ç”¨æ§½ä½"><a href="#Rasaå¦‚ä½•ä½¿ç”¨æ§½ä½" class="headerlink" title="Rasaå¦‚ä½•ä½¿ç”¨æ§½ä½"></a>Rasaå¦‚ä½•ä½¿ç”¨æ§½ä½</h3><p>åœ¨<code>Policy</code>æ²¡æœ‰è®¿é—®æ‚¨çš„æ’æ§½çš„ä»·å€¼ã€‚å®ƒæ”¶åˆ°ä¸€ä¸ªç‰¹å¾åŒ–çš„è¡¨ç¤ºã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œå¯¹äº<code>text</code>æ’æ§½ï¼Œè¯¥å€¼æ— å…³ç´§è¦ã€‚è¯¥ç­–ç•¥åªä¼šæ˜¾ç¤ºä¸€ä¸ª<code>1</code>æˆ–<code>0</code>å–å†³äºå®ƒæ˜¯å¦è®¾ç½®ã€‚</p>
<p><strong>æ‚¨åº”è¯¥ä»”ç»†é€‰æ‹©æ§½ä½ç±»å‹ï¼</strong></p>
<h4 id="æ§½ä½å¦‚ä½•è®¾ç½®"><a href="#æ§½ä½å¦‚ä½•è®¾ç½®" class="headerlink" title="æ§½ä½å¦‚ä½•è®¾ç½®"></a>æ§½ä½å¦‚ä½•è®¾ç½®</h4><p>æ‚¨å¯ä»¥ä¸ºåŸŸæ–‡ä»¶ä¸­çš„å¹¿å‘Šä½æä¾›åˆå§‹å€¼ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">slots:
  name:
<span class="token code keyword">    type: text</span>
<span class="token code keyword">    initial_value: "human"</span></code></pre>
<p>æ‚¨å¯ä»¥ä½¿ç”¨<code>.get_slot()</code>inside<code>actions.py</code>è·å–æ’æ§½çš„å€¼ï¼Œä¾‹å¦‚ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">data = tracker.get_slot("slot-name")</code></pre>
<p>åœ¨å¯¹è¯æœŸé—´å¯ä»¥ä½¿ç”¨å¤šç§æ–¹å¼è®¾ç½®å¹¿å‘Šä½ï¼š</p>
<h4 id="NLUè®¾ç½®çš„æ§½ä½"><a href="#NLUè®¾ç½®çš„æ§½ä½" class="headerlink" title="NLUè®¾ç½®çš„æ§½ä½"></a>NLUè®¾ç½®çš„æ§½ä½</h4><p>å¦‚æœæ‚¨çš„NLUæ¨¡å‹é€‰æ‹©ä¸€ä¸ªå®ä½“ï¼Œå¹¶ä¸”æ‚¨çš„åŸŸä¸­åŒ…å«ä¸€ä¸ªå…·æœ‰ç›¸åŒåç§°çš„æ’æ§½ï¼Œåˆ™è¯¥æ’æ§½å°†è‡ªåŠ¨è®¾ç½®ã€‚ä¾‹å¦‚ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> story_01</span>
<span class="token list punctuation">*</span> greet<span class="token entity" title="&#123;">&amp;#123;</span>"name": "Ali"<span class="token entity" title="&#125;">&amp;#125;</span>
  <span class="token list punctuation">-</span> slot<span class="token entity" title="&#123;">&amp;#123;</span>"name": "Ali"<span class="token entity" title="&#125;">&amp;#125;</span>
  <span class="token list punctuation">-</span> utter_greet</code></pre>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨ä¸å¿…åœ¨æ•…äº‹ä¸­åŒ…æ‹¬è¯¥é›¶ä»¶ï¼Œå› ä¸ºå®ƒæ˜¯è‡ªåŠ¨æ‹¾å–çš„ã€‚<code>- slot{}</code></p>
<p>è¦ä¸ºç‰¹å®šæ’æ§½ç¦ç”¨æ­¤è¡Œä¸ºï¼Œå¯ä»¥åœ¨åŸŸæ–‡ä»¶ä¸­å°†<code>auto_fill</code>å±æ€§è®¾ç½®ä¸º <code>False</code>ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">slots:
  name:
<span class="token code keyword">    type: text</span>
<span class="token code keyword">    auto_fill: False</span></code></pre>
<h4 id="ç‚¹å‡»æŒ‰é’®æ§½ä½è®¾ç½®"><a href="#ç‚¹å‡»æŒ‰é’®æ§½ä½è®¾ç½®" class="headerlink" title="ç‚¹å‡»æŒ‰é’®æ§½ä½è®¾ç½®"></a>ç‚¹å‡»æŒ‰é’®æ§½ä½è®¾ç½®</h4><p>æ‚¨å¯ä»¥å°†æŒ‰é’®ç”¨ä½œå¿«æ·æ–¹å¼ã€‚Rasa Coreå°†ä»¥å¼€å¤´çš„æ¶ˆæ¯å‘é€<code>/</code>åˆ° <code>RegexInterpreter</code>ï¼ŒæœŸæœ›NLUè¾“å…¥çš„æ ¼å¼ä¸æ•…äº‹æ–‡ä»¶ä¸­çš„æ ¼å¼ç›¸åŒï¼Œä¾‹å¦‚<code>/intent{entities}</code>ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè®©ç”¨æˆ·é€šè¿‡å•å‡»æŒ‰é’®æ¥é€‰æ‹©é¢œè‰²ï¼Œåˆ™æŒ‰é’®çš„æœ‰æ•ˆè½½è·å¯èƒ½æ˜¯å’Œã€‚<code>/choose{"color": "blue"}``/choose{"color": "red"}</code></p>
<p>æ‚¨å¯ä»¥åœ¨åŸŸæ–‡ä»¶ä¸­æŒ‡å®šä»¥ä¸‹å†…å®¹ï¼šï¼ˆè¯·å‚é˜…<a target="_blank" rel="noopener" href="https://legacy-docs-v1.rasa.com/core/domains/#domains">Domainsä¸­çš„</a>è¯¦ç»†ä¿¡æ¯ï¼‰</p>
<pre class=" language-markdown"><code class="language-markdown">utter<span class="token italic"><span class="token punctuation">_</span>ask<span class="token punctuation">_</span></span>color:
<span class="token list punctuation">-</span> text: "what color would you like?"
  buttons:
  <span class="token list punctuation">-</span> title: "blue"
<span class="token code keyword">    payload: '/choose&amp;#123;"color": "blue"&amp;#125;'</span>
  <span class="token list punctuation">-</span> title: "red"
<span class="token code keyword">    payload: '/choose&amp;#123;"color": "red"&amp;#125;'</span></code></pre>
<h4 id="åŠ¨ä½œæ§½ä½è®¾ç½®"><a href="#åŠ¨ä½œæ§½ä½è®¾ç½®" class="headerlink" title="åŠ¨ä½œæ§½ä½è®¾ç½®"></a>åŠ¨ä½œæ§½ä½è®¾ç½®</h4><p>ç¬¬äºŒç§æ–¹æ³•æ˜¯é€šè¿‡è¿”å›<a target="_blank" rel="noopener" href="https://legacy-docs-v1.rasa.com/core/actions/#custom-actions">è‡ªå®šä¹‰æ“ä½œä¸­çš„</a>äº‹ä»¶æ¥è®¾ç½®å¹¿å‘Šä½ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨çš„æ•…äº‹éœ€è¦åŒ…å«å¹¿å‘Šä½ã€‚ä¾‹å¦‚ï¼Œæ‚¨æœ‰ä¸€ä¸ªè‡ªå®šä¹‰æ“ä½œæ¥è·å–ç”¨æˆ·çš„ä¸ªäººèµ„æ–™ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ª<code>categorical</code>åä¸ºçš„å¹¿å‘Šä½<code>account_type</code>ã€‚å½“<code>fetch_profile</code>è¿è¡ŒåŠ¨ä½œï¼Œå®ƒè¿”å›ä¸€ä¸ª <a target="_blank" rel="noopener" href="https://legacy-docs-v1.rasa.com/api/events/#rasa.core.events.SlotSet"><code>rasa.core.events.SlotSet</code></a>äº‹ä»¶ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">slots:
   account_type:
<span class="token code keyword">      type: categorical</span>
<span class="token code keyword">      values:</span>
<span class="token code keyword">      - premium</span>
<span class="token code keyword">      - basic</span>
from rasa<span class="token italic"><span class="token punctuation">_</span>sdk.actions import Action
from rasa<span class="token punctuation">_</span></span>sdk.events import SlotSet
import requests

class FetchProfileAction(Action):
<span class="token code keyword">    def name(self):</span>
<span class="token code keyword">        return "fetch_profile"</span>

<span class="token code keyword">    def run(self, dispatcher, tracker, domain):</span>
<span class="token code keyword">        url = "http://myprofileurl.com"</span>
<span class="token code keyword">        data = requests.get(url).json</span>
<span class="token code keyword">        return [SlotSet("account_type", data["account_type"])]</span>
<span class="token title important"><span class="token punctuation">#</span> story_01</span>
<span class="token list punctuation">*</span> greet
  <span class="token list punctuation">-</span> action<span class="token italic"><span class="token punctuation">_</span>fetch<span class="token punctuation">_</span></span>profile
  <span class="token list punctuation">-</span> slot<span class="token entity" title="&#123;">&amp;#123;</span>"account_type" : "premium"<span class="token entity" title="&#125;">&amp;#125;</span>
  <span class="token list punctuation">-</span> utter<span class="token italic"><span class="token punctuation">_</span>welcome<span class="token punctuation">_</span></span>premium

<span class="token title important"><span class="token punctuation">#</span> story_02</span>
<span class="token list punctuation">*</span> greet
  <span class="token list punctuation">-</span> action<span class="token italic"><span class="token punctuation">_</span>fetch<span class="token punctuation">_</span></span>profile
  <span class="token list punctuation">-</span> slot<span class="token entity" title="&#123;">&amp;#123;</span>"account_type" : "basic"<span class="token entity" title="&#125;">&amp;#125;</span>
  <span class="token list punctuation">-</span> utter<span class="token italic"><span class="token punctuation">_</span>welcome<span class="token punctuation">_</span></span>basic</code></pre>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ <strong>å°±</strong>å¿…é¡»åŒ…æ‹¬åœ¨ä½ çš„æ•…äº‹çš„ä¸€éƒ¨åˆ†ã€‚Rasa Coreå°†å­¦ä¹ ä½¿ç”¨æ­¤ä¿¡æ¯æ¥å†³å®šè¦é‡‡å–çš„æ­£ç¡®æªæ–½ï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸ºæˆ–ï¼‰ã€‚<code>- slot{}``utter_welcome_premium``utter_welcome_basic</code></p>
<blockquote>
<p>æ³¨æ„</p>
<p>å¦‚æœæ‚¨æ‰‹åŠ¨ç¼–å†™æ•…äº‹ï¼Œåˆ™<strong>å¾ˆå®¹æ˜“</strong>å¿˜è®°æ’æ§½ã€‚æˆ‘ä»¬å¼ºçƒˆå»ºè®®æ‚¨ä½¿ç”¨<a href="#">å¸¦è¡¨å•çš„äº¤äº’å¼å­¦ä¹ </a>æ¥æ„å»ºè¿™äº›æ•…äº‹<a target="_blank" rel="noopener" href="https://legacy-docs-v1.rasa.com/core/interactive-learning/#section-interactive-learning-forms">ï¼Œ</a>è€Œä¸è¦ç¼–å†™å®ƒä»¬ã€‚</p>
</blockquote>
<h3 id="æ’æ§½ç±»å‹"><a href="#æ’æ§½ç±»å‹" class="headerlink" title="æ’æ§½ç±»å‹"></a>æ’æ§½ç±»å‹</h3><p><strong>text</strong></p>
<table>
<thead>
<tr>
<th><strong>Use For</strong></th>
<th>æ‚¨åªå…³å¿ƒæ˜¯å¦å·²æŒ‡å®šç”¨æˆ·é¦–é€‰é¡¹çš„ä½ç½®ã€‚</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Example</strong></td>
<td>slots:    <br>     cuisine:      <br>            type: text</td>
</tr>
<tr>
<td><strong>Description</strong></td>
<td><code>1</code>å¦‚æœè®¾ç½®äº†ä»»ä½•å€¼ï¼Œåˆ™å°†æ’æ§½çš„åŠŸèƒ½è®¾ç½®ä¸ºã€‚å¦åˆ™ï¼ŒåŠŸèƒ½å°†è®¾ç½®ä¸º<code>0</code>ï¼ˆæœªè®¾ç½®ä»»ä½•å€¼ï¼‰ã€‚</td>
</tr>
</tbody></table>
<p><strong>bool</strong></p>
<table>
<thead>
<tr>
<th><strong>Use For</strong></th>
<th>æ‚¨åªå…³å¿ƒæ˜¯å¦å·²æŒ‡å®šç”¨æˆ·é¦–é€‰é¡¹çš„ä½ç½®ã€‚</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Example</strong></td>
<td>slots:    <br>     cuisine:      <br>            type: text</td>
</tr>
<tr>
<td><strong>Description</strong></td>
<td><code>1</code>å¦‚æœè®¾ç½®äº†ä»»ä½•å€¼ï¼Œåˆ™å°†æ’æ§½çš„åŠŸèƒ½è®¾ç½®ä¸ºã€‚å¦åˆ™ï¼ŒåŠŸèƒ½å°†è®¾ç½®ä¸º<code>0</code>ï¼ˆæœªè®¾ç½®ä»»ä½•å€¼ï¼‰ã€‚</td>
</tr>
</tbody></table>
<p><strong>categorical</strong></p>
<table>
<thead>
<tr>
<th><strong>Use For</strong></th>
<th>æ’æ§½å¯ä»¥é‡‡ç”¨Nä¸ªå€¼ä¹‹ä¸€</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Example</strong></td>
<td>slots:    <br>    risk_level:      <br>          type: categorical     <br>           values:       <br>            - low  <br>            - medium <br>            - high</td>
</tr>
<tr>
<td><strong>Description</strong></td>
<td>åˆ›å»ºä¸€ä¸ªå•ç¼–ç ï¼Œæè¿°å“ªä¸ª<code>values</code>åŒ¹é…ã€‚é»˜è®¤å€¼<code>__other__</code>ä¼šè‡ªåŠ¨æ·»åŠ åˆ°ç”¨æˆ·å®šä¹‰çš„å€¼ä¸­ã€‚é‡åˆ°çš„æ‰€æœ‰æœªåœ¨åŸŸä¸­æ˜ç¡®å®šä¹‰çš„å€¼éƒ½å°†æ˜ å°„åˆ°<code>__other__</code>ç‰¹å¾ã€‚è¯¥å€¼ <code>__other__</code>ä¸åº”ç”¨ä½œç”¨æˆ·å®šä¹‰çš„å€¼ï¼›å¦‚æœæ˜¯è¿™æ ·ï¼Œå®ƒå°†ä»ç„¶æ˜¯æ‰€æœ‰æœªæ˜¾ç¤ºå€¼æ˜ å°„åˆ°çš„é»˜è®¤å€¼ã€‚</td>
</tr>
</tbody></table>
<p><strong>float</strong></p>
<table>
<thead>
<tr>
<th><strong>Use For</strong></th>
<th>è¿ç»­å€¼</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Example</strong></td>
<td>slots:   <br>     temperature:  <br>              type: float  <br>              min_value: -100.0 <br>              max_value:  100.0</td>
</tr>
<tr>
<td><strong>Defaults</strong></td>
<td>max_value=1.0<code>ï¼Œ </code>min_value=0.0</td>
</tr>
<tr>
<td><strong>Description</strong></td>
<td>ä¸‹é¢çš„æ‰€æœ‰å€¼éƒ½<code>min_value</code>å°†è¢«è§†ä¸º<code>min_value</code>ï¼Œä¸Šé¢çš„å€¼ä¹Ÿä¸€æ ·<code>max_value</code>ã€‚å› æ­¤ï¼Œå¦‚æœ<code>max_value</code>å°†å…¶è®¾ç½®ä¸º <code>1</code>ï¼Œåˆ™æ’æ§½å€¼ä¹‹é—´<code>2</code>å’Œ<code>3.5</code>åœ¨åŠŸèƒ½åŒ–æ–¹é¢æ²¡æœ‰åŒºåˆ«ï¼ˆä¾‹å¦‚ï¼Œä¸¤ä¸ªå€¼å°†ä»¥ç›¸åŒçš„æ–¹å¼å½±å“å¯¹è¯ï¼Œå¹¶ä¸”æ¨¡å‹æ— æ³•å­¦ä¼šåŒºåˆ†å®ƒä»¬ï¼‰ã€‚</td>
</tr>
</tbody></table>
<p><strong>list</strong></p>
<table>
<thead>
<tr>
<th><strong>Use For</strong></th>
<th>å€¼æ¸…å•</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Example</strong></td>
<td>slots:   <br>     shopping_items:      <br>              type: list</td>
</tr>
<tr>
<td><strong>Description</strong></td>
<td><code>1</code>å¦‚æœè®¾ç½®äº†å¸¦æœ‰åˆ—è¡¨çš„å€¼ï¼ˆåˆ—è¡¨ä¸ä¸ºç©ºï¼‰ï¼Œåˆ™è®¾ç½®æ­¤æ’æ§½çš„åŠŸèƒ½ã€‚å¦‚æœæœªè®¾ç½®ä»»ä½•å€¼ï¼Œæˆ–è€…ç©ºç™½åˆ—è¡¨ä¸ºè®¾ç½®å€¼ï¼Œåˆ™è¯¥åŠŸèƒ½å°†ä¸º<code>0</code>ã€‚<strong>å­˜å‚¨åœ¨æ’æ§½ä¸­çš„åˆ—è¡¨</strong>çš„<strong>é•¿åº¦ä¸å½±å“å¯¹è¯</strong>ã€‚</td>
</tr>
</tbody></table>
<p><strong>unfeaturized</strong></p>
<table>
<thead>
<tr>
<th><strong>Use For</strong></th>
<th>æ‚¨è¦å­˜å‚¨çš„æ•°æ®ä¸åº”å½±å“å¯¹è¯æµç¨‹</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Example</strong></td>
<td>slots:    <br>      internal_user_id:     <br>               type: unfeaturized</td>
</tr>
<tr>
<td><strong>Description</strong></td>
<td>è¯¥æ’æ§½ä¸ä¼šå…·æœ‰ä»»ä½•ç‰¹å¾ï¼Œå› æ­¤å…¶å€¼ä¸ä¼šå½±å“å¯¹è¯æµç¨‹ï¼Œåœ¨é¢„æµ‹æœºå™¨äººåº”æ‰§è¡Œçš„ä¸‹ä¸€ä¸ªåŠ¨ä½œæ—¶ä¼šè¢«å¿½ç•¥ã€‚</td>
</tr>
</tbody></table>
<h3 id="è‡ªå®šä¹‰æ’æ§½ç±»å‹"><a href="#è‡ªå®šä¹‰æ’æ§½ç±»å‹" class="headerlink" title="è‡ªå®šä¹‰æ’æ§½ç±»å‹"></a>è‡ªå®šä¹‰æ’æ§½ç±»å‹</h3><p>ä¹Ÿè®¸æ‚¨çš„é¤å…é¢„è®¢ç³»ç»Ÿæœ€å¤šåªèƒ½å¤„ç†6äººçš„é¢„è®¢ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¸Œæœ›å¹¿å‘Šä½çš„<em>å€¼</em>å½±å“ä¸‹ä¸€ä¸ªé€‰å®šçš„æ“ä½œï¼ˆè€Œä¸åªæ˜¯å½±å“æ˜¯å¦å·²æŒ‡å®šï¼‰ã€‚æ‚¨å¯ä»¥é€šè¿‡å®šä¹‰è‡ªå®šä¹‰æ’æ§½ç±»æ¥å®ç°ã€‚</p>
<p>åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåä¸ºçš„æ’æ§½ç±»<code>NumberOfPeopleSlot</code>ã€‚åŠŸèƒ½åŒ–å®šä¹‰äº†å¦‚ä½•å°†æ­¤æ’æ§½çš„å€¼è½¬æ¢ä¸ºå‘é‡ä»¥ä¾›æˆ‘ä»¬çš„æœºå™¨å­¦ä¹ æ¨¡å‹å¤„ç†ã€‚æˆ‘ä»¬çš„å¹¿å‘Šä½æœ‰ä¸‰ä¸ªå¯èƒ½çš„â€œå€¼â€ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨lengthçš„å‘é‡è¡¨ç¤ºå®ƒä»¬<code>2</code>ã€‚</p>
<table>
<thead>
<tr>
<th><code>(0,0)</code></th>
<th>å°šæœªè®¾å®š</th>
</tr>
</thead>
<tbody><tr>
<td><code>(1,0)</code></td>
<td>1è‡³6</td>
</tr>
<tr>
<td><code>(0,1)</code></td>
<td>è¶…è¿‡6</td>
</tr>
</tbody></table>
<pre class=" language-markdown"><code class="language-markdown">from rasa.core.slots import Slot

class NumberOfPeopleSlot(Slot):

<span class="token code keyword">    def feature_dimensionality(self):</span>
<span class="token code keyword">        return 2</span>

<span class="token code keyword">    def as_feature(self):</span>
<span class="token code keyword">        r = [0.0] * self.feature_dimensionality()</span>
<span class="token code keyword">        if self.value:</span>
<span class="token code keyword">            if self.value &lt;= 6:</span>
<span class="token code keyword">                r[0] = 1.0</span>
<span class="token code keyword">            else:</span>
<span class="token code keyword">                r[1] = 1.0</span>
<span class="token code keyword">        return r</span></code></pre>
<p>ç°åœ¨æˆ‘ä»¬è¿˜éœ€è¦ä¸€äº›åŸ¹è®­æ•…äº‹ï¼Œä»¥ä¾¿Rasa Coreå¯ä»¥ä»ä¸­å­¦ä¹ å¦‚ä½•å¤„ç†ä¸åŒæƒ…å†µï¼š</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> story1</span>
...
<span class="token list punctuation">*</span> inform<span class="token entity" title="&#123;">&amp;#123;</span>"people": "3"<span class="token entity" title="&#125;">&amp;#125;</span>
  <span class="token list punctuation">-</span> action<span class="token italic"><span class="token punctuation">_</span>book<span class="token punctuation">_</span></span>table
...
<span class="token title important"><span class="token punctuation">#</span> story2</span>
<span class="token list punctuation">*</span> inform<span class="token entity" title="&#123;">&amp;#123;</span>"people": "9"<span class="token entity" title="&#125;">&amp;#125;</span>
  <span class="token list punctuation">-</span> action<span class="token italic"><span class="token punctuation">_</span>explain<span class="token punctuation">_</span></span>table_limit</code></pre>
<h2 id="è¡¨æ ¼"><a href="#è¡¨æ ¼" class="headerlink" title="è¡¨æ ¼"></a>è¡¨æ ¼</h2><blockquote>
<p>æ³¨æ„</p>
<p>æœ‰ä¸€ä¸ªæ·±å…¥çš„æ•™ç¨‹<a href="#">ç‚¹å‡»è¿™é‡Œ</a>äº†è§£å¦‚ä½•ä½¿ç”¨èå½¢å¼çš„æ§½åˆ†é…ã€‚</p>
</blockquote>
<ul>
<li><a href="#">é…ç½®æ–‡ä»¶</a></li>
<li><a href="#">è¡¨æ ¼åŸºç¡€</a></li>
<li><a href="#">è‡ªå®šä¹‰æ’æ§½æ˜ å°„</a></li>
<li><a href="#">éªŒè¯ç”¨æˆ·è¾“å…¥</a></li>
<li><a href="#">å¤„ç†ä¸æ„‰å¿«è·¯å¾„</a></li>
<li><a href="#">request_slotæ§½ä½</a></li>
<li><a href="#">å¤„ç†æ¡ä»¶æ—¶éš™é€»è¾‘</a></li>
<li><a href="#">è°ƒè¯•</a></li>
</ul>
<p>æœ€å¸¸è§çš„å¯¹è¯æ¨¡å¼ä¹‹ä¸€æ˜¯ä»ç”¨æˆ·é‚£é‡Œæ”¶é›†ä¸€äº›ä¿¡æ¯ï¼Œä»¥ä¾¿åšæŸäº‹ï¼ˆé¢„è®¢é¤å…ï¼Œè°ƒç”¨APIï¼Œæœç´¢æ•°æ®åº“ç­‰ï¼‰ã€‚è¿™ä¹Ÿç§°ä¸º<strong>æ’æ§½å¡«å……</strong>ã€‚</p>
<p>å¦‚æœæ‚¨éœ€è¦è¿ç»­æ”¶é›†å¤šæ¡ä¿¡æ¯ï¼Œå»ºè®®æ‚¨åˆ›å»ºä¸€ä¸ª<code>FormAction</code>ã€‚è¿™æ˜¯ä¸€ä¸ªå•ä¸€æ“ä½œï¼ŒåŒ…å«å¾ªç¯éå†æ‰€éœ€æ’æ§½å¹¶è¦æ±‚ç”¨æˆ·æä¾›æ­¤ä¿¡æ¯çš„é€»è¾‘ã€‚åœ¨<code>examples/formbot</code>Rasa Coreç›®å½•ä¸­æœ‰ä¸€ä¸ªä½¿ç”¨è¡¨å•çš„å®Œæ•´ç¤ºä¾‹ã€‚</p>
<p>å®šä¹‰è¡¨å•æ—¶ï¼Œéœ€è¦å°†å…¶æ·»åŠ åˆ°åŸŸæ–‡ä»¶ä¸­ã€‚å¦‚æœæ‚¨çš„è¡¨å•åç§°ä¸º<code>restaurant_form</code>ï¼Œåˆ™æ‚¨çš„åŸŸå°†å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">forms:
  <span class="token list punctuation">-</span> restaurant_form
actions:
  ...</code></pre>
<p>è¯·å‚é˜…<code>examples/formbot/domain.yml</code>ç¤ºä¾‹ã€‚</p>
<h3 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h3><p>è¦ä½¿ç”¨è¡¨æ ¼ï¼Œæ‚¨è¿˜éœ€è¦<code>FormPolicy</code>åœ¨ç­–ç•¥é…ç½®æ–‡ä»¶ä¸­åŒ…å«ã€‚ä¾‹å¦‚ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">policies:
  <span class="token list punctuation">-</span> name: "FormPolicy"</code></pre>
<p>è¯·å‚é˜…<code>examples/formbot/config.yml</code>ç¤ºä¾‹ã€‚</p>
<h3 id="è¡¨æ ¼åŸºç¡€çŸ¥è¯†"><a href="#è¡¨æ ¼åŸºç¡€çŸ¥è¯†" class="headerlink" title="è¡¨æ ¼åŸºç¡€çŸ¥è¯†"></a>è¡¨æ ¼åŸºç¡€çŸ¥è¯†</h3><p>ä½¿ç”¨<code>FormAction</code>ï¼Œæ‚¨å¯ä»¥ç”¨ä¸€ä¸ªæ•…äº‹æè¿°<em>æ‰€æœ‰</em>å¿«ä¹çš„é“è·¯ã€‚æ‰€è°“â€œå¹¸ç¦ä¹‹è·¯â€ï¼Œæ˜¯æŒ‡æ¯å½“æ‚¨å‘ç”¨æˆ·è¯¢é—®æŸäº›ä¿¡æ¯æ—¶ï¼Œä»–ä»¬éƒ½ä¼šç”¨æ‚¨æ‰€è¦æ±‚çš„ä¿¡æ¯è¿›è¡Œå“åº”ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬ä»¥é¤å…æœºå™¨äººä¸ºä¾‹ï¼Œé‚£ä¹ˆè¿™ä¸ªå•ä¸€çš„æ•…äº‹å°†æè¿°æ‰€æœ‰å¿«ä¹çš„é“è·¯ã€‚</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">##</span> happy path</span>
<span class="token list punctuation">*</span> request_restaurant
<span class="token code keyword">    - restaurant_form</span>
<span class="token code keyword">    - form&amp;#123;"name": "restaurant_form"&amp;#125;</span>
<span class="token code keyword">    - form&amp;#123;"name": null&amp;#125;</span></code></pre>
<p>åœ¨è¿™ä¸ªæ•…äº‹ä¸­ï¼Œç”¨æˆ·çš„æ„å›¾æ˜¯<code>request_restaurant</code>ï¼Œå…¶æ¬¡æ˜¯è¡¨å•åŠ¨ä½œ<code>restaurant_form</code>ã€‚éšç€å½¢å¼è¢«æ¿€æ´»ï¼Œå¹¶ä¸å½¢å¼å†æ¬¡æ¿€æ´»ã€‚å¦‚<a href="#">å¤„ç†ä¸æ„‰å¿«è·¯å¾„</a>éƒ¨åˆ†ä¸­æ‰€ç¤ºï¼Œå½“è¡¨å•ä»å¤„äºæ´»åŠ¨çŠ¶æ€æ—¶ï¼Œæœºå™¨äººå¯ä»¥åœ¨è¡¨å•å¤–æ‰§è¡Œä»»ä½•ç±»å‹çš„æ“ä½œã€‚åœ¨ç”¨æˆ·åˆä½œè‰¯å¥½ä¸”ç³»ç»Ÿæ­£ç¡®ç†è§£ç”¨æˆ·è¾“å…¥çš„â€œå¿«ä¹ä¹‹è·¯â€ä¸Šï¼Œè¡¨æ ¼å°†ä¸é—´æ–­åœ°å¡«å†™æ‰€æœ‰è¯·æ±‚çš„ç©ºä½ã€‚<code>form{"name": "restaurant_form"}  form{"name": null}</code></p>
<p>åœ¨<code>FormAction</code>å°†ä»…è¯·æ±‚å·²å°šæœªè®¾ç½®æ§½ã€‚å¦‚æœç”¨æˆ·ä¸æˆ‘æƒ³è¦ä¸€å®¶8äººç´ é£Ÿçš„ä¸­é¤é¦†å¼€å§‹å¯¹è¯ ï¼Œåˆ™ä¸ä¼šè¯¢é—®ä»–ä»¬æœ‰å…³<code>cuisine</code>å’Œçš„ä¿¡æ¯<code>num_people</code>ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œè¦ä½¿è¯¥æ•…äº‹æ­£å¸¸è¿è¡Œï¼Œæ‚¨çš„å¹¿å‘Šä½åº”æœªè®¾ç½®<a href="#">ç‰¹è‰²</a>ã€‚å¦‚æœè¿™äº›ä½ç½®ä¸­çš„ä»»ä½•ä¸€ä¸ªå¤„äºæ­£å¸¸çŠ¶æ€ï¼Œåˆ™æ‚¨çš„æ•…äº‹éœ€è¦åŒ…æ‹¬<code>slot{}</code>äº‹ä»¶ä»¥æ˜¾ç¤ºå·²è®¾ç½®çš„è¿™äº›ä½ç½®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåˆ›å»ºæœ‰æ•ˆæ•…äº‹çš„æœ€ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨â€œ<a href="#">äº¤äº’å¼å­¦ä¹ â€</a>ã€‚</p>
<p>åœ¨ä¸Šé¢çš„æ•…äº‹ä¸­ï¼Œ<code>restaurant_form</code>æ˜¯æˆ‘ä»¬è¡¨å•åŠ¨ä½œçš„åç§°ã€‚è¿™æ˜¯ä¸€ä¸ªçœ‹èµ·æ¥åƒçš„ä¾‹å­ã€‚æ‚¨éœ€è¦å®šä¹‰ä¸‰ç§æ–¹æ³•ï¼š</p>
<ul>
<li><code>name</code>ï¼šæ­¤æ“ä½œçš„åç§°</li>
<li><code>required_slots</code>ï¼šè¦ä½¿ç”¨è¯¥<code>submit</code>æ–¹æ³•ï¼Œå¿…é¡»å¡«å†™çš„æ’æ§½åˆ—è¡¨ã€‚</li>
<li><code>submit</code>ï¼šå¡«å†™å®Œæ‰€æœ‰å¹¿å‘Šä½åï¼Œè¡¨æ ¼æœ«å°¾çš„æ“ä½œã€‚</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Text<span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Unique identifier of the form"""</span>

    <span class="token keyword">return</span> <span class="token string">"restaurant_form"</span>
@staticmethod
<span class="token keyword">def</span> <span class="token function">required_slots</span><span class="token punctuation">(</span>tracker<span class="token punctuation">:</span> Tracker<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> List<span class="token punctuation">[</span>Text<span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""A list of required slots that the form has to fill"""</span>

    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">"cuisine"</span><span class="token punctuation">,</span> <span class="token string">"num_people"</span><span class="token punctuation">,</span> <span class="token string">"outdoor_seating"</span><span class="token punctuation">,</span> <span class="token string">"preferences"</span><span class="token punctuation">,</span> <span class="token string">"feedback"</span><span class="token punctuation">]</span>
<span class="token keyword">def</span> <span class="token function">submit</span><span class="token punctuation">(</span>
    self<span class="token punctuation">,</span>
    dispatcher<span class="token punctuation">:</span> CollectingDispatcher<span class="token punctuation">,</span>
    tracker<span class="token punctuation">:</span> Tracker<span class="token punctuation">,</span>
    domain<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span>Text<span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> List<span class="token punctuation">[</span>Dict<span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Define what the form has to do
        after all required slots are filled"""</span>

    <span class="token comment" spellcheck="true"># utter submit template</span>
    dispatcher<span class="token punctuation">.</span>utter_message<span class="token punctuation">(</span>template<span class="token operator">=</span><span class="token string">"utter_submit"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></code></pre>
<p>ç¬¬ä¸€æ¬¡è°ƒç”¨è¡¨å•åŠ¨ä½œåï¼Œè¡¨å•å°†è¢«æ¿€æ´»å¹¶<code>FormPolicy</code>è·³è½¬ã€‚<code>FormPolicy</code>æå…¶ç®€å•ï¼Œå®ƒæ€»æ˜¯å¯ä»¥é¢„æµ‹è¡¨å•åŠ¨ä½œã€‚è¯·å‚é˜…<a href="#">å¤„ç†ä¸æ»¡æ„çš„è·¯å¾„</a>ä»¥äº†è§£å¦‚ä½•<a href="#">å¤„ç†</a>æ„å¤–çš„ç”¨æˆ·è¾“å…¥ã€‚</p>
<p>æ¯æ¬¡è°ƒç”¨è¡¨å•æ“ä½œæ—¶ï¼Œå®ƒå°†è¯¢é—®ç”¨æˆ·<code>required_slots</code>å°šæœªè®¾ç½®çš„ä¸‹ä¸€ä¸ªæ’æ§½ ã€‚å®ƒé€šè¿‡æŸ¥æ‰¾åä¸ºçš„å“åº”æ¥å®Œæˆæ­¤æ“ä½œ<code>utter_ask_{slot_name}</code>ï¼Œå› æ­¤æ‚¨éœ€è¦åœ¨åŸŸæ–‡ä»¶ä¸­ä¸ºæ¯ä¸ªæ‰€éœ€çš„æ’æ§½å®šä¹‰å®ƒä»¬ã€‚</p>
<p>ä¸€æ—¦æ‰€æœ‰æ’æ§½éƒ½è£…æ»¡ï¼Œ<code>submit()</code>ä¾¿ä¼šè°ƒç”¨æ–¹æ³•ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­ä½¿ç”¨æ‰€æ”¶é›†çš„ä¿¡æ¯ä¸ºç”¨æˆ·åšæŸäº‹ï¼Œä¾‹å¦‚æŸ¥è¯¢é¤å…APIã€‚å¦‚æœæ‚¨ä¸å¸Œæœ›è¡¨å•æœ€ååšä»»ä½•äº‹æƒ…ï¼Œåªéœ€å°†å…¶ ç”¨ä½œæ‚¨çš„Submitæ–¹æ³•ã€‚è°ƒç”¨Submitæ–¹æ³•ä¹‹åï¼Œå°†åœç”¨è¡¨å•ï¼Œå¹¶å°†ä½¿ç”¨Coreæ¨¡å‹ä¸­çš„å…¶ä»–ç­–ç•¥æ¥é¢„æµ‹ä¸‹ä¸€æ­¥æ“ä½œã€‚<code>return []</code></p>
<h3 id="è‡ªå®šä¹‰æ’æ§½æ˜ å°„"><a href="#è‡ªå®šä¹‰æ’æ§½æ˜ å°„" class="headerlink" title="è‡ªå®šä¹‰æ’æ§½æ˜ å°„"></a>è‡ªå®šä¹‰æ’æ§½æ˜ å°„</h3><p>å¦‚æœæœªå®šä¹‰æ’æ§½æ˜ å°„ï¼Œåˆ™æ’æ§½å°†ä»…ç”±ä¸ä»ç”¨æˆ·è¾“å…¥ä¸­æ‹¾å–çš„æ’æ§½åç§°ç›¸åŒçš„å®ä½“å¡«å……ã€‚æŸäº›æ§½ä½ï¼ˆä¾‹å¦‚<code>cuisine</code>ï¼‰å¯ä»¥ä½¿ç”¨å•ä¸ªå®ä½“è·å–ï¼Œä½†æ˜¯ <code>FormAction</code>ä¹Ÿå¯ä»¥æ”¯æŒæ˜¯/å¦é—®é¢˜å’Œè‡ªç”±æ–‡æœ¬è¾“å…¥ã€‚è¯¥<code>slot_mappings</code>æ–¹æ³•å®šä¹‰äº†å¦‚ä½•ä»ç”¨æˆ·å“åº”ä¸­æå–å¹¿å‘Šä½å€¼ã€‚</p>
<p>è¿™æ˜¯é¤å…æœºå™¨äººçš„ç¤ºä¾‹ï¼š</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">slot_mappings</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Dict<span class="token punctuation">[</span>Text<span class="token punctuation">,</span> Union<span class="token punctuation">[</span>Dict<span class="token punctuation">,</span> List<span class="token punctuation">[</span>Dict<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""A dictionary to map required slots to
        - an extracted entity
        - intent: value pairs
        - a whole message
        or a list of them, where a first match will be picked"""</span>

    <span class="token keyword">return</span> <span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;</span>
        <span class="token string">"cuisine"</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>from_entity<span class="token punctuation">(</span>entity<span class="token operator">=</span><span class="token string">"cuisine"</span><span class="token punctuation">,</span> not_intent<span class="token operator">=</span><span class="token string">"chitchat"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">"num_people"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            self<span class="token punctuation">.</span>from_entity<span class="token punctuation">(</span>
                entity<span class="token operator">=</span><span class="token string">"number"</span><span class="token punctuation">,</span> intent<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"inform"</span><span class="token punctuation">,</span> <span class="token string">"request_restaurant"</span><span class="token punctuation">]</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">"outdoor_seating"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            self<span class="token punctuation">.</span>from_entity<span class="token punctuation">(</span>entity<span class="token operator">=</span><span class="token string">"seating"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            self<span class="token punctuation">.</span>from_intent<span class="token punctuation">(</span>intent<span class="token operator">=</span><span class="token string">"affirm"</span><span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            self<span class="token punctuation">.</span>from_intent<span class="token punctuation">(</span>intent<span class="token operator">=</span><span class="token string">"deny"</span><span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">"preferences"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            self<span class="token punctuation">.</span>from_intent<span class="token punctuation">(</span>intent<span class="token operator">=</span><span class="token string">"deny"</span><span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token string">"no additional preferences"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            self<span class="token punctuation">.</span>from_text<span class="token punctuation">(</span>not_intent<span class="token operator">=</span><span class="token string">"affirm"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">"feedback"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>from_entity<span class="token punctuation">(</span>entity<span class="token operator">=</span><span class="token string">"feedback"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>from_text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#125;</span></code></pre>
<p>é¢„å®šä¹‰çš„åŠŸèƒ½å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>self.from_entity(entity=entity_name, intent=intent_name, role=role_name, group=group_name)</code> å°†æŸ¥æ‰¾ç§°ä¸ºå®ä½“<code>entity_name</code>ï¼Œä»¥å¡«è¡¥æ’æ§½ <code>slot_name</code>ï¼Œæ— è®ºç”¨æˆ·çš„æ„å›¾ï¼Œå¦‚æœ<code>intent_name</code>æ˜¯<code>None</code> å…¶ä»–äººåªæœ‰æ„å‘çš„ç”¨æˆ·æ˜¯<code>intent_name</code>ã€‚å¦‚æœæä¾›<code>role_name</code>å’Œ/æˆ–<code>group_name</code> ï¼Œåˆ™å®ä½“çš„è§’è‰²/ç»„æ ‡ç­¾ä¹Ÿéœ€è¦åŒ¹é…ç»™å®šçš„å€¼ã€‚</li>
<li><code>self.from_intent(intent=intent_name, value=value)</code> å°†å¡«è¡¥ç¼éš™<code>slot_name</code>ç”¨<code>value</code>ï¼Œå¦‚æœç”¨æˆ·æ„å›¾<code>intent_name</code>ã€‚è¦åˆ›å»ºä¸€ä¸ªå¸ƒå°”å‹æ’æ§½ï¼Œè¯·çœ‹<code>outdoor_seating</code> ä¸Šé¢çš„å®šä¹‰ã€‚æ³¨æ„ï¼šæ’æ§½ä¸ä¼šå¡«å……è§¦å‘è¡¨å•æ“ä½œçš„æ¶ˆæ¯çš„ç”¨æˆ·æ„å›¾ã€‚<code>self.from_trigger_intent</code>åœ¨ä¸‹é¢ä½¿ç”¨ã€‚</li>
<li><code>self.from_trigger_intent(intent=intent_name, value=value)</code> å°†å¡«è¡¥ç¼éš™<code>slot_name</code>ç”¨<code>value</code>ï¼Œå¦‚æœå½¢å¼ä¸ç”¨æˆ·æ„å›¾è§¦å‘<code>intent_name</code>ã€‚</li>
<li><code>self.from_text(intent=intent_name)</code>å°†ä½¿ç”¨ä¸‹ä¸€ä¸ªä½¿ç”¨è€…è¯´è¯å¡«å†™æ–‡æœ¬æ’æ§½<code>slot_name</code>ï¼Œæ— è®ºç”¨æˆ·çš„æ„å›¾ï¼Œå¦‚æœ<code>intent_name</code>æ˜¯<code>None</code>å…¶ä»–äººåªæœ‰å½“ç”¨æˆ·æ„å›¾<code>intent_name</code>ã€‚</li>
<li>å¦‚æœè¦å…è®¸è¿™äº›ç»„åˆï¼Œè¯·åƒä¸Šé¢çš„ç¤ºä¾‹ä¸€æ ·å°†å®ƒä»¬æä¾›ä¸ºåˆ—è¡¨ã€‚</li>
</ul>
<h3 id="éªŒè¯ç”¨æˆ·è¾“å…¥"><a href="#éªŒè¯ç”¨æˆ·è¾“å…¥" class="headerlink" title="éªŒè¯ç”¨æˆ·è¾“å…¥"></a>éªŒè¯ç”¨æˆ·è¾“å…¥</h3><p>ä»ç”¨æˆ·è¾“å…¥ä¸­æå–å¹¿å‘Šä½å€¼åï¼Œè¡¨å•å°†å°è¯•éªŒè¯å¹¿å‘Šä½çš„å€¼ã€‚è¯·æ³¨æ„ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œä»…åœ¨ç”¨æˆ·è¾“å…¥åç«‹å³æ‰§è¡Œè¡¨å•æ“ä½œæ—¶æ‰è¿›è¡ŒéªŒè¯ã€‚å¯ä»¥åœ¨Rasa SDK<code>_validate_if_required()</code>ä¸­çš„<code>FormAction</code>ç±»çš„å‡½æ•°ä¸­å¯¹æ­¤è¿›è¡Œæ›´æ”¹ ã€‚æ¿€æ´»è¡¨å•åï¼Œè¿˜å°†éªŒè¯åœ¨è¡¨å•åˆæ¬¡æ¿€æ´»ä¹‹å‰å¡«å†™çš„æ‰€æœ‰å¿…éœ€æ’æ§½ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒéªŒè¯ä»…æ£€æŸ¥è¯·æ±‚çš„æ’æ§½æ˜¯å¦æˆåŠŸä»æ’æ§½æ˜ å°„ä¸­æå–ã€‚å¦‚æœè¦æ·»åŠ è‡ªå®šä¹‰éªŒè¯ï¼ˆä¾‹å¦‚ï¼Œé’ˆå¯¹æ•°æ®åº“æ£€æŸ¥å€¼ï¼‰ï¼Œå¯ä»¥é€šè¿‡ç¼–å†™åç§°ä¸ºhelperçš„éªŒè¯å‡½æ•°æ¥å®ç°<code>validate_{slot-name}</code>ã€‚</p>
<p>è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œè¯¥ç¤ºä¾‹<code>validate_cuisine()</code>æ£€æŸ¥æå–çš„ç¾é£Ÿæ’æ§½æ˜¯å¦å±äºå—æ”¯æŒç¾é£Ÿåˆ—è¡¨ã€‚</p>
<pre class=" language-python"><code class="language-python">    @staticmethod
    <span class="token keyword">def</span> <span class="token function">cuisine_db</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> List<span class="token punctuation">[</span>Text<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Database of supported cuisines"""</span>

        <span class="token keyword">return</span> <span class="token punctuation">[</span>
            <span class="token string">"caribbean"</span><span class="token punctuation">,</span>
            <span class="token string">"chinese"</span><span class="token punctuation">,</span>
            <span class="token string">"french"</span><span class="token punctuation">,</span>
            <span class="token string">"greek"</span><span class="token punctuation">,</span>
            <span class="token string">"indian"</span><span class="token punctuation">,</span>
            <span class="token string">"italian"</span><span class="token punctuation">,</span>
            <span class="token string">"mexican"</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token keyword">def</span> <span class="token function">validate_cuisine</span><span class="token punctuation">(</span>
        self<span class="token punctuation">,</span>
        value<span class="token punctuation">:</span> Text<span class="token punctuation">,</span>
        dispatcher<span class="token punctuation">:</span> CollectingDispatcher<span class="token punctuation">,</span>
        tracker<span class="token punctuation">:</span> Tracker<span class="token punctuation">,</span>
        domain<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span>Text<span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Dict<span class="token punctuation">[</span>Text<span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Validate cuisine value."""</span>

        <span class="token keyword">if</span> value<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>cuisine_db<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment" spellcheck="true"># validation succeeded, set the value of the "cuisine" slot to value</span>
            <span class="token keyword">return</span> <span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;"cuisine": value&amp;#125;</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            dispatcher<span class="token punctuation">.</span>utter_message<span class="token punctuation">(</span>template<span class="token operator">=</span><span class="token string">"utter_wrong_cuisine"</span><span class="token punctuation">)</span>
            <span class="token comment" spellcheck="true"># validation failed, set this slot to None, meaning the</span>
            <span class="token comment" spellcheck="true"># user will be asked for the slot again</span>
            <span class="token keyword">return</span> <span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;"cuisine": None&amp;#125;</span></code></pre>
<p>å½“å¸®åŠ©ç¨‹åºéªŒè¯åŠŸèƒ½è¿”å›è¦è®¾ç½®çš„æ’æ§½åç§°å’Œå€¼çš„å­—å…¸æ—¶ï¼Œæ‚¨å¯ä»¥è®¾ç½®çš„æ’æ§½æ¯”åœ¨å¸®åŠ©ç¨‹åºéªŒè¯æ–¹æ³•ä¸­è¦éªŒè¯çš„æ’æ§½è¦å¤šã€‚ä½†æ˜¯ï¼Œæ‚¨æœ‰è´£ä»»ç¡®ä¿è¿™äº›é¢å¤–çš„æ’æ§½å€¼æœ‰æ•ˆã€‚</p>
<p>å¦‚æœæ’æ§½ä¸­å……æ»¡äº†æ‚¨ç¡®å®šæ— æ³•å¤„ç†çš„ä¸œè¥¿ï¼Œå¹¶ä¸”æ‚¨æƒ³ç›´æ¥åœç”¨è¡¨å•ï¼Œåˆ™å¯ä»¥è¦†ç›–æ­¤<code>request_next_slot()</code>æ–¹æ³•ã€‚ä¸‹é¢çš„ç¤ºä¾‹<code>cuisine</code>ç›´æ¥æ£€æŸ¥æ’æ§½çš„å€¼ï¼Œä½†æ˜¯æ‚¨å¯ä»¥ä½¿ç”¨ä»»ä½•æƒ³è¦è§¦å‘åœç”¨çš„é€»è¾‘ï¼š</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">request_next_slot</span><span class="token punctuation">(</span>
    self<span class="token punctuation">,</span>
    dispatcher<span class="token punctuation">:</span> <span class="token string">"CollectingDispatcher"</span><span class="token punctuation">,</span>
    tracker<span class="token punctuation">:</span> <span class="token string">"Tracker"</span><span class="token punctuation">,</span>
    domain<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span>Text<span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Optional<span class="token punctuation">[</span>List<span class="token punctuation">[</span>EventType<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Request the next slot and utter template if needed,
        else return None"""</span>
    <span class="token keyword">for</span> slot <span class="token keyword">in</span> self<span class="token punctuation">.</span>required_slots<span class="token punctuation">(</span>tracker<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>_should_request_slot<span class="token punctuation">(</span>tracker<span class="token punctuation">,</span> slot<span class="token punctuation">)</span><span class="token punctuation">:</span>

            <span class="token comment" spellcheck="true">## Condition of validated slot that triggers deactivation</span>
            <span class="token keyword">if</span> slot <span class="token operator">==</span> <span class="token string">"cuisine"</span> <span class="token operator">and</span> tracker<span class="token punctuation">.</span>get_slot<span class="token punctuation">(</span><span class="token string">"cuisine"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"caribbean"</span><span class="token punctuation">:</span>
                dispatcher<span class="token punctuation">.</span>utter_message<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">"Sorry, I can't help you with that"</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> self<span class="token punctuation">.</span>deactivate<span class="token punctuation">(</span><span class="token punctuation">)</span>

            <span class="token comment" spellcheck="true">## For all other slots, continue as usual</span>
            logger<span class="token punctuation">.</span>debug<span class="token punctuation">(</span>f<span class="token string">"Request next slot '&amp;#123;slot&amp;#125;'"</span><span class="token punctuation">)</span>
            dispatcher<span class="token punctuation">.</span>utter_message<span class="token punctuation">(</span>
                template<span class="token operator">=</span>f<span class="token string">"utter_ask_&amp;#123;slot&amp;#125;"</span><span class="token punctuation">,</span> <span class="token operator">**</span>tracker<span class="token punctuation">.</span>slots
            <span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token punctuation">[</span>SlotSet<span class="token punctuation">(</span>REQUESTED_SLOT<span class="token punctuation">,</span> slot<span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> None</code></pre>
<p>å¦‚æœå¯¹äºä»»ä½•æ‰€éœ€çš„æ—¶é—´æ®µï¼Œä»ç”¨æˆ·çš„å‘è¨€ä¸­æœªæå–ä»»ä½•å†…å®¹ï¼Œ <code>ActionExecutionRejection</code>åˆ™ä¼šå¼•å‘é”™è¯¯ï¼Œè¿™æ„å‘³ç€æ“ä½œæ‰§è¡Œè¢«æ‹’ç»ï¼Œå› æ­¤Coreå°†é€€å›åˆ°å…¶ä»–ç­–ç•¥ä¸Šä»¥é¢„æµ‹å…¶ä»–æ“ä½œã€‚</p>
<h3 id="å¤„ç†ä¸æ„‰å¿«è·¯å¾„"><a href="#å¤„ç†ä¸æ„‰å¿«è·¯å¾„" class="headerlink" title="å¤„ç†ä¸æ„‰å¿«è·¯å¾„"></a>å¤„ç†ä¸æ„‰å¿«è·¯å¾„</h3><p>å½“ç„¶ï¼Œæ‚¨çš„ç”¨æˆ·å°†ä¸ä¼šæ€»æ˜¯ç”¨æ‚¨è¦æ±‚ä»–ä»¬æä¾›çš„ä¿¡æ¯æ¥å›åº”ã€‚é€šå¸¸ï¼Œç”¨æˆ·ä¼šé—®é—®é¢˜ï¼Œæ‰“æ‹›å‘¼ï¼Œæ”¹å˜ä¸»æ„æˆ–ä»¥å…¶ä»–æ–¹å¼åç¦»å¹¸ç¦çš„é“è·¯ã€‚è¡¨å•çš„å·¥ä½œæ–¹å¼æ˜¯ï¼Œ<code>ActionExecutionRejection</code>å¦‚æœç”¨æˆ·æœªæä¾›æ‰€è¯·æ±‚çš„ä¿¡æ¯ï¼Œè¡¨å•å°†å¼•å‘ã€‚æ‚¨éœ€è¦å¤„ç†å¯èƒ½å¯¼è‡´<code>ActionExecutionRejection</code>æ•…äº‹å‡ºé”™çš„äº‹ä»¶ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨å¸Œæœ›æ‚¨çš„ç”¨æˆ·é€‰æ‹©ä¸æ‚¨çš„æœºå™¨äººèŠå¤©ï¼Œåˆ™å¯ä»¥æ·»åŠ å¦‚ä¸‹æ•…äº‹ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">##</span> chitchat</span>
<span class="token list punctuation">*</span> request_restaurant
<span class="token code keyword">    - restaurant_form</span>
<span class="token code keyword">    - form&amp;#123;"name": "restaurant_form"&amp;#125;</span>
<span class="token list punctuation">*</span> chitchat
<span class="token code keyword">    - utter_chitchat</span>
<span class="token code keyword">    - restaurant_form</span>
<span class="token code keyword">    - form&amp;#123;"name": null&amp;#125;</span></code></pre>
<p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç”¨æˆ·å¯èƒ½ä¼šåœ¨è¡¨å•æ“ä½œè¿‡ç¨‹ä¸­æ”¹å˜ä¸»æ„ï¼Œå¹¶å†³å®šä¸ç»§ç»­å…¶æœ€åˆçš„è¯·æ±‚ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒåŠ©æ‰‹åº”åœæ­¢è¯¢é—®æ‰€è¯·æ±‚çš„æ—¶æ®µã€‚æ‚¨å¯ä»¥ä½¿ç”¨é»˜è®¤æ“ä½œ<code>action_deactivate_form</code>æ¥ä¼˜é›…åœ°å¤„ç†æ­¤ç±»æƒ…å†µï¼Œè¯¥æ“ä½œå°†åœç”¨è¡¨å•å¹¶é‡ç½®è¯·æ±‚çš„æ’æ§½ã€‚æ­¤ç±»å¯¹è¯çš„ä¸€ä¸ªç¤ºä¾‹æ•…äº‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">##</span> chitchat</span>
<span class="token list punctuation">*</span> request_restaurant
<span class="token code keyword">    - restaurant_form</span>
<span class="token code keyword">    - form&amp;#123;"name": "restaurant_form"&amp;#125;</span>
<span class="token list punctuation">*</span> stop
<span class="token code keyword">    - utter_ask_continue</span>
<span class="token list punctuation">*</span> deny
<span class="token code keyword">    - action_deactivate_form</span>
<span class="token code keyword">    - form&amp;#123;"name": null&amp;#125;</span></code></pre>
<p>è¿™æ˜¯<strong>å¼ºçƒˆ</strong>å»ºè®®ä½ å»ºç«‹ä¸€ä¸ªä½¿ç”¨äº¤äº’å¼å­¦ä¹ è¿™äº›æ•…äº‹ã€‚å¦‚æœæ‚¨ç”¨æ‰‹å†™è¿™äº›æ•…äº‹ï¼Œæ‚¨å¯èƒ½ä¼šé”™è¿‡é‡è¦çš„äº‹æƒ…ã€‚è¯·é˜…è¯»â€œ<a href="#">é€šè¿‡è¡¨å•</a> è¿›è¡Œ<a href="#">äº¤äº’å¼å­¦ä¹ â€ï¼Œ</a>ä»¥äº†è§£å¦‚ä½•åœ¨<a href="#">è¡¨å•</a>ä¸­ä½¿ç”¨äº¤äº’å¼å­¦ä¹ ã€‚</p>
<h3 id="request-slotæ§½ä½"><a href="#request-slotæ§½ä½" class="headerlink" title="request_slotæ§½ä½"></a>request_slotæ§½ä½</h3><p>è¯¥æ’æ§½<code>requested_slot</code>å°†ä½œä¸ºæœªå®Œæˆçš„æ’æ§½è‡ªåŠ¨æ·»åŠ åˆ°åŸŸä¸­ã€‚å¦‚æœè¦ä½¿å…¶å…·æœ‰ç‰¹è‰²ï¼Œåˆ™éœ€è¦å°†å…¶ä½œä¸ºåˆ†ç±»æ’æ§½æ·»åŠ åˆ°åŸŸæ–‡ä»¶ä¸­ã€‚å¦‚æœè¦æ ¹æ®ç”¨æˆ·å½“å‰è¦æ±‚çš„æ’æ§½æ¥ä¸åŒåœ°å¤„ç†ä¸æ„‰å¿«çš„è·¯å¾„ï¼Œåˆ™å¯èƒ½éœ€è¦æ‰§è¡Œæ­¤æ“ä½œã€‚ä¾‹å¦‚ï¼Œå‡è®¾æ‚¨çš„ç”¨æˆ·ç”¨å¦ä¸€ä¸ªé—®é¢˜å›ç­”äº†æœºå™¨äººçš„ä¸€ä¸ªé—®é¢˜ï¼Œä¾‹å¦‚<em>æ‚¨ä¸ºä»€ä¹ˆéœ€è¦çŸ¥é“è¿™ä¸€ç‚¹ï¼Ÿ</em> å¯¹è¿™ä¸€<code>explain</code>æ„å›¾çš„ååº”å–å†³äºæˆ‘ä»¬åœ¨æ•…äº‹ä¸­æ‰€å¤„çš„ä½ç½®ã€‚åœ¨é¤å…çš„æƒ…å†µä¸‹ï¼Œæ‚¨çš„æ•…äº‹å°†å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">##</span> explain cuisine slot</span>
<span class="token list punctuation">*</span> request_restaurant
<span class="token code keyword">    - restaurant_form</span>
<span class="token code keyword">    - form&amp;#123;"name": "restaurant_form"&amp;#125;</span>
<span class="token code keyword">    - slot&amp;#123;"requested_slot": "cuisine"&amp;#125;</span>
<span class="token list punctuation">*</span> explain
<span class="token code keyword">    - utter_explain_cuisine</span>
<span class="token code keyword">    - restaurant_form</span>
<span class="token code keyword">    - slot&amp;#123;"cuisine": "greek"&amp;#125;</span>
<span class="token code keyword">    ( ... all other slots the form set ... )</span>
<span class="token code keyword">    - form&amp;#123;"name": null&amp;#125;</span>

<span class="token title important"><span class="token punctuation">##</span> explain num_people slot</span>
<span class="token list punctuation">*</span> request_restaurant
<span class="token code keyword">    - restaurant_form</span>
<span class="token code keyword">    - form&amp;#123;"name": "restaurant_form"&amp;#125;</span>
<span class="token code keyword">    - slot&amp;#123;"requested_slot": "num_people"&amp;#125;</span>
<span class="token list punctuation">*</span> explain
<span class="token code keyword">    - utter_explain_num_people</span>
<span class="token code keyword">    - restaurant_form</span>
<span class="token code keyword">    - slot&amp;#123;"cuisine": "greek"&amp;#125;</span>
<span class="token code keyword">    ( ... all other slots the form set ... )</span>
<span class="token code keyword">    - form&amp;#123;"name": null&amp;#125;</span></code></pre>
<p>åŒæ ·ï¼Œ<strong>å¼ºçƒˆ</strong>å»ºè®®æ‚¨ä½¿ç”¨äº¤äº’å¼å­¦ä¹ æ¥æ„å»ºè¿™äº›æ•…äº‹ã€‚è¯·é˜…è¯»â€œ<a href="#">é€šè¿‡è¡¨å•</a> è¿›è¡Œ<a href="#">äº¤äº’å¼å­¦ä¹ â€ï¼Œ</a>ä»¥äº†è§£å¦‚ä½•åœ¨<a href="#">è¡¨å•</a>ä¸­ä½¿ç”¨äº¤äº’å¼å­¦ä¹ ã€‚</p>
<h3 id="å¤„ç†æ¡ä»¶æ—¶éš™é€»è¾‘"><a href="#å¤„ç†æ¡ä»¶æ—¶éš™é€»è¾‘" class="headerlink" title="å¤„ç†æ¡ä»¶æ—¶éš™é€»è¾‘"></a>å¤„ç†æ¡ä»¶æ—¶éš™é€»è¾‘</h3><p>é™¤äº†è¯·æ±‚å­—æ®µåˆ—è¡¨ä¹‹å¤–ï¼Œè®¸å¤šè¡¨å•è¿˜éœ€è¦æ›´å¤šçš„é€»è¾‘ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæœ‰äººè¦æ±‚<code>greek</code>ä½œä¸ºä»–ä»¬çš„èœï¼Œæ‚¨å¯èƒ½æƒ³é—®ä»–ä»¬æ˜¯å¦æ­£åœ¨å¯»æ‰¾å¸¦æˆ·å¤–åº§ä½çš„åœ°æ–¹ã€‚</p>
<p>æ‚¨å¯ä»¥é€šè¿‡å°†ä¸€äº›é€»è¾‘å†™å…¥<code>required_slots()</code>æ–¹æ³•æ¥å®ç°æ­¤ç›®çš„ï¼Œä¾‹å¦‚ï¼š</p>
<pre class=" language-python"><code class="language-python">@staticmethod
<span class="token keyword">def</span> <span class="token function">required_slots</span><span class="token punctuation">(</span>tracker<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> List<span class="token punctuation">[</span>Text<span class="token punctuation">]</span><span class="token punctuation">:</span>
   <span class="token triple-quoted-string string">"""A list of required slots that the form has to fill"""</span>

   <span class="token keyword">if</span> tracker<span class="token punctuation">.</span>get_slot<span class="token punctuation">(</span><span class="token string">'cuisine'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'greek'</span><span class="token punctuation">:</span>
     <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">"cuisine"</span><span class="token punctuation">,</span> <span class="token string">"num_people"</span><span class="token punctuation">,</span> <span class="token string">"outdoor_seating"</span><span class="token punctuation">,</span>
             <span class="token string">"preferences"</span><span class="token punctuation">,</span> <span class="token string">"feedback"</span><span class="token punctuation">]</span>
   <span class="token keyword">else</span><span class="token punctuation">:</span>
     <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">"cuisine"</span><span class="token punctuation">,</span> <span class="token string">"num_people"</span><span class="token punctuation">,</span>
             <span class="token string">"preferences"</span><span class="token punctuation">,</span> <span class="token string">"feedback"</span><span class="token punctuation">]</span></code></pre>
<p>è¿™ç§æœºåˆ¶éå¸¸é€šç”¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å®ƒåœ¨è¡¨å•ä¸­æ„å»ºè®¸å¤šä¸åŒç§ç±»çš„é€»è¾‘ã€‚</p>
<h3 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h3><p>é¦–å…ˆå°è¯•ç”¨<code>--debug</code>æ ‡å¿—è¿è¡Œæ‚¨çš„æœºå™¨äººï¼Œæœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§<a href="#">å‘½ä»¤è¡Œç•Œé¢</a>ã€‚å¦‚æœæ‚¨åªæ˜¯å…¥é—¨ï¼Œåˆ™å¯èƒ½åªæœ‰å‡ ä¸ªæ‰‹å†™çš„æ•…äº‹ã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ï¼Œä½†ä½ åº”è¯¥ç»™ä½ çš„æœºå™¨äººç»™äººä»¥æµ‹è¯•<strong>å°½å¿«</strong>ã€‚Rasa Coreçš„æŒ‡å¯¼åŸåˆ™ä¹‹ä¸€æ˜¯ï¼š</p>
<p>â€‹       ä»çœŸå®çš„å¯¹è¯ä¸­å­¦ä¹ æ¯”è®¾è®¡å‡è®¾çš„å¯¹è¯æ›´ä¸ºé‡è¦</p>
<p>å› æ­¤ï¼Œåœ¨å°†å…¶æä¾›ç»™æµ‹è¯•äººå‘˜ä¹‹å‰ï¼Œè¯·å‹¿å°è¯•è¦†ç›–æ‰‹å†™æ•…äº‹ä¸­çš„æ‰€æœ‰å¯èƒ½æ€§ã€‚çœŸå®çš„ç”¨æˆ·è¡Œä¸ºå°†æ°¸è¿œè®©æ‚¨æ„Ÿåˆ°æƒŠè®¶ï¼</p>
<h2 id="æ£€ç´¢æ“ä½œ-1"><a href="#æ£€ç´¢æ“ä½œ-1" class="headerlink" title="æ£€ç´¢æ“ä½œ"></a>æ£€ç´¢æ“ä½œ</h2><blockquote>
<p>è­¦å‘Š</p>
<p>æ­¤åŠŸèƒ½æ˜¯å®éªŒæ€§çš„ã€‚æˆ‘ä»¬å¼•å…¥å®éªŒæ€§åŠŸèƒ½ä»¥è·å–ç¤¾åŒºçš„åé¦ˆï¼Œå› æ­¤æˆ‘ä»¬é¼“åŠ±æ‚¨å°è¯•ä¸€ä¸‹ï¼ä½†æ˜¯ï¼Œå°†æ¥å¯èƒ½ä¼šæ›´æ”¹æˆ–åˆ é™¤åŠŸèƒ½ã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•åé¦ˆï¼ˆæ­£é¢æˆ–è´Ÿé¢ï¼‰ï¼Œè¯·åœ¨<a target="_blank" rel="noopener" href="https://forum.rasa.com/">è®ºå›</a>ä¸Šä¸æˆ‘ä»¬åˆ†äº«ã€‚å¦å¤–ï¼Œå¦‚æœæ‚¨çš„è®­ç»ƒæ•°æ®åŒ…å«æ£€ç´¢åŠ¨ä½œï¼Œå½“å‰æˆ‘ä»¬ä¸æ”¯æŒåœ¨Rasa Xä¸­æ·»åŠ æ–°çš„æ³¨é‡Šã€‚ä¸€æ—¦æ”¶é›†åˆ°è¶³å¤Ÿçš„åé¦ˆå¹¶ä¸”å¯¹åŸ¹è®­æ•°æ®æ ¼å¼æ„Ÿåˆ°æ»¡æ„ï¼Œæˆ‘ä»¬å°†åœ¨Rasa Xä¸­æ·»åŠ å¯¹åŸ¹è®­å“åº”æ£€ç´¢æ¨¡å‹çš„æ”¯æŒã€‚</p>
</blockquote>
<blockquote>
<p>æ³¨æ„</p>
<p>è¿™é‡Œæœ‰ä¸€ç¯‡æ·±å…¥çš„åšå®¢æ–‡ç« <a target="_blank" rel="noopener" href="https://blog.rasa.com/response-retrieval-models/">ï¼Œ</a>ä»‹ç»å¦‚ä½•ä½¿ç”¨æ£€ç´¢åŠ¨ä½œæ¥å¤„ç†å•å›åˆäº’åŠ¨ã€‚</p>
</blockquote>
<ul>
<li><a href="#">å…³äº</a></li>
<li><a href="#">è®­ç»ƒæ•°æ®</a></li>
<li><a href="#">é…ç½®æ–‡ä»¶</a></li>
<li><a href="#">åŸŸ</a></li>
<li><a href="#">å¤šä¸ªæ£€ç´¢åŠ¨ä½œ</a></li>
<li><a href="#">è§£æå“åº”é€‰æ‹©å™¨è¾“å‡º</a></li>
</ul>
<h3 id="å…³äº"><a href="#å…³äº" class="headerlink" title="å…³äº"></a>å…³äº</h3><p>æ£€ç´¢åŠ¨ä½œæ—¨åœ¨ç®€åŒ–ä½¿ç”¨<a target="_blank" rel="noopener" href="https://legacy-docs-v1.rasa.com/dialogue-elements/small-talk/#small-talk">é—²èŠ</a>å’Œ<a target="_blank" rel="noopener" href="https://legacy-docs-v1.rasa.com/dialogue-elements/completing-tasks/#simple-questions">ç®€å•é—®é¢˜çš„å·¥ä½œ</a>ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çš„åŠ©æ‰‹å¯ä»¥å¤„ç†100ä¸ªFAQå’Œ50ä¸ªä¸åŒçš„é—²èŠæ„å›¾ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ£€ç´¢æ“ä½œæ¥è¦†ç›–æ‰€æœ‰è¿™äº›å†…å®¹ã€‚ä»å¯¹è¯çš„è§’åº¦æ¥çœ‹ï¼Œè¿™äº›å•å›åˆçš„äº¤æµéƒ½å¯ä»¥å¾—åˆ°åŒç­‰å¯¹å¾…ï¼Œå› æ­¤å¯ä»¥ç®€åŒ–æ‚¨çš„æ•…äº‹ã€‚</p>
<p>è€Œä¸æ˜¯åƒè¿™æ ·çš„å¾ˆå¤šæ•…äº‹ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">##</span> weather</span>
<span class="token list punctuation">*</span> ask_weather
   <span class="token list punctuation">-</span> utter<span class="token italic"><span class="token punctuation">_</span>ask<span class="token punctuation">_</span></span>weather

<span class="token title important"><span class="token punctuation">##</span> introduction</span>
<span class="token list punctuation">*</span> ask_name
   <span class="token list punctuation">-</span> utter<span class="token italic"><span class="token punctuation">_</span>introduce<span class="token punctuation">_</span></span>myself

...</code></pre>
<p>æ‚¨å¯ä»¥é€šè¿‡ä¸€ä¸ªæ•…äº‹æ¥æ¶µç›–æ‰€æœ‰è¿™äº›å†…å®¹ï¼Œå…¶ä¸­ä¸Šè¿°æ„å›¾å½’ä¸ºä¸€ä¸ªå…±åŒçš„<code>chitchat</code>æ„å›¾ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">##</span> chitchat</span>
<span class="token list punctuation">*</span> chitchat
   <span class="token list punctuation">-</span> respond_chitchat</code></pre>
<p>æ£€ç´¢åŠ¨ä½œä½¿ç”¨NLUçš„<a href="#">ResponseSelector</a>ç»„ä»¶çš„è¾“å‡ºï¼Œè¯¥ç»„ä»¶å­¦ä¹ æ£€ç´¢æ¨¡å‹ä»¥ä»ç»™å®šç”¨æˆ·æ¶ˆæ¯æ–‡æœ¬çš„å€™é€‰å“åº”åˆ—è¡¨ä¸­é¢„æµ‹æ­£ç¡®çš„å“åº”ã€‚</p>
<h3 id="è®­ç»ƒæ•°æ®"><a href="#è®­ç»ƒæ•°æ®" class="headerlink" title="è®­ç»ƒæ•°æ®"></a>è®­ç»ƒæ•°æ®</h3><p>é¡¾åæ€ä¹‰ï¼Œæ£€ç´¢åŠ¨ä½œå°†å­¦ä¹ ä»å€™é€‰åˆ—è¡¨ä¸­é€‰æ‹©æ­£ç¡®çš„ç­”æ¡ˆã€‚ä¸å…¶ä»–NLUæ•°æ®ä¸€æ ·ï¼Œæ‚¨éœ€è¦åœ¨ç”¨æˆ·çš„NLUæ–‡ä»¶ä¸­åŒ…æ‹¬ä¸€äº›ç¤ºä¾‹ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">##</span> intent: chitchat/ask_name</span>
<span class="token list punctuation">-</span> what's your name
<span class="token list punctuation">-</span> who are you?
<span class="token list punctuation">-</span> what are you called?

<span class="token title important"><span class="token punctuation">##</span> intent: chitchat/ask_weather</span>
<span class="token list punctuation">-</span> how's weather?
<span class="token list punctuation">-</span> is it sunny where you are?</code></pre>
<p>é¦–å…ˆï¼Œæ‰€æœ‰è¿™äº›ç¤ºä¾‹éƒ½å°†åˆå¹¶ä¸º<code>chitchat</code>NLUå°†é¢„æµ‹çš„å•ä¸ªæ£€ç´¢æ„å›¾ã€‚åœ¨ä¸Šé¢çš„ç¤ºä¾‹-<code>ask_name</code>å’Œä¸­ï¼Œæ‰€æœ‰æ£€ç´¢æ„å›¾éƒ½æœ‰ä¸€ä¸ªåç¼€ï¼Œè¯¥åç¼€æ ‡è¯†äº†æ‚¨åŠ©æ‰‹çš„ç‰¹å®šå“åº”æ–‡æœ¬<code>ask_weather</code>ã€‚åç¼€ç”±<code>/</code>å®šç•Œç¬¦ä¸æ„å›¾åç§°åˆ†éš”</p>
<p>æ¥ä¸‹æ¥ï¼Œå°†æ‰€æœ‰æ£€ç´¢æ„å›¾çš„å“åº”æ–‡æœ¬åŒ…å«åœ¨<strong>å•ç‹¬çš„</strong>è®­ç»ƒæ•°æ®æ–‡ä»¶ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤º<code>responses.md</code>ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">##</span> ask name</span>
<span class="token list punctuation">*</span> chitchat/ask_name
<span class="token code keyword">    - my name is Sara, Rasa's documentation bot!</span>

<span class="token title important"><span class="token punctuation">##</span> ask weather</span>
<span class="token list punctuation">*</span> chitchat/ask_weather
<span class="token code keyword">    - it's always sunny where I live</span></code></pre>
<p>æ£€ç´¢æ¨¡å‹ä½œä¸ºNLUè®­ç»ƒæµæ°´çº¿çš„ä¸€éƒ¨åˆ†è¿›è¡Œå•ç‹¬è®­ç»ƒï¼Œä»¥é€‰æ‹©æ­£ç¡®çš„å“åº”ã€‚è¦è®°ä½çš„é‡è¦ä¸€ä»¶äº‹æ˜¯ï¼Œæ£€ç´¢æ¨¡å‹ä½¿ç”¨å“åº”æ¶ˆæ¯çš„æ–‡æœ¬æ¥é€‰æ‹©æ­£ç¡®çš„æ¶ˆæ¯ã€‚å¦‚æœæ›´æ”¹è¿™äº›å“åº”çš„æ–‡æœ¬ï¼Œåˆ™å¿…é¡»é‡æ–°è®­ç»ƒæ‚¨çš„æ£€ç´¢æ¨¡å‹ï¼è¿™æ˜¯æ‚¨åŸŸæ–‡ä»¶ä¸­å“åº”æ¨¡æ¿çš„ä¸»è¦åŒºåˆ«ã€‚</p>
<blockquote>
<p>æ³¨æ„</p>
<p>åŒ…å«å“åº”æ–‡æœ¬çš„æ–‡ä»¶å¿…é¡»ä½œä¸ºå•ç‹¬çš„æ–‡ä»¶å­˜åœ¨äºä¼ é€’ç»™è®­ç»ƒè¿‡ç¨‹çš„è®­ç»ƒæ•°æ®ç›®å½•ä¸­ã€‚å®ƒçš„å†…å®¹ä¸èƒ½æ˜¯åŒ…å«NLUå…¶ä»–ç»„ä»¶çš„è®­ç»ƒæ•°æ®çš„æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ã€‚</p>
</blockquote>
<blockquote>
<p>æ³¨æ„</p>
<p>å¦‚ä»¥ä¸Šç¤ºä¾‹æ‰€ç¤ºï¼Œ<code>/</code>ä¿ç•™ç¬¦å·ä½œä¸ºåˆ†éš”ç¬¦ï¼Œä»¥å°†æ£€ç´¢æ„å›¾ä¸å“åº”æ–‡æœ¬æ ‡è¯†ç¬¦åˆ†å¼€ã€‚ç¡®ä¿ä¸è¦ä»¥æ‚¨çš„æ„å›¾çš„åä¹‰ä½¿ç”¨å®ƒã€‚</p>
</blockquote>
<h3 id="é…ç½®æ–‡ä»¶-1"><a href="#é…ç½®æ–‡ä»¶-1" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h3><p>æ‚¨éœ€è¦åœ¨é…ç½®ä¸­åŒ…æ‹¬<a href="#">ResponseSelector</a>ç»„ä»¶ã€‚è¯¥ç»„ä»¶éœ€è¦æ ‡è®°å™¨ï¼ŒåŠŸèƒ½åŒ–å™¨å’Œæ„å›¾åˆ†ç±»å™¨æ‰èƒ½å¯¹ç”¨æˆ·æ¶ˆæ¯è¿›è¡Œæ“ä½œï¼Œç„¶åæ‰èƒ½é¢„æµ‹å“åº”ï¼Œå› æ­¤åº”å°†è¿™äº›ç»„ä»¶æ”¾åœ¨<code>ResponseSelector</code>NLUé…ç½®ä¸­ã€‚ä¸€ä¸ªä¾‹å­ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">language: "en"

pipeline:
<span class="token list punctuation">-</span> name: "WhitespaceTokenizer"
  intent<span class="token italic"><span class="token punctuation">_</span>split<span class="token punctuation">_</span></span>symbol: "_"
<span class="token list punctuation">-</span> name: "CountVectorsFeaturizer"
<span class="token list punctuation">-</span> name: "EmbeddingIntentClassifier"
<span class="token list punctuation">-</span> name: "ResponseSelector"</code></pre>
<h3 id="Domain-1"><a href="#Domain-1" class="headerlink" title="Domain"></a>Domain</h3><p>Rasaä½¿ç”¨å‘½åçº¦å®šå°†æ„å›¾åç§°<code>chitchat/ask_name</code> ä¸æ£€ç´¢åŠ¨ä½œè¿›è¡ŒåŒ¹é…ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ­£ç¡®çš„æ“ä½œåç§°æ˜¯<code>respond_chitchat</code>ã€‚å‰ç¼€<code>respond_</code>æ˜¯å¼ºåˆ¶æ€§çš„ï¼Œä»¥å°†å…¶æ ‡è¯†ä¸ºæ£€ç´¢åŠ¨ä½œã€‚å¦ä¸€ä¸ªç¤ºä¾‹-æ­£ç¡®çš„æ“ä½œåç§°<code>faq/ask_policy</code>å°†æ˜¯<code>respond_faq</code> è¦å°†å…¶åŒ…æ‹¬åœ¨æ‚¨çš„åŸŸä¸­ï¼Œè¯·å°†å…¶æ·»åŠ åˆ°æ“ä½œåˆ—è¡¨ä¸­ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">actions:
  ...
  <span class="token list punctuation">-</span> respond_chitchat
  <span class="token list punctuation">-</span> respond_faq</code></pre>
<p>ç¡®ä¿åœ¨é€‰æ‹©æ„å›¾åå¯ä»¥é¢„æµ‹æ£€ç´¢åŠ¨ä½œçš„ä¸€ç§ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨â€œ<a href="#">æ˜ å°„ç­–ç•¥â€</a>ã€‚ä½†æ˜¯ï¼Œæ‚¨ä¹Ÿå¯ä»¥åœ¨æ‚¨çš„æ•…äº‹ä¸­åŒ…æ‹¬æ­¤æ“ä½œã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æƒ³åœ¨å¤„ç†chitchatä¹‹åé‡å¤ä¸€ä¸ªé—®é¢˜ï¼ˆè¯·å‚é˜…<a href="#">ä¸å¿«ä¹çš„è·¯å¾„</a>ï¼‰</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">##</span> interruption</span>
<span class="token list punctuation">*</span> search_restaurant
   <span class="token list punctuation">-</span> utter<span class="token italic"><span class="token punctuation">_</span>ask<span class="token punctuation">_</span></span>cuisine
<span class="token list punctuation">*</span> chitchat
   <span class="token list punctuation">-</span> respond_chitchat
   <span class="token list punctuation">-</span> utter<span class="token italic"><span class="token punctuation">_</span>ask<span class="token punctuation">_</span></span>cuisine</code></pre>
<h3 id="å¤šä¸ªæ£€ç´¢åŠ¨ä½œ"><a href="#å¤šä¸ªæ£€ç´¢åŠ¨ä½œ" class="headerlink" title="å¤šä¸ªæ£€ç´¢åŠ¨ä½œ"></a>å¤šä¸ªæ£€ç´¢åŠ¨ä½œ</h3><p>å¦‚æœæ‚¨çš„åŠ©æ‰‹åŒæ—¶åŒ…å«FAQ<strong>å’Œ</strong>chitchatï¼Œåˆ™å¯ä»¥å°†å®ƒä»¬åˆ†ä¸ºå•ç‹¬çš„æ£€ç´¢æ“ä½œï¼Œä¾‹å¦‚ï¼Œå…·æœ‰è¯¸å¦‚<code>chitchat/ask_weather</code>å’Œçš„æ„å›¾<code>faq/returns_policy</code>ã€‚Rasaæ”¯æŒæ·»åŠ å¤šä¸ª<code>RetrievalActions</code>like<code>respond_chitchat</code>å’Œ<code>respond_returns_policy</code> è‹¥è¦ä¸ºæ¯ç§ç›®çš„è®­ç»ƒå•ç‹¬çš„æ£€ç´¢æ¨¡å‹ï¼Œæ‚¨éœ€è¦<code>ResponseSelector</code> åœ¨é…ç½®ä¸­åŒ…æ‹¬ä¸€ä¸ªå•ç‹¬çš„ç»„ä»¶ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">language: "en"

pipeline:
<span class="token list punctuation">-</span> name: "WhitespaceTokenizer"
  intent<span class="token italic"><span class="token punctuation">_</span>split<span class="token punctuation">_</span></span>symbol: "_"
<span class="token list punctuation">-</span> name: "CountVectorsFeaturizer"
<span class="token list punctuation">-</span> name: "EmbeddingIntentClassifier"
<span class="token list punctuation">-</span> name: "ResponseSelector"
  retrieval_intent: chitchat
<span class="token list punctuation">-</span> name: "ResponseSelector"
  retrieval_intent: faq</code></pre>
<ul>
<li><p>æ‚¨ä»ç„¶å¯ä»¥æœ‰ä¸¤ä¸ªå•ç‹¬çš„æ£€ç´¢åŠ¨ä½œï¼Œä½†æ˜¯ä¸¤ä¸ªåŠ¨ä½œå¯ä»¥é€šè¿‡æŒ‡å®šä¸€ä¸ªæ¥å…±äº«ç›¸åŒçš„æ£€ç´¢æ¨¡å‹</p>
<p><code>ResponseSelector</code>ç»„ä»¶å¹¶å°†å…¶ä¿ç•™<code>retrieval_intent</code>ä¸ºé»˜è®¤å€¼ï¼ˆæ— ï¼‰ï¼š</p>
</li>
</ul>
<pre class=" language-markdown"><code class="language-markdown">language: "en"

pipeline:
<span class="token list punctuation">-</span> name: "WhitespaceTokenizer"
  intent<span class="token italic"><span class="token punctuation">_</span>split<span class="token punctuation">_</span></span>symbol: "_"
<span class="token list punctuation">-</span> name: "CountVectorsFeaturizer"
<span class="token list punctuation">-</span> name: "EmbeddingIntentClassifier"
<span class="token list punctuation">-</span> name: "ResponseSelector"</code></pre>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°†å¯¹æ¥è‡ªä¸¤ä¸ªç¤ºä¾‹çš„å“åº”é€‰æ‹©å™¨è¿›è¡Œè®­ç»ƒ<code>chitchat/{x}</code>ï¼Œ<code>faq/{x}</code>å¹¶<code>default</code>ä»¥NLUè§£æè¾“å‡ºçš„åç§°è¿›è¡Œæ ‡è¯†ã€‚</p>
<p>åœ¨æˆ‘ä»¬çš„å®éªŒä¸­ï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼Œå…·æœ‰ç‹¬ç«‹çš„æ£€ç´¢æ¨¡å‹å¹¶<strong>æ²¡æœ‰</strong>åšå‡ºæ£€ç´¢æ¯ä¸€ä¸ªåŠ¨ä½œçš„å‡†ç¡®æ€§ä»»ä½•åŒºåˆ«ã€‚å› æ­¤ï¼Œä¸ºç®€å•èµ·è§ï¼Œæˆ‘ä»¬å»ºè®®æ‚¨å¯¹chitchatå’ŒFAQä½¿ç”¨å•ä¸€çš„æ£€ç´¢æ¨¡å‹ã€‚å¦‚æœè·å¾—ä¸åŒçš„ç»“æœï¼Œè¯·åœ¨<a target="_blank" rel="noopener" href="https://forum.rasa.com/">è®ºå›ä¸­</a>å‘Šè¯‰æˆ‘ä»¬ï¼</p>
<h3 id="è§£æå“åº”é€‰æ‹©å™¨è¾“å‡º"><a href="#è§£æå“åº”é€‰æ‹©å™¨è¾“å‡º" class="headerlink" title="è§£æå“åº”é€‰æ‹©å™¨è¾“å‡º"></a>è§£æå“åº”é€‰æ‹©å™¨è¾“å‡º</h3><p>æ¥è‡ªNLUçš„è§£æè¾“å‡ºå°†å…·æœ‰ä¸€ä¸ªåä¸ºå±æ€§ï¼Œ<code>response_selector</code>å…¶ä¸­åŒ…å«æ¯ä¸ªå“åº”é€‰æ‹©å™¨çš„è¾“å‡ºã€‚æ¯ä¸ªå“åº”é€‰æ‹©å™¨å‡ç”±<code>retrieval_intent</code>è¯¥å“åº”é€‰æ‹©å™¨çš„å‚æ•°æ ‡è¯†ï¼Œå¹¶å­˜å‚¨ä¸¤ä¸ªå±æ€§-</p>
<ul>
<li><code>response</code>ï¼šé¢„æµ‹çš„å“åº”æ–‡æœ¬å’Œé¢„æµ‹çš„ç½®ä¿¡åº¦ã€‚</li>
<li><code>ranking</code>ï¼šä»¥åå¤§å€™é€‰ç­”æ¡ˆçš„ä¿¡å¿ƒæ’åã€‚</li>
</ul>
<p>ç»“æœç¤ºä¾‹ï¼š</p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"text"</span><span class="token operator">:</span> <span class="token string">"What is the recommend python version to install?"</span><span class="token punctuation">,</span>
    <span class="token property">"entities"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"intent"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span><span class="token property">"confidence"</span><span class="token operator">:</span> <span class="token number">0.6485910906220309</span><span class="token punctuation">,</span> <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"faq"</span>&amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"intent_ranking"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span><span class="token property">"confidence"</span><span class="token operator">:</span> <span class="token number">0.6485910906220309</span><span class="token punctuation">,</span> <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"faq"</span>&amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span><span class="token property">"confidence"</span><span class="token operator">:</span> <span class="token number">0.1416153159565678</span><span class="token punctuation">,</span> <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"greet"</span>&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"response_selector"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"faq"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"response"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span><span class="token property">"confidence"</span><span class="token operator">:</span> <span class="token number">0.7356462617</span><span class="token punctuation">,</span> <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Supports 3.5, 3.6 and 3.7, recommended version is 3.6"</span>&amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        <span class="token property">"ranking"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            &amp;#<span class="token number">123</span><span class="token punctuation">;</span><span class="token property">"confidence"</span><span class="token operator">:</span> <span class="token number">0.7356462617</span><span class="token punctuation">,</span> <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Supports 3.5, 3.6 and 3.7, recommended version is 3.6"</span>&amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
            &amp;#<span class="token number">123</span><span class="token punctuation">;</span><span class="token property">"confidence"</span><span class="token operator">:</span> <span class="token number">0.2134543431</span><span class="token punctuation">,</span> <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"You can ask me about how to get started"</span>&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        <span class="token punctuation">]</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span></code></pre>
<p>å¦‚æœå°†<code>retrieval_intent</code>ç‰¹å®šå“åº”é€‰æ‹©å™¨çš„å‚æ•°ä¿ç•™ä¸ºå…¶é»˜è®¤å€¼ï¼Œåˆ™å°†<code>default</code>åœ¨è¿”å›çš„è¾“å‡ºä¸­æ ‡è¯†ç›¸åº”çš„å“åº”é€‰æ‹©å™¨ã€‚</p>
<h2 id="äº¤äº’å­¦ä¹ "><a href="#äº¤äº’å­¦ä¹ " class="headerlink" title="äº¤äº’å­¦ä¹ "></a>äº¤äº’å­¦ä¹ </h2><p>æ­¤é¡µé¢æ˜¾ç¤ºäº†å¦‚ä½•åœ¨å‘½ä»¤è¡Œä¸Šä½¿ç”¨äº¤äº’å¼å­¦ä¹ ã€‚</p>
<p>åœ¨äº¤äº’å¼å­¦ä¹ æ¨¡å¼ä¸‹ï¼Œæ‚¨å¯ä»¥åœ¨ä¸æœºå™¨äººèŠå¤©æ—¶å‘å…¶æä¾›åé¦ˆã€‚è¿™æ˜¯æ¢ç´¢æ‚¨çš„æœºå™¨äººå¯ä»¥åšä»€ä¹ˆçš„æœ‰åŠ›æ–¹æ³•ï¼Œå¹¶ä¸”æ˜¯ä¿®æ­£å…¶é”™è¯¯çš„æœ€ç®€å•æ–¹æ³•ã€‚åŸºäºæœºå™¨å­¦ä¹ çš„å¯¹è¯çš„ä¸€ä¸ªä¼˜åŠ¿æ˜¯ï¼Œå½“æ‚¨çš„æœºå™¨äººè¿˜ä¸çŸ¥é“å¦‚ä½•åšæ—¶ï¼Œæ‚¨å¯ä»¥æ•™å®ƒï¼æœ‰äººå°†æ­¤<a target="_blank" rel="noopener" href="https://medium.com/@karpathy/software-2-0-a64152b37c35">è½¯ä»¶</a>ç§°ä¸º<a target="_blank" rel="noopener" href="https://medium.com/@karpathy/software-2-0-a64152b37c35">2.0</a>ã€‚</p>
<blockquote>
<p>æ³¨æ„</p>
<p>Rasa Xæä¾›äº†ç”¨äºäº¤äº’å¼å­¦ä¹ çš„UIï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»»ä½•ç”¨æˆ·å¯¹è¯ä½œä¸ºèµ·ç‚¹ã€‚è¯·å‚é˜… Rasa Xæ–‡æ¡£ä¸­çš„ä¸<a href="#">æœºå™¨äººå¯¹è¯</a>ã€‚</p>
</blockquote>
<ul>
<li><a href="#">è¿›è¡Œäº’åŠ¨å­¦ä¹ </a></li>
<li><a href="#">æä¾›æœ‰å…³é”™è¯¯çš„åé¦ˆ</a></li>
<li><a href="#">å¯¹è¯å¯è§†åŒ–</a></li>
<li><a href="#">è¡¨æ ¼äº’åŠ¨å­¦ä¹ </a><ul>
<li><a href="#">è¯¥<code>form:</code>å‰ç¼€</a></li>
<li><a href="#">è¾“å…¥éªŒè¯</a></li>
</ul>
</li>
</ul>
<h3 id="è¿è¡Œäº’åŠ¨å­¦ä¹ "><a href="#è¿è¡Œäº’åŠ¨å­¦ä¹ " class="headerlink" title="è¿è¡Œäº’åŠ¨å­¦ä¹ "></a>è¿è¡Œäº’åŠ¨å­¦ä¹ </h3><p>è¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥å¼€å§‹äº¤äº’å¼å­¦ä¹ ï¼š</p>
<pre class=" language-shell"><code class="language-shell">rasa run actions --actions actions&

rasa interactive \
  -m models/20190515-135859.tar.gz \
  --endpoints endpoints.yml</code></pre>
<p>ç¬¬ä¸€æ¡å‘½ä»¤å¯åŠ¨åŠ¨ä½œæœåŠ¡å™¨ï¼ˆè¯·å‚é˜…<a href="#">è‡ªå®šä¹‰åŠ¨ä½œ</a>ï¼‰ã€‚</p>
<p>ç¬¬äºŒä¸ªå‘½ä»¤å¯åŠ¨äº¤äº’å¼å­¦ä¹ æ¨¡å¼ã€‚</p>
<p>åœ¨äº¤äº’æ¨¡å¼ä¸‹ï¼ŒRasaå°†è¦æ±‚æ‚¨ç¡®è®¤NLUå’ŒCoreæ‰€åšçš„æ¯ä¸ªé¢„æµ‹ï¼Œç„¶åå†ç»§ç»­ã€‚è¿™æ˜¯ä¸€ä¸ªä¾‹å­ï¼š</p>
<pre class=" language-text"><code class="language-text">Bot loaded. Type a message and press enter (use '/stop' to exit).

? Next user input:  hello

? Is the NLU classification for 'hello' with intent 'hello' correct?  Yes

------
Chat History

 #    Bot                        You
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 1    action_listen
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 2                                    hello
                         intent: hello 1.00
------

? The bot wants to run 'utter_greet', correct?  (Y/n)        </code></pre>
<p>èŠå¤©å†å²è®°å½•å’Œæ—¶æ®µå€¼ä¼šæ‰“å°åˆ°å±å¹•ä¸Šï¼Œè¿™åº”è¯¥æ˜¯å†³å®šæ­£ç¡®çš„ä¸‹ä¸€æ­¥æ“ä½œæ‰€éœ€çš„å…¨éƒ¨ä¿¡æ¯ã€‚</p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœºå™¨äººé€‰æ‹©äº†æ­£ç¡®çš„æ“ä½œï¼ˆ<code>utter_greet</code>ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬é”®å…¥<code>y</code>ã€‚ç„¶åæˆ‘ä»¬<code>y</code>å†æ¬¡é”®å…¥ï¼Œå› ä¸º<code>action_listen</code>é—®å€™è¯­ä¹‹åçš„æ“ä½œæ˜¯æ­£ç¡®çš„ã€‚æˆ‘ä»¬ç»§ç»­è¯¥å¾ªç¯ï¼Œä¸æœºå™¨äººèŠå¤©ï¼Œç›´åˆ°æœºå™¨äººé€‰æ‹©äº†é”™è¯¯çš„æ“ä½œã€‚</p>
<h3 id="æä¾›äº†å¯¹é”™è¯¯çš„åé¦ˆ"><a href="#æä¾›äº†å¯¹é”™è¯¯çš„åé¦ˆ" class="headerlink" title="æä¾›äº†å¯¹é”™è¯¯çš„åé¦ˆ"></a>æä¾›äº†å¯¹é”™è¯¯çš„åé¦ˆ</h3><p>å¯¹äºæœ¬ç¤ºä¾‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è¯¥<code>concertbot</code>ç¤ºä¾‹ï¼Œå› æ­¤è¯·ç¡®ä¿æ‚¨å…·æœ‰è¯¥åŸŸå’Œæ•°æ®ã€‚æ‚¨å¯ä»¥ä»æˆ‘ä»¬çš„<a target="_blank" rel="noopener" href="https://github.com/RasaHQ/rasa/tree/master/examples/concertbot">github repo</a>ä¸‹è½½æ•°æ®ã€‚</p>
<p>å¦‚æœæ‚¨è¯¢é—®<code>/search_concerts</code>ï¼Œåˆ™æ¼«æ¸¸å™¨åº”æå‡ºå»ºè®® <code>action_search_concerts</code>ï¼Œç„¶å<code>action_listen</code>ï¼ˆè¯¥ç­–ç•¥å°†åœ¨æ“ä½œåç§°æ—è¾¹æ˜¾ç¤ºè¯¥ç­–ç•¥é€‰æ‹©å…¶ä¸‹ä¸€ä¸ªæ“ä½œçš„ç½®ä¿¡åº¦ï¼‰ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬è¾“å…¥<code>/compare_reviews</code>ä¸‹ä¸€æ¡ç”¨æˆ·æ¶ˆæ¯ã€‚æœºå™¨äºº<em>å¯èƒ½ä¼š</em>ä»ä¸¤ç§å¯èƒ½æ€§ä¸­é€‰æ‹©é”™è¯¯çš„ä¸€ç§ï¼ˆå–å†³äºè®­ç»ƒçš„è¿è¡Œï¼Œå®ƒå¯èƒ½ä¹Ÿæ˜¯æ­£ç¡®çš„ï¼‰ï¼š</p>
<pre class=" language-latex"><code class="language-latex">------
Chat History

 #    Bot                                           You
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 1    action_listen
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 2                                            /search_concerts
                                  intent: search_concerts 1.00
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 3    action_search_concerts 0.72
      action_listen 0.78
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 4                                            /compare_reviews
                                  intent: compare_reviews 1.00


Current slots:
  concerts: None, venues: None

------
? The bot wants to run 'action_show_concert_reviews', correct?  No</code></pre>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬é”®å…¥<code>n</code>ï¼Œå› ä¸ºå®ƒé€‰æ‹©äº†é”™è¯¯çš„æ“ä½œï¼Œç„¶åå‡ºç°ä¸€ä¸ªæ–°çš„æç¤ºï¼Œè¦æ±‚æ­£ç¡®çš„æ“ä½œã€‚è¿™ä¹Ÿæ˜¾ç¤ºäº†æ¨¡å‹åˆ†é…ç»™æ¯ä¸ªåŠ¨ä½œçš„æ¦‚ç‡ï¼š</p>
<pre class=" language-text"><code class="language-text">? What is the next action of the bot?  (Use arrow keys)
 â¯ 0.53 action_show_venue_reviews
   0.46 action_show_concert_reviews
   0.00 utter_goodbye
   0.00 action_search_concerts
   0.00 utter_greet
   0.00 action_search_venues
   0.00 action_listen
   0.00 utter_youarewelcome
   0.00 utter_default
   0.00 action_default_fallback
   0.00 action_restart</code></pre>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœºå™¨äººåº”è¯¥<code>action_show_concert_reviews</code>ï¼ˆè€Œä¸æ˜¯åœºåœ°è¯„è®ºï¼ï¼‰æ¥é€‰æ‹©è¯¥åŠ¨ä½œã€‚</p>
<p>ç°åœ¨ï¼Œåªè¦æˆ‘ä»¬æ„¿æ„è¿›è¡Œæ›´é•¿çš„å¯¹è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»§ç»­ä¸æœºå™¨äººå¯¹è¯ã€‚æ‚¨å¯ä»¥éšæ—¶æŒ‰<code>Ctrl-C</code>ï¼Œè¯¥botä¼šä¸ºæ‚¨æä¾›é€€å‡ºé€‰é¡¹ã€‚æ‚¨å¯ä»¥å°†æ–°åˆ›å»ºçš„æ•…äº‹å’ŒNLUæ•°æ®å†™å…¥æ–‡ä»¶ã€‚å¦‚æœæä¾›åé¦ˆæ—¶å‡ºé”™ï¼Œä¹Ÿå¯ä»¥è¿”å›ä¸Šä¸€æ­¥ã€‚</p>
<p>ç¡®ä¿å°†è½¬å‚¨çš„æ•…äº‹å’ŒNLUç¤ºä¾‹ä¸æ‚¨çš„åŸå§‹åŸ¹è®­æ•°æ®ç»“åˆèµ·æ¥ï¼Œä»¥è¿›è¡Œä¸‹ä¸€æ¬¡è®­ç»ƒã€‚</p>
<h3 id="å¯¹è¯çš„å¯è§†åŒ–"><a href="#å¯¹è¯çš„å¯è§†åŒ–" class="headerlink" title="å¯¹è¯çš„å¯è§†åŒ–"></a>å¯¹è¯çš„å¯è§†åŒ–</h3><p>åœ¨äº¤äº’å¼å­¦ä¹ æœŸé—´ï¼ŒRasaå°†ä»è®­ç»ƒæ•°æ®ä¸­ç»˜åˆ¶å½“å‰å¯¹è¯å’Œä¸€äº›ç±»ä¼¼å¯¹è¯ï¼Œä»¥å¸®åŠ©æ‚¨è·Ÿè¸ªè‡ªå·±çš„ä½ç½®ã€‚</p>
<p>å¼€å§‹äº¤äº’å¼å­¦ä¹ åï¼Œæ‚¨å¯ä»¥åœ¨<a target="_blank" rel="noopener" href="http://localhost:5005/visualization.html">httpï¼š// localhostï¼š5005 / visualization.htmlä¸Š</a>æŸ¥çœ‹å¯è§†åŒ–ã€‚</p>
<p>è¦è·³è¿‡å¯è§†åŒ–ï¼Œè¯·è¿è¡Œã€‚<code>rasa interactive --skip-visualization</code></p>
<p><img src="/2020/10/05/rasa-wen-dang-zhi-nan-14/1.gif"></p>
<h3 id="è¡¨å•äº’åŠ¨å­¦ä¹ "><a href="#è¡¨å•äº’åŠ¨å­¦ä¹ " class="headerlink" title="è¡¨å•äº’åŠ¨å­¦ä¹ "></a>è¡¨å•äº’åŠ¨å­¦ä¹ </h3><p>å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯FormActionï¼Œåˆ™åœ¨ä½¿ç”¨äº¤äº’å¼å­¦ä¹ æ—¶è¿˜éœ€è¦è®°ä½ä¸€äº›å…¶ä»–äº‹é¡¹ã€‚</p>
<h4 id="form-å‰ç¼€"><a href="#form-å‰ç¼€" class="headerlink" title="form:å‰ç¼€"></a><code>form:</code>å‰ç¼€</h4><p>è¡¨å•é€»è¾‘æ˜¯ç”±æ‚¨çš„<code>FormAction</code>ç­çº§è€Œä¸æ˜¯æ•…äº‹æ¥æè¿°çš„ã€‚æœºå™¨å­¦ä¹ ç­–ç•¥åº”è¯¥ä¸å¿…å­¦ä¹ è¿™ç§è¡Œä¸ºï¼Œå¹¶ä¸”å¦‚æœä»¥åè¦æ›´æ”¹è¡¨å•æ“ä½œï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡æ·»åŠ æˆ–åˆ é™¤æ‰€éœ€çš„æ’æ§½ï¼‰ä¹Ÿä¸è¦æ„Ÿåˆ°å›°æƒ‘ã€‚å½“æ‚¨ä½¿ç”¨äº¤äº’å¼å­¦ä¹ ç”ŸæˆåŒ…å«è¡¨å•çš„æ•…äº‹æ—¶ï¼Œè¡¨å•å¤„ç†çš„å¯¹è¯æ­¥éª¤ä¼šè·å¾—<code>form:</code>å‰ç¼€ã€‚è¿™å‘Šè¯‰Rasa Coreåœ¨è®­ç»ƒå…¶ä»–ç­–ç•¥æ—¶å¿½ç•¥è¿™äº›æ­¥éª¤ã€‚æ‚¨ä¸å¿…åœ¨è¿™é‡Œåšä»»ä½•ç‰¹åˆ«çš„äº‹æƒ…ï¼Œ<a target="_blank" rel="noopener" href="https://legacy-docs-v1.rasa.com/core/forms/#forms">Forms</a>ç»™å‡ºçš„åŸºæœ¬æ•…äº‹ä»ç„¶æ¶µç›–äº†è¡¨å•çš„æ‰€æœ‰å¿«ä¹è·¯å¾„ã€‚</p>
<p>è¿™æ˜¯ä¸€ä¸ªä¾‹å­ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token list punctuation">*</span> request_restaurant
<span class="token code keyword">    - restaurant_form</span>
<span class="token code keyword">    - form&amp;#123;"name": "restaurant_form"&amp;#125;</span>
<span class="token code keyword">    - slot&amp;#123;"requested_slot": "cuisine"&amp;#125;</span>
<span class="token list punctuation">*</span> form: inform<span class="token entity" title="&#123;">&amp;#123;</span>"cuisine": "mexican"<span class="token entity" title="&#125;">&amp;#125;</span>
<span class="token code keyword">    - slot&amp;#123;"cuisine": "mexican"&amp;#125;</span>
<span class="token code keyword">    - form: restaurant_form</span>
<span class="token code keyword">    - slot&amp;#123;"cuisine": "mexican"&amp;#125;</span>
<span class="token code keyword">    - slot&amp;#123;"requested_slot": "num_people"&amp;#125;</span>
<span class="token list punctuation">*</span> form: inform<span class="token entity" title="&#123;">&amp;#123;</span>"number": "2"<span class="token entity" title="&#125;">&amp;#125;</span>
<span class="token code keyword">    - form: restaurant_form</span>
<span class="token code keyword">    - slot&amp;#123;"num_people": "2"&amp;#125;</span>
<span class="token code keyword">    - form&amp;#123;"name": null&amp;#125;</span>
<span class="token code keyword">    - slot&amp;#123;"requested_slot": null&amp;#125;</span>
<span class="token code keyword">    - utter_slots_values</span></code></pre>
<h4 id="è¾“å…¥éªŒè¯"><a href="#è¾“å…¥éªŒè¯" class="headerlink" title="è¾“å…¥éªŒè¯"></a>è¾“å…¥éªŒè¯</h4><p>æ¯æ¬¡ç”¨æˆ·ä½¿ç”¨è¯·æ±‚çš„æ’æ§½æˆ–ä»»ä½•æ‰€éœ€çš„æ’æ§½ä»¥å¤–çš„<em>å…¶ä»–å†…å®¹è¿›è¡Œ</em>å“åº”æ—¶ï¼Œç³»ç»Ÿéƒ½ä¼šè¯¢é—®æ‚¨æ˜¯å¦è¦è®©è¡¨å•æ“ä½œåœ¨è¿”å›è¡¨å•æ—¶å°è¯•ä»ç”¨æˆ·æ¶ˆæ¯ä¸­æå–ä¸€ä¸ªæ’æ§½ã€‚æœ€å¥½ç”¨å’Œç¤ºä¾‹æ¥è§£é‡Šï¼š</p>
<pre class=" language-text"><code class="language-text"> 7    restaurant_form 1.00
      slot&#123;"num_people": "3"&#125;
      slot&#123;"requested_slot": "outdoor_seating"&#125;
      do you want to sit outside?
      action_listen 1.00
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 8                                                                             /stop
                                                                   intent: stop 1.00
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 9    utter_ask_continue 1.00
      do you want to continue?
      action_listen 1.00
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 10                                                                          /affirm
                                                                 intent: affirm 1.00


Current slots:
    cuisine: greek, feedback: None, num_people: 3, outdoor_seating: None,
  preferences: None, requested_slot: outdoor_seating

------
2018-11-05 21:36:53 DEBUG    rasa.core.tracker_store  - Recreating tracker for id 'default'
? The bot wants to run 'restaurant_form', correct?  Yes
2018-11-05 21:37:08 DEBUG    rasa.core.tracker_store  - Recreating tracker for id 'default'
? Should 'restaurant_form' validate user input to fill the slot 'outdoor_seating'?  (Y/n)</code></pre>
<p>åœ¨è¿™é‡Œï¼Œç”¨æˆ·è¦æ±‚åœæ­¢è¡¨å•ï¼Œè€Œæ¼«æ¸¸å™¨åˆ™è¯¢é—®ç”¨æˆ·æ˜¯å¦ç¡®å®šä¸æƒ³ç»§ç»­ã€‚ç”¨æˆ·è¯´ä»–ä»¬æƒ³ç»§ç»­ï¼ˆ<code>/affirm</code>æ„å›¾ï¼‰ã€‚è¿™é‡Œ<code>outdoor_seating</code>æœ‰ä¸€ä¸ª<code>from_intent</code>æ’æ§½æ˜ å°„ï¼ˆ<code>/affirm</code>æ„å›¾æ˜ å°„åˆ°<code>True</code>ï¼‰ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨æ­¤ç”¨æˆ·è¾“å…¥æ¥å¡«å……è¯¥æ’æ§½ã€‚ä½†æ˜¯ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”¨æˆ·åªæ˜¯åœ¨å›ç­”â€œæ‚¨è¦ç»§ç»­å—ï¼Ÿâ€ é—®é¢˜ï¼Œå› æ­¤é€‰æ‹©<code>n</code>ï¼Œåˆ™ä¸åº”éªŒè¯ç”¨æˆ·è¾“å…¥ã€‚æœºå™¨äººéšåå°†ç»§ç»­è¦æ±‚è¯¥ <code>outdoor_seating</code>æ’æ§½ã€‚</p>
<blockquote>
<p>è­¦å‘Š</p>
<p>å¦‚æœæ‚¨çš„è®­ç»ƒæ•°æ®ä¸­æœ‰ä¸€ä¸ªçŸ›ç›¾çš„æ•…äº‹ï¼Œå³æ‚¨åªæ˜¯é€‰æ‹©éªŒè¯è¾“å…¥ï¼ˆæ„å‘³ç€å®ƒå°†ä»¥<code>forms:</code>å‰ç¼€æ‰“å°ï¼‰ï¼Œä½†æ˜¯æ‚¨çš„æ•…äº‹æ–‡ä»¶ä¸­åŒ…å«äº†æ‚¨ä¸éªŒè¯è¾“å…¥çš„ç›¸åŒæ•…äº‹ï¼ˆæ„å‘³ç€æ²¡æœ‰è¾“å…¥ï¼‰è¯¥<code>forms:</code>å‰ç¼€ï¼‰ï¼Œä½ å°†éœ€è¦ç¡®ä¿æ¶ˆé™¤è¿™ç§å†²çªçš„æ•…äº‹ã€‚å‘ç”Ÿè¿™ç§æƒ…å†µæ—¶ï¼Œä¼šå‡ºç°è­¦å‘Šæç¤ºï¼Œæé†’æ‚¨æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p>
<p><strong>è­¦å‘Šï¼šFormPolicyæ ¹æ®ä»¥å‰çš„åŸ¹è®­ç»éªŒé¢„æµ‹ä¸ä¼šè¿›è¡Œè¡¨å•éªŒè¯ã€‚ç¡®ä¿ä»è®­ç»ƒæ•°æ®ä¸­åˆ é™¤çŸ›ç›¾çš„æ•…äº‹</strong></p>
<p>åˆ é™¤è¯¥æ•…äº‹åï¼Œæ‚¨å¯ä»¥æŒ‰Enteré”®å¹¶ç»§ç»­è¿›è¡Œäº¤äº’å¼å­¦ä¹ </p>
</blockquote>
<h2 id="FallbackåŠ¨ä½œ"><a href="#FallbackåŠ¨ä½œ" class="headerlink" title="FallbackåŠ¨ä½œ"></a>FallbackåŠ¨ä½œ</h2><p>æœ‰æ—¶æ‚¨æƒ³æ¢å¤ä¸ºå¤‡ç”¨æ“ä½œï¼Œä¾‹å¦‚å›ç­” â€œå¯¹ä¸èµ·ï¼Œæˆ‘ä¸æ˜ç™½â€ã€‚æ‚¨å¯ä»¥é€šè¿‡æ·»åŠ æ— è®ºæ˜¯å¤„ç†å›é€€çš„æƒ…å†µä¸‹<code>FallbackPolicy</code>æˆ–<code>TwoStageFallbackPolicy</code>æ‚¨çš„ä¿å•åˆå¥ã€‚</p>
<h2 id="Fallbackç­–ç•¥"><a href="#Fallbackç­–ç•¥" class="headerlink" title="Fallbackç­–ç•¥"></a>Fallbackç­–ç•¥</h2><p>è¯¥<code>FallbackPolicy</code>æœ‰ä¸€ä¸ªå›é€€æ“ä½œï¼Œå¦‚æœæ„å›¾è¯†åˆ«ä¸‹æ–¹æœ‰ä¿¡å¿ƒï¼Œè¿™å°†è¢«æ‰§è¡Œ<code>nlu_threshold</code> æˆ–è€…å¦‚æœæ²¡æœ‰å¯¹è¯æ”¿ç­–çš„é¢„æµ‹æœ‰ä¿¡å¿ƒçš„ä½œç”¨å¤§äº<code>core_threshold</code>ã€‚</p>
<p>é˜ˆå€¼å’Œå›é€€æ“ä½œå¯ä»¥åœ¨ç­–ç•¥é…ç½®æ–‡ä»¶ä¸­ä½œä¸ºçš„å‚æ•°è¿›è¡Œè°ƒæ•´<code>FallbackPolicy</code>ã€‚</p>
<pre class=" language-markdown"><code class="language-markdown">policies:
  <span class="token list punctuation">-</span> name: "FallbackPolicy"
<span class="token code keyword">    nlu_threshold: 0.4</span>
<span class="token code keyword">    core_threshold: 0.3</span>
<span class="token code keyword">    fallback_action_name: "action_default_fallback"</span></code></pre>
<p><code>action_default_fallback</code>æ˜¯Rasa Coreä¸­çš„é»˜è®¤æ“ä½œï¼Œå®ƒå°†<code>utter_default</code>å“åº”å‘é€ ç»™ç”¨æˆ·ã€‚ç¡®ä¿<code>utter_default</code>åœ¨æ‚¨çš„åŸŸæ–‡ä»¶ä¸­æŒ‡å®šã€‚å®ƒè¿˜å°†è¿˜åŸåˆ°å¯¼è‡´å›é€€çš„ç”¨æˆ·æ¶ˆæ¯ä¹‹å‰çš„ä¼šè¯çŠ¶æ€ï¼Œä»è€Œä¸ä¼šå½±å“å¯¹æœªæ¥æ“ä½œçš„é¢„æµ‹ã€‚æ‚¨å¯ä»¥æŸ¥çœ‹ä»¥ä¸‹æ“ä½œçš„æ¥æºï¼š</p>
<ul>
<li><p><em>ç±»</em><code>rasa.core.actions.action.``ActionDefaultFallback</code></p>
<p>æ‰§è¡Œåå¤‡æ“ä½œå¹¶è¿”å›åˆ°å¯¹è¯çš„å…ˆå‰çŠ¶æ€</p>
</li>
</ul>
<p>æ‚¨è¿˜å¯ä»¥åˆ›å»ºè‡ªå·±çš„è‡ªå®šä¹‰æ“ä½œä»¥ç”¨ä½œåå¤‡å¹¿å‘Šï¼ˆæœ‰å…³<a href="#">è‡ªå®šä¹‰æ“ä½œ</a>çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§ <a href="#">è‡ª</a>å®šä¹‰æ“ä½œï¼‰ã€‚å¦‚æœè¿™æ ·åšï¼Œè¯·ç¡®ä¿å°†è‡ªå®šä¹‰åå¤‡æ“ä½œä¼ é€’åˆ°<code>FallbackPolicy</code>ç­–ç•¥é…ç½®æ–‡ä»¶ä¸­ã€‚ä¾‹å¦‚ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">policies:
  <span class="token list punctuation">-</span> name: "FallbackPolicy"
<span class="token code keyword">    nlu_threshold: 0.4</span>
<span class="token code keyword">    core_threshold: 0.3</span>
<span class="token code keyword">    fallback_action_name: "my_fallback_action"</span></code></pre>
<blockquote>
<p>æ³¨æ„</p>
<p>å¦‚æœæ‚¨çš„è‡ªå®šä¹‰åå¤‡æ“ä½œæœªè¿”å›<code>UserUtteranceReverted</code>äº‹ä»¶ï¼Œåˆ™æœºå™¨äººçš„ä¸‹ä¸€ä¸ªé¢„æµ‹å¯èƒ½ä¼šå˜å¾—ä¸å‡†ç¡®ï¼Œå› ä¸ºæ‚¨çš„æ•…äº‹ä¸­å¾ˆå¯èƒ½æ²¡æœ‰åå¤‡æ“ä½œã€‚</p>
</blockquote>
<p>å¦‚æœæ‚¨æœ‰ä¸€ä¸ªç‰¹å®šçš„æ„å›¾ï¼ˆå‡è®¾å®ƒç§°ä¸ºï¼‰<code>out_of_scope</code>ï¼Œå®ƒåº”è¯¥å§‹ç»ˆè§¦å‘åå¤‡æ“ä½œï¼Œåˆ™åº”å°†å…¶æ·»åŠ ä¸ºæ•…äº‹ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">##</span> fallback story</span>
<span class="token list punctuation">*</span> out<span class="token italic"><span class="token punctuation">_</span>of<span class="token punctuation">_</span></span>scope
  <span class="token list punctuation">-</span> action<span class="token italic"><span class="token punctuation">_</span>default<span class="token punctuation">_</span></span>fallback</code></pre>
<h3 id="ä¸¤é˜¶æ®µå›é€€ç­–ç•¥-1"><a href="#ä¸¤é˜¶æ®µå›é€€ç­–ç•¥-1" class="headerlink" title="ä¸¤é˜¶æ®µå›é€€ç­–ç•¥"></a>ä¸¤é˜¶æ®µå›é€€ç­–ç•¥</h3><p>æ‰€è¿°<code>TwoStageFallbackPolicy</code>æ‰‹æŸ„ä½NLUä¿¡å¿ƒåœ¨å¤šä¸ªé˜¶æ®µä¸­é€šè¿‡å°è¯•æ¥æ¶ˆé™¤æ­§ä¹‰æ‰€è¿°ç”¨æˆ·è¾“å…¥ï¼ˆä½èŠ¯çš„ä¿¡å¿ƒåœ¨ç›¸åŒçš„æ–¹å¼å¤„ç†<code>FallbackPolicy</code>ï¼‰ã€‚</p>
<ul>
<li>å¦‚æœNLUé¢„æµ‹çš„ç½®ä¿¡åº¦å¾—åˆ†ä½ï¼Œåˆ™è¦æ±‚ç”¨æˆ·ç¡®è®¤æ„å›¾çš„åˆ†ç±»ã€‚ï¼ˆé»˜è®¤æ“ä½œï¼š <code>action_default_ask_affirmation</code>ï¼‰<ul>
<li>å¦‚æœä»–ä»¬è‚¯å®šäº†ï¼Œé‚£ä¹ˆæ•…äº‹å°†ç»§ç»­ï¼Œå°±å¥½åƒä»ä¸€å¼€å§‹å°±å¯¹æ„å›¾è¿›è¡Œäº†é«˜åº¦è‡ªä¿¡çš„åˆ†ç±»ã€‚</li>
<li>å¦‚æœä»–ä»¬æ‹’ç»ï¼Œåˆ™è¦æ±‚ç”¨æˆ·é‡æ–°è¡¨è¾¾ä»–ä»¬çš„æ¶ˆæ¯ã€‚</li>
</ul>
</li>
<li>æ”¹å†™ï¼ˆé»˜è®¤æ“ä½œï¼š<code>action_default_ask_rephrase</code>ï¼‰<ul>
<li>å¦‚æœé‡æ–°è¡¨è¾¾æ„å›¾çš„åˆ†ç±»æ˜¯ç¡®å®šçš„ï¼Œåˆ™æ•…äº‹å°†ç»§ç»­ï¼Œå°±å¥½åƒç”¨æˆ·ä»ä¸€å¼€å§‹å°±å…·æœ‰æ­¤æ„å›¾ã€‚</li>
<li>å¦‚æœæªè¾çš„æ„å›¾æ²¡æœ‰è¢«é«˜å¯ä¿¡åº¦åˆ†ç±»ï¼Œåˆ™è¦æ±‚ç”¨æˆ·ç¡®è®¤åˆ†ç±»çš„æ„å›¾ã€‚</li>
</ul>
</li>
<li>å…¶æ¬¡è‚¯å®šï¼ˆé»˜è®¤æ“ä½œï¼š<code>action_default_ask_affirmation</code>ï¼‰<ul>
<li>å¦‚æœç”¨æˆ·ç¡®è®¤äº†æ­¤æ„å›¾ï¼Œåˆ™æ•…äº‹å°†ç»§ç»­ï¼Œå°±åƒç”¨æˆ·ä»ä¸€å¼€å§‹å°±å…·æœ‰æ­¤æ„å›¾ä¸€æ ·ã€‚</li>
<li>å¦‚æœç”¨æˆ·æ‹’ç»ï¼Œåˆ™å°†åŸå§‹æ„å›¾åˆ†ç±»ä¸ºæŒ‡å®šçš„ <code>deny_suggestion_intent_name</code>ï¼Œå¹¶<code>fallback_nlu_action_name</code>è§¦å‘æœ€ç»ˆçš„åå¤‡æ“ä½œ ï¼ˆä¾‹å¦‚ï¼Œç§»äº¤ç»™äººç±»ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<p>èæ ¸å¿ƒæä¾›äº†é»˜è®¤çš„å®ç° <code>action_default_ask_affirmation</code>å’Œ<code>action_default_ask_rephrase</code>ã€‚æ“ä½œçš„é»˜è®¤å®ç°ä¼š<code>action_default_ask_rephrase</code>å‘å‡ºå“åº”<code>utter_ask_rephrase</code>ï¼Œå› æ­¤è¯·ç¡®ä¿åœ¨åŸŸæ–‡ä»¶ä¸­æŒ‡å®šæ­¤å“åº”ã€‚è¿™ä¸¤ä¸ªåŠ¨ä½œçš„å®ç°éƒ½å¯ä»¥ç”¨<a href="#">è‡ªå®šä¹‰åŠ¨ä½œ</a>è¦†ç›–ã€‚</p>
<p>æ‚¨å¯ä»¥<code>TwoStageFallbackPolicy</code>åœ¨ç­–ç•¥é…ç½®æ–‡ä»¶ä¸­å°†æ ¸å¿ƒå›é€€æ“ä½œä»¥åŠæœ€ç»ˆçš„NLUå›é€€æ“ä½œæŒ‡å®šä¸ºå‚æ•°ã€‚</p>
<pre class=" language-markdown"><code class="language-markdown">policies:
  <span class="token list punctuation">-</span> name: TwoStageFallbackPolicy
<span class="token code keyword">    nlu_threshold: 0.3</span>
<span class="token code keyword">    core_threshold: 0.3</span>
<span class="token code keyword">    fallback_core_action_name: "action_default_fallback"</span>
<span class="token code keyword">    fallback_nlu_action_name: "action_default_fallback"</span>
<span class="token code keyword">    deny_suggestion_intent_name: "out_of_scope"</span></code></pre>
<h2 id="çŸ¥è¯†åº“æ“ä½œ"><a href="#çŸ¥è¯†åº“æ“ä½œ" class="headerlink" title="çŸ¥è¯†åº“æ“ä½œ"></a>çŸ¥è¯†åº“æ“ä½œ</h2><blockquote>
<p>è­¦å‘Š</p>
<p>æ­¤åŠŸèƒ½æ˜¯å®éªŒæ€§çš„ã€‚æˆ‘ä»¬å¼•å…¥å®éªŒæ€§åŠŸèƒ½ä»¥è·å–ç¤¾åŒºçš„åé¦ˆï¼Œå› æ­¤æˆ‘ä»¬é¼“åŠ±æ‚¨å°è¯•ä¸€ä¸‹ï¼ä½†æ˜¯ï¼Œå°†æ¥å¯èƒ½ä¼šæ›´æ”¹æˆ–åˆ é™¤åŠŸèƒ½ã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•åé¦ˆï¼ˆæ­£é¢æˆ–è´Ÿé¢ï¼‰ï¼Œè¯·åœ¨<a target="_blank" rel="noopener" href="https://forum.rasa.com/">è®ºå›</a>ä¸Šä¸æˆ‘ä»¬åˆ†äº«ã€‚</p>
</blockquote>
<ul>
<li><a href="#">ä½¿ç”¨ <code>ActionQueryKnowledgeBase</code></a><ul>
<li><a href="#">å»ºç«‹çŸ¥è¯†åº“</a></li>
<li><a href="#">å®šä¹‰NLUæ•°æ®</a></li>
<li><a href="#">åˆ›å»ºä¸€ä¸ªæ“ä½œæ¥æŸ¥è¯¢æ‚¨çš„çŸ¥è¯†åº“</a></li>
</ul>
</li>
<li><a href="#">æ€ä¹ˆè¿è¡Œçš„</a><ul>
<li><a href="#">åœ¨çŸ¥è¯†åº“ä¸­æŸ¥è¯¢å¯¹è±¡</a></li>
<li><a href="#">åœ¨çŸ¥è¯†åº“ä¸­æŸ¥è¯¢å¯¹è±¡çš„å±æ€§</a></li>
<li><a href="#">è§£å†³æåŠ</a></li>
</ul>
</li>
<li><a href="#">å®¢åˆ¶åŒ–</a><ul>
<li><a href="#">å®¢åˆ¶åŒ– <code>ActionQueryKnowledgeBase</code></a></li>
<li><a href="#">åˆ›å»ºè‡ªå·±çš„çŸ¥è¯†åº“æ“ä½œ</a></li>
<li><a href="#">è‡ªå®šä¹‰ <code>InMemoryKnowledgeBase</code></a></li>
<li><a href="#">åˆ›å»ºè‡ªå·±çš„çŸ¥è¯†åº“</a></li>
</ul>
</li>
</ul>
<p>çŸ¥è¯†åº“æ“ä½œä½¿æ‚¨èƒ½å¤Ÿå¤„ç†ä»¥ä¸‹ç±»å‹çš„å¯¹è¯ï¼š</p>
<p><img src="/2020/10/05/rasa-wen-dang-zhi-nan-14/12.png"></p>
<p>ä¼šè¯å¼AIä¸­çš„ä¸€ä¸ªå¸¸è§é—®é¢˜æ˜¯ï¼Œç”¨æˆ·ä¸ä»…é€šè¿‡åç§°æ¥å¼•ç”¨æŸäº›å¯¹è±¡ï¼Œè€Œä¸”è¿˜ä½¿ç”¨è¯¸å¦‚â€œç¬¬ä¸€ä¸ªâ€æˆ–â€œå®ƒâ€ä¹‹ç±»çš„å¼•ç”¨æœ¯è¯­ã€‚æˆ‘ä»¬éœ€è¦è·Ÿè¸ªæä¾›çš„ä¿¡æ¯ï¼Œä»¥è§£å†³å¯¹æ­£ç¡®å¯¹è±¡çš„è¿™äº›æåŠã€‚</p>
<p>æ­¤å¤–ï¼Œç”¨æˆ·å¯èƒ½å¸Œæœ›åœ¨å¯¹è¯è¿‡ç¨‹ä¸­è·å–æœ‰å…³å¯¹è±¡çš„è¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼Œé¤å…æ˜¯å¦æœ‰æˆ·å¤–åº§ä½ï¼Œæˆ–æœ‰å¤šæ˜‚è´µã€‚ä¸ºäº†å“åº”é‚£äº›ç”¨æˆ·è¯·æ±‚ï¼Œéœ€è¦æœ‰å…³é¤å…åŸŸçš„çŸ¥è¯†ã€‚ç”±äºä¿¡æ¯éšæ—¶å¯èƒ½æ›´æ”¹ï¼Œå› æ­¤ç¡¬ç¼–ç ä¿¡æ¯ä¸æ˜¯è§£å†³æ–¹æ¡ˆã€‚</p>
<p>ä¸ºäº†åº”å¯¹ä¸Šè¿°æŒ‘æˆ˜ï¼ŒRasaå¯ä»¥ä¸çŸ¥è¯†åº“é›†æˆã€‚è¦ä½¿ç”¨è¿™ç§é›†æˆï¼Œæ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ªçš„è‡ªå®šä¹‰æ“ä½œ<code>ActionQueryKnowledgeBase</code>ï¼Œè¯¥é¢„å†™çš„è‡ªå®šä¹‰æ“ä½œåŒ…å«ç”¨äºæŸ¥è¯¢çŸ¥è¯†åº“ä¸­å¯¹è±¡åŠå…¶å±æ€§çš„é€»è¾‘ã€‚</p>
<p>æ‚¨å¯ä»¥åœ¨<code>examples/knowledgebasebot</code> ï¼ˆ<a target="_blank" rel="noopener" href="https://github.com/RasaHQ/rasa/blob/master/examples/knowledgebasebot/">çŸ¥è¯†åº“bot</a>ï¼‰ä¸­æ‰¾åˆ°å®Œæ•´çš„ç¤ºä¾‹ï¼Œä»¥åŠä¸‹é¢æœ‰å…³å®ç°æ­¤è‡ªå®šä¹‰æ“ä½œçš„è¯´æ˜ã€‚</p>
<h3 id="ä½¿ç”¨ActionQueryKnowledgeBase"><a href="#ä½¿ç”¨ActionQueryKnowledgeBase" class="headerlink" title="ä½¿ç”¨ActionQueryKnowledgeBase"></a>ä½¿ç”¨<code>ActionQueryKnowledgeBase</code></h3><h4 id="åˆ›å»ºçŸ¥è¯†åº“"><a href="#åˆ›å»ºçŸ¥è¯†åº“" class="headerlink" title="åˆ›å»ºçŸ¥è¯†åº“"></a>åˆ›å»ºçŸ¥è¯†åº“</h4><p>ç”¨äºå›ç­”ç”¨æˆ·è¯·æ±‚çš„æ•°æ®å°†å­˜å‚¨åœ¨çŸ¥è¯†åº“ä¸­ã€‚çŸ¥è¯†åº“å¯ç”¨äºå­˜å‚¨å¤æ‚çš„æ•°æ®ç»“æ„ã€‚å»ºè®®æ‚¨å¼€å§‹ä½¿ç”¨<code>InMemoryKnowledgeBase</code>ã€‚ä¸€æ—¦è¦å¼€å§‹å¤„ç†å¤§é‡æ•°æ®ï¼Œå°±å¯ä»¥åˆ‡æ¢åˆ°è‡ªå®šä¹‰çŸ¥è¯†åº“ï¼ˆè¯·å‚é˜…<a href="#">åˆ›å»ºè‡ªå·±çš„çŸ¥è¯†åº“</a>ï¼‰ã€‚</p>
<p>è¦åˆå§‹åŒ–<code>InMemoryKnowledgeBase</code>ï¼Œæ‚¨éœ€è¦åœ¨jsonæ–‡ä»¶ä¸­æä¾›æ•°æ®ã€‚ä»¥ä¸‹ç¤ºä¾‹åŒ…å«æœ‰å…³é¤å…å’Œé…’åº—çš„æ•°æ®ã€‚jsonç»“æ„åº”åŒ…å«æ¯ä¸ªå¯¹è±¡ç±»å‹ï¼ˆå³<code>"restaurant"</code>å’Œï¼‰çš„é”®<code>"hotel"</code>ã€‚æ¯ä¸ªå¯¹è±¡ç±»å‹éƒ½æ˜ å°„åˆ°å¯¹è±¡åˆ—è¡¨â€“åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æœ‰3å®¶é¤å…çš„åˆ—è¡¨å’Œ3å®¶é…’åº—çš„åˆ—è¡¨ã€‚</p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"restaurant"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Donath"</span><span class="token punctuation">,</span>
            <span class="token property">"cuisine"</span><span class="token operator">:</span> <span class="token string">"Italian"</span><span class="token punctuation">,</span>
            <span class="token property">"outside-seating"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token property">"price-range"</span><span class="token operator">:</span> <span class="token string">"mid-range"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Berlin Burrito Company"</span><span class="token punctuation">,</span>
            <span class="token property">"cuisine"</span><span class="token operator">:</span> <span class="token string">"Mexican"</span><span class="token punctuation">,</span>
            <span class="token property">"outside-seating"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token property">"price-range"</span><span class="token operator">:</span> <span class="token string">"cheap"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"I due forni"</span><span class="token punctuation">,</span>
            <span class="token property">"cuisine"</span><span class="token operator">:</span> <span class="token string">"Italian"</span><span class="token punctuation">,</span>
            <span class="token property">"outside-seating"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token property">"price-range"</span><span class="token operator">:</span> <span class="token string">"mid-range"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"hotel"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Hilton"</span><span class="token punctuation">,</span>
            <span class="token property">"price-range"</span><span class="token operator">:</span> <span class="token string">"expensive"</span><span class="token punctuation">,</span>
            <span class="token property">"breakfast-included"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token property">"city"</span><span class="token operator">:</span> <span class="token string">"Berlin"</span><span class="token punctuation">,</span>
            <span class="token property">"free-wifi"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token property">"star-rating"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
            <span class="token property">"swimming-pool"</span><span class="token operator">:</span> <span class="token boolean">true</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Hilton"</span><span class="token punctuation">,</span>
            <span class="token property">"price-range"</span><span class="token operator">:</span> <span class="token string">"expensive"</span><span class="token punctuation">,</span>
            <span class="token property">"breakfast-included"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token property">"city"</span><span class="token operator">:</span> <span class="token string">"Frankfurt am Main"</span><span class="token punctuation">,</span>
            <span class="token property">"free-wifi"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token property">"star-rating"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
            <span class="token property">"swimming-pool"</span><span class="token operator">:</span> <span class="token boolean">false</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"B&amp;B"</span><span class="token punctuation">,</span>
            <span class="token property">"price-range"</span><span class="token operator">:</span> <span class="token string">"mid-range"</span><span class="token punctuation">,</span>
            <span class="token property">"breakfast-included"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token property">"city"</span><span class="token operator">:</span> <span class="token string">"Berlin"</span><span class="token punctuation">,</span>
            <span class="token property">"free-wifi"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token property">"star-rating"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token property">"swimming-pool"</span><span class="token operator">:</span> <span class="token boolean">false</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span></code></pre>
<p>ä¸€æ—¦åœ¨jsonæ–‡ä»¶ï¼ˆä¾‹å¦‚ï¼‰ä¸­å®šä¹‰äº†æ•°æ®<code>data.json</code>ï¼Œæ‚¨å°±å¯ä»¥ä½¿ç”¨æ­¤æ•°æ®æ–‡ä»¶æ¥åˆ›å»ºæ‚¨çš„<code>InMemoryKnowledgeBase</code>ï¼Œè¯¥æ–‡ä»¶ å°†ä¼ é€’ç»™æŸ¥è¯¢çŸ¥è¯†åº“çš„æ“ä½œã€‚</p>
<p>çŸ¥è¯†åº“ä¸­çš„æ¯ä¸ªå¯¹è±¡éƒ½åº”è‡³å°‘å…·æœ‰<code>"name"</code>å’Œ<code>"id"</code>å­—æ®µä»¥ä½¿ç”¨é»˜è®¤å®ç°ã€‚å¦‚æœä¸æ˜¯ï¼Œåˆ™å¿…é¡»<a href="#">è‡ªå®šä¹‰InMemoryKnowledgeBase</a>ã€‚</p>
<h4 id="å®šä¹‰NLUæ•°æ®"><a href="#å®šä¹‰NLUæ•°æ®" class="headerlink" title="å®šä¹‰NLUæ•°æ®"></a>å®šä¹‰NLUæ•°æ®</h4><p>åœ¨è¿™ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li>æˆ‘ä»¬å°†ä»‹ç»ä¸€ä¸ªæ–°çš„æ„å›¾ï¼Œ <code>query_knowledge_base</code></li>
<li>æˆ‘ä»¬å°†å¯¹<code>mention</code>å®ä½“è¿›è¡Œæ³¨é‡Šï¼Œä»¥ä¾¿æˆ‘ä»¬çš„æ¨¡å‹èƒ½å¤Ÿæ£€æµ‹åˆ°è¯¸å¦‚â€œç¬¬ä¸€ä¸ªâ€ä¹‹ç±»çš„å¯¹è±¡çš„é—´æ¥æåŠ</li>
<li>æˆ‘ä»¬å°†å¹¿æ³›ä½¿ç”¨<a href="#">åŒä¹‰è¯</a></li>
</ul>
<p>ä¸ºäº†ä½¿æœºå™¨äººç†è§£ç”¨æˆ·æƒ³è¦ä»çŸ¥è¯†åº“ä¸­æ£€ç´¢ä¿¡æ¯ï¼Œæ‚¨éœ€è¦å®šä¹‰ä¸€ä¸ªæ–°çš„æ„å›¾ã€‚æˆ‘ä»¬ç§°ä¹‹ä¸º<code>query_knowledge_base</code>ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥å°†<code>ActionQueryKnowledgeBase</code>å¯ä»¥å¤„ç†çš„è¯·æ±‚åˆ†ä¸ºä¸¤ç±»ï¼šï¼ˆ1ï¼‰ç”¨æˆ·æƒ³è¦è·å–ç‰¹å®šç±»å‹çš„å¯¹è±¡çš„åˆ—è¡¨ï¼Œæˆ–è€…ï¼ˆ2ï¼‰ç”¨æˆ·æƒ³è¦äº†è§£å¯¹è±¡çš„ç‰¹å®šå±æ€§ã€‚è¯¥æ„å›¾åº”åŒ…å«è¿™ä¸¤ä¸ªè¯·æ±‚çš„è®¸å¤šå˜ä½“ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">##</span> intent:query_knowledge_base</span>
<span class="token list punctuation">-</span> what <span class="token url">[restaurants](object_type:restaurant)</span> can you recommend?
<span class="token list punctuation">-</span> list some <span class="token url">[restaurants](object_type:restaurant)</span>
<span class="token list punctuation">-</span> can you name some <span class="token url">[restaurants](object_type:restaurant)</span> please?
<span class="token list punctuation">-</span> can you show me some <span class="token url">[restaurant](object_type:restaurant)</span> options
<span class="token list punctuation">-</span> list <span class="token url">[German](cuisine)</span> <span class="token url">[restaurants](object_type:restaurant)</span>
<span class="token list punctuation">-</span> do you have any <span class="token url">[mexican](cuisine)</span> <span class="token url">[restaurants](object_type:restaurant)</span>?
<span class="token list punctuation">-</span> do you know the <span class="token url">[price range](attribute:price-range)</span> of <span class="token url">[that one](mention)</span>?
<span class="token list punctuation">-</span> what <span class="token url">[cuisine](attribute)</span> is <span class="token url">[it](mention)</span>?
<span class="token list punctuation">-</span> do you know what <span class="token url">[cuisine](attribute)</span> the <span class="token url">[last one](mention:LAST)</span> has?
<span class="token list punctuation">-</span> does the <span class="token url">[first one](mention:1)</span> have <span class="token url">[outside seating](attribute:outside-seating)</span>?
<span class="token list punctuation">-</span> what is the <span class="token url">[price range](attribute:price-range)</span> of <span class="token url">[Berlin Burrito Company](restaurant)</span>?
<span class="token list punctuation">-</span> what about <span class="token url">[I due forni](restaurant)</span>?
<span class="token list punctuation">-</span> can you tell me the <span class="token url">[price range](attribute)</span> of <span class="token url">[that restaurant](mention)</span>?
<span class="token list punctuation">-</span> what <span class="token url">[cuisine](attribute)</span> do <span class="token url">[they](mention)</span> have?
 ...</code></pre>
<p>ä¸Šé¢çš„ç¤ºä¾‹ä»…æ˜¾ç¤ºäº†ä¸é¤å…åŸŸç›¸å…³çš„ç¤ºä¾‹ã€‚æ‚¨åº”è¯¥é’ˆå¯¹ç›¸åŒçš„<code>query_knowledge_base</code>æ„å›¾ä¸ºçŸ¥è¯†åº“ä¸­å­˜åœ¨çš„æ¯ç§å¯¹è±¡ç±»å‹æ·»åŠ ç¤ºä¾‹ã€‚</p>
<p>é™¤äº†ä¸ºæ¯ç§æŸ¥è¯¢ç±»å‹æ·»åŠ å„ç§è®­ç»ƒç¤ºä¾‹å¤–ï¼Œæ‚¨è¿˜éœ€è¦åœ¨è®­ç»ƒç¤ºä¾‹ä¸­æŒ‡å®šå’Œæ³¨é‡Šä»¥ä¸‹å®ä½“ï¼š</p>
<ul>
<li><code>object_type</code>æ³¨æ„ï¼šæ¯å½“è®­ç»ƒç¤ºä¾‹ä»æ‚¨çš„çŸ¥è¯†åº“ä¸­å¼•ç”¨ç‰¹å®šçš„å¯¹è±¡ç±»å‹æ—¶ï¼Œéƒ½åº”å°†å¯¹è±¡ç±»å‹æ ‡è®°ä¸ºå®ä½“ã€‚ä½¿ç”¨<a href="#">åŒä¹‰è¯</a>å°†ä¾‹å¦‚æ˜ å°„<code>restaurants</code>ä¸º<code>restaurant</code>ï¼Œä½œä¸ºæ­£ç¡®çš„å¯¹è±¡ç±»å‹ä½œä¸ºçŸ¥è¯†åº“ä¸­çš„é”®åˆ—å‡ºã€‚</li>
<li><code>mention</code>ï¼šå¦‚æœç”¨æˆ·é€šè¿‡â€œç¬¬ä¸€ä¸ªâ€ï¼Œâ€œé‚£ä¸ªâ€æˆ–â€œå®ƒâ€æ¥å¼•ç”¨å¯¹è±¡ï¼Œåˆ™åº”å°†è¿™äº›æœ¯è¯­æ ‡è®°ä¸º<code>mention</code>ã€‚æˆ‘ä»¬è¿˜ä½¿ç”¨åŒä¹‰è¯å°†æŸäº›æåŠå†…å®¹æ˜ å°„åˆ°ç¬¦å·ã€‚æ‚¨å¯ä»¥é€šè¿‡<a href="#">è§£å†³æåŠ</a>æ¥äº†è§£æœ‰å…³å†…å®¹ã€‚</li>
<li><code>attribute</code>æ³¨æ„ï¼šçŸ¥è¯†åº“ä¸­å®šä¹‰çš„æ‰€æœ‰å±æ€§åç§°åº”<code>attribute</code>ä¸NLUæ•°æ®ä¸­çš„åç§°ç›¸åŒã€‚åŒæ ·ï¼Œä½¿ç”¨åŒä¹‰è¯å°†å±æ€§åç§°çš„å˜ä½“æ˜ å°„åˆ°çŸ¥è¯†åº“ä¸­ä½¿ç”¨çš„å˜ä½“ã€‚</li>
</ul>
<p>è¯·è®°ä½å°†è¿™äº›å®ä½“æ·»åŠ åˆ°æ‚¨çš„åŸŸæ–‡ä»¶ä¸­ï¼ˆä½œä¸ºå®ä½“å’Œæ’æ§½ï¼‰ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">entities:
  <span class="token list punctuation">-</span> object_type
  <span class="token list punctuation">-</span> mention
  <span class="token list punctuation">-</span> attribute

slots:
  object_type:
<span class="token code keyword">    type: unfeaturized</span>
  mention:
<span class="token code keyword">    type: unfeaturized</span>
  attribute:
<span class="token code keyword">    type: unfeaturized</span></code></pre>
<h4 id="åˆ›å»ºä¸€ä¸ªæ“ä½œæ¥æŸ¥è¯¢æ‚¨çš„çŸ¥è¯†åº“"><a href="#åˆ›å»ºä¸€ä¸ªæ“ä½œæ¥æŸ¥è¯¢æ‚¨çš„çŸ¥è¯†åº“" class="headerlink" title="åˆ›å»ºä¸€ä¸ªæ“ä½œæ¥æŸ¥è¯¢æ‚¨çš„çŸ¥è¯†åº“"></a>åˆ›å»ºä¸€ä¸ªæ“ä½œæ¥æŸ¥è¯¢æ‚¨çš„çŸ¥è¯†åº“</h4><p>è¦åˆ›å»ºè‡ªå·±çš„çŸ¥è¯†åº“æ“ä½œï¼Œæ‚¨éœ€è¦ç»§æ‰¿<code>ActionQueryKnowledgeBase</code>çŸ¥è¯†åº“å¹¶å°†å…¶ä¼ é€’ç»™çš„æ„é€ å‡½æ•°<code>ActionQueryKnowledgeBase</code>ã€‚</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> rasa_sdk<span class="token punctuation">.</span>knowledge_base<span class="token punctuation">.</span>storage <span class="token keyword">import</span> InMemoryKnowledgeBase
<span class="token keyword">from</span> rasa_sdk<span class="token punctuation">.</span>knowledge_base<span class="token punctuation">.</span>actions <span class="token keyword">import</span> ActionQueryKnowledgeBase

<span class="token keyword">class</span> <span class="token class-name">MyKnowledgeBaseAction</span><span class="token punctuation">(</span>ActionQueryKnowledgeBase<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        knowledge_base <span class="token operator">=</span> InMemoryKnowledgeBase<span class="token punctuation">(</span><span class="token string">"data.json"</span><span class="token punctuation">)</span>
        super<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>knowledge_base<span class="token punctuation">)</span></code></pre>
<p>æ¯å½“åˆ›å»ºæ—¶<code>ActionQueryKnowledgeBase</code>ï¼Œéƒ½éœ€è¦å°†ä¼ é€’<code>KnowledgeBase</code>ç»™æ„é€ å‡½æ•°ã€‚å®ƒå¯ä»¥æ˜¯<code>InMemoryKnowledgeBase</code>æˆ–æ‚¨è‡ªå·±çš„å®ç°<code>KnowledgeBase</code> ï¼ˆè¯·å‚é˜…<a href="#">åˆ›å»ºè‡ªå·±çš„çŸ¥è¯†åº“</a>ï¼‰ã€‚æ‚¨åªèƒ½ä»ä¸€ä¸ªçŸ¥è¯†åº“ä¸­æå–ä¿¡æ¯ï¼Œå› ä¸ºä¸æ”¯æŒåŒæ—¶ä½¿ç”¨å¤šä¸ªçŸ¥è¯†åº“ã€‚</p>
<p>è¿™æ˜¯æ­¤æ“ä½œçš„å…¨éƒ¨ä»£ç ï¼åŠ¨ä½œçš„åç§°æ˜¯<code>action_query_knowledge_base</code>ã€‚ä¸è¦å¿˜è®°å°†å…¶æ·»åŠ åˆ°æ‚¨çš„åŸŸæ–‡ä»¶ä¸­ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">actions:
<span class="token list punctuation">-</span> action<span class="token italic"><span class="token punctuation">_</span>query<span class="token punctuation">_</span></span>knowledge_base</code></pre>
<p>æ³¨æ„</p>
<p>å¦‚æœè¦†ç›–äº†é»˜è®¤çš„åŠ¨ä½œåç§°<code>action_query_knowledge_base</code>ï¼Œä½ éœ€è¦ä»¥ä¸‹ä¸‰ä¸ªunfeaturizedæ’æ§½æ·»åŠ åˆ°æ‚¨çš„åŸŸæ–‡ä»¶ï¼š<code>knowledge_base_objects</code>ï¼Œ<code>knowledge_base_last_object</code>ï¼Œå’Œ <code>knowledge_base_last_object_type</code>ã€‚æ’æ§½ç”±å†…éƒ¨ä½¿ç”¨<code>ActionQueryKnowledgeBase</code>ã€‚å¦‚æœä¿ç•™é»˜è®¤æ“ä½œåç§°ï¼Œè¿™äº›æ’æ§½å°†è‡ªåŠ¨ä¸ºæ‚¨æ·»åŠ ã€‚</p>
<p>æ‚¨è¿˜éœ€è¦ç¡®ä¿å°†ä¸€ä¸ªæ•…äº‹æ·»åŠ åˆ°æ‚¨çš„æ•…äº‹æ–‡ä»¶ä¸­ï¼Œå…¶ä¸­åŒ…æ‹¬æ„å›¾<code>query_knowledge_base</code>å’ŒåŠ¨ä½œ<code>action_query_knowledge_base</code>ã€‚ä¾‹å¦‚ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">##</span> Happy Path</span>
<span class="token list punctuation">*</span> greet
  <span class="token list punctuation">-</span> utter_greet
<span class="token list punctuation">*</span> query<span class="token italic"><span class="token punctuation">_</span>knowledge<span class="token punctuation">_</span></span>base
  <span class="token list punctuation">-</span> action<span class="token italic"><span class="token punctuation">_</span>query<span class="token punctuation">_</span></span>knowledge_base
<span class="token list punctuation">*</span> goodbye
  <span class="token list punctuation">-</span> utter_goodbye</code></pre>
<p>æ‚¨éœ€è¦åšçš„æœ€åä¸€ä»¶äº‹æ˜¯<code>utter_ask_rephrase</code>åœ¨åŸŸæ–‡ä»¶ä¸­å®šä¹‰å“åº”ã€‚å¦‚æœè¯¥æ“ä½œä¸çŸ¥é“å¦‚ä½•å¤„ç†ç”¨æˆ·çš„è¯·æ±‚ï¼Œå®ƒå°†ä½¿ç”¨æ­¤å“åº”æ¥è¦æ±‚ç”¨æˆ·é‡æ–°æªè¾ã€‚ä¾‹å¦‚ï¼Œå°†ä»¥ä¸‹å“åº”æ·»åŠ åˆ°æ‚¨çš„åŸŸæ–‡ä»¶ä¸­ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">utter<span class="token italic"><span class="token punctuation">_</span>ask<span class="token punctuation">_</span></span>rephrase:
<span class="token list punctuation">-</span> text: "Sorry, I'm not sure I understand. Could you rephrase it?"
<span class="token list punctuation">-</span> text: "Could you please rephrase your message? I didn't quite get that."</code></pre>
<p>æ·»åŠ æ‰€æœ‰ç›¸å…³éƒ¨åˆ†åï¼Œè¯¥æ“ä½œç°åœ¨å¯ä»¥æŸ¥è¯¢çŸ¥è¯†åº“ã€‚</p>
<h3 id="å¦‚ä½•å·¥ä½œ"><a href="#å¦‚ä½•å·¥ä½œ" class="headerlink" title="å¦‚ä½•å·¥ä½œ"></a>å¦‚ä½•å·¥ä½œ</h3><p><code>ActionQueryKnowledgeBase</code> æŸ¥çœ‹åœ¨è¯·æ±‚ä¸­é€‰å–çš„å®ä½“ä»¥åŠå…ˆå‰è®¾ç½®çš„å¹¿å‘Šä½ï¼Œä»¥å†³å®šè¦æŸ¥è¯¢çš„å†…å®¹ã€‚</p>
<h4 id="åœ¨çŸ¥è¯†åº“ä¸­æŸ¥è¯¢å¯¹è±¡"><a href="#åœ¨çŸ¥è¯†åº“ä¸­æŸ¥è¯¢å¯¹è±¡" class="headerlink" title="åœ¨çŸ¥è¯†åº“ä¸­æŸ¥è¯¢å¯¹è±¡"></a>åœ¨çŸ¥è¯†åº“ä¸­æŸ¥è¯¢å¯¹è±¡</h4><p>ä¸ºäº†æŸ¥è¯¢çŸ¥è¯†åº“ä¸­çš„ä»»ä½•ç±»å‹çš„å¯¹è±¡ï¼Œç”¨æˆ·çš„è¯·æ±‚éƒ½éœ€è¦åŒ…æ‹¬å¯¹è±¡ç±»å‹ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p>
<ul>
<li>ä½ èƒ½è¯´å‡ºä¸€äº›é¤å…çš„åå­—å—ï¼Ÿ</li>
</ul>
<p>è¿™ä¸ªé—®é¢˜åŒ…æ‹¬æ„Ÿå…´è¶£çš„å¯¹è±¡ç±»å‹ï¼šâ€œé¤å…â€ã€‚æœºå™¨äººéœ€è¦æ‹¾å–è¯¥å®ä½“æ‰èƒ½æå‡ºæŸ¥è¯¢-å¦åˆ™æ“ä½œå°†ä¸çŸ¥é“ç”¨æˆ·æ„Ÿå…´è¶£çš„å¯¹è±¡ã€‚</p>
<p>å½“ç”¨æˆ·è¯´å‡ºç±»ä¼¼çš„å†…å®¹æ—¶ï¼š</p>
<ul>
<li>æˆ‘åœ¨æŸæ—æœ‰å“ªäº›æ„å¤§åˆ©é¤å…é€‰æ‹©ï¼Ÿ</li>
</ul>
<p>ç”¨æˆ·æƒ³è¦è·å¾—ï¼ˆ1ï¼‰æœ‰æ„å¤§åˆ©ç¾é£Ÿå’Œï¼ˆ2ï¼‰ä½äºæŸæ—çš„é¤å…åˆ—è¡¨ã€‚å¦‚æœNERåœ¨ç”¨æˆ·è¯·æ±‚ä¸­æ£€æµ‹åˆ°é‚£äº›å±æ€§ï¼Œåˆ™è¯¥æ“ä½œå°†ä½¿ç”¨é‚£äº›å±æ€§æ¥è¿‡æ»¤åœ¨çŸ¥è¯†åº“ä¸­æ‰¾åˆ°çš„é¤é¦†ã€‚</p>
<p>ä¸ºäº†ä½¿æœºå™¨äººèƒ½å¤Ÿæ£€æµ‹åˆ°è¿™äº›å±æ€§ï¼Œæ‚¨éœ€è¦åœ¨NLUæ•°æ®ä¸­å°†â€œ Italianâ€å’Œâ€œ Berlinâ€æ ‡è®°ä¸ºå®ä½“ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">What <span class="token url">[Italian](cuisine)</span> <span class="token url">[restaurant](object_type)</span> options in <span class="token url">[Berlin](city)</span> do I have?.</code></pre>
<p>å±æ€§çš„åç§°â€œç¾é£Ÿâ€å’Œâ€œåŸå¸‚â€åº”ä¸çŸ¥è¯†åº“ä¸­ä½¿ç”¨çš„åç§°ç›¸åŒã€‚æ‚¨è¿˜éœ€è¦å°†å®ƒä»¬ä½œä¸ºå®ä½“å’Œæ’æ§½æ·»åŠ åˆ°åŸŸæ–‡ä»¶ä¸­ã€‚</p>
<h4 id="åœ¨çŸ¥è¯†åº“ä¸­æŸ¥è¯¢å¯¹è±¡çš„å±æ€§"><a href="#åœ¨çŸ¥è¯†åº“ä¸­æŸ¥è¯¢å¯¹è±¡çš„å±æ€§" class="headerlink" title="åœ¨çŸ¥è¯†åº“ä¸­æŸ¥è¯¢å¯¹è±¡çš„å±æ€§"></a>åœ¨çŸ¥è¯†åº“ä¸­æŸ¥è¯¢å¯¹è±¡çš„å±æ€§</h4><p>å¦‚æœç”¨æˆ·å¸Œæœ›è·å–æœ‰å…³æŸä¸ªå¯¹è±¡çš„ç‰¹å®šä¿¡æ¯ï¼Œåˆ™è¯·æ±‚åº”åŒæ—¶åŒ…å«è¯¥å¯¹è±¡å’Œæ„Ÿå…´è¶£çš„å±æ€§ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç”¨æˆ·é—®ç±»ä¼¼ï¼š</p>
<ul>
<li>æŸæ—å·é¥¼å…¬å¸çš„èœæ˜¯ä»€ä¹ˆï¼Ÿ</li>
</ul>
<p>ç”¨æˆ·æƒ³è¦è·å¾—é¤å…â€œæŸæ—ç…é¥¼åº—å…¬å¸â€ï¼ˆæ„Ÿå…´è¶£çš„å¯¹è±¡ï¼‰çš„â€œç¾é£Ÿâ€ï¼ˆæ„Ÿå…´è¶£çš„å±æ€§ï¼‰ã€‚</p>
<p>NLUè®­ç»ƒæ•°æ®ä¸­åº”å°†æ„Ÿå…´è¶£çš„å±æ€§å’Œå¯¹è±¡æ ‡è®°ä¸ºå®ä½“ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">What is the <span class="token url">[cuisine](attribute)</span> of <span class="token url">[Berlin Burrito Company](restaurant)</span>?</code></pre>
<p>ç¡®ä¿å°†å¯¹è±¡ç±»å‹â€œé¤å…â€ä½œä¸ºå®ä½“å’Œæ’æ§½æ·»åŠ åˆ°åŸŸæ–‡ä»¶ä¸­ã€‚</p>
<h4 id="è§£å†³æåŠ"><a href="#è§£å†³æåŠ" class="headerlink" title="è§£å†³æåŠ"></a>è§£å†³æåŠ</h4><p>æ ¹æ®ä¸Šé¢çš„ç¤ºä¾‹ï¼Œç”¨æˆ·å¯èƒ½å¹¶ä¸æ€»æ˜¯ç”¨ä»–ä»¬çš„åå­—æ¥æŒ‡ä»£é¤é¦†ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡å…¶åç§°å¼•ç”¨æ„Ÿå…´è¶£çš„å¯¹è±¡ï¼Œä¾‹å¦‚â€œ Berlin Burrito Companyâ€ï¼ˆå¯¹è±¡çš„è¡¨ç¤ºå­—ç¬¦ä¸²ï¼‰ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æåŠæ¥å¼•ç”¨å…ˆå‰åˆ—å‡ºçš„å¯¹è±¡ï¼Œä¾‹å¦‚ï¼š</p>
<blockquote>
<p>æ‚¨æåˆ°çš„ç¬¬äºŒå®¶é¤å…çš„èœæ˜¯ä»€ä¹ˆï¼Ÿ</p>
</blockquote>
<p>æˆ‘ä»¬çš„è¡ŒåŠ¨èƒ½å¤Ÿå°†è¿™äº›æåŠè§£å†³ä¸ºçŸ¥è¯†åº“ä¸­çš„å®é™…å¯¹è±¡ã€‚æ›´å…·ä½“åœ°è¯´ï¼Œå®ƒå¯ä»¥è§£å†³ä¸¤ç§æåŠç±»å‹ï¼šï¼ˆ1ï¼‰é¡ºåºæåŠï¼Œä¾‹å¦‚â€œç¬¬ä¸€ä¸ªâ€ï¼Œä»¥åŠï¼ˆ2ï¼‰æåŠï¼Œä¾‹å¦‚â€œ itâ€æˆ–â€œé‚£ä¸ªâ€ã€‚</p>
<p><strong>é¡ºåºæåŠ</strong></p>
<p>å½“ç”¨æˆ·é€šè¿‡å¯¹è±¡åœ¨åˆ—è¡¨ä¸­çš„ä½ç½®å¼•ç”¨å¯¹è±¡æ—¶ï¼Œç§°ä¸ºåºè´¯æåŠã€‚è¿™æ˜¯ä¸€ä¸ªä¾‹å­ï¼š</p>
<ul>
<li>ç”¨æˆ·ï¼šæ‚¨çŸ¥é“æŸæ—çš„å“ªäº›é¤é¦†ï¼Ÿ</li>
<li>Botï¼šæ‰¾åˆ°äº†ä»¥ä¸‹ç±»å‹çš„â€œé¤å…â€å¯¹è±¡ï¼š1ï¼šæˆ‘åº”å¾—2ï¼šPastaBar 3ï¼šæŸæ—ç‰ç±³ç…é¥¼å…¬å¸</li>
<li>ä½¿ç”¨è€…ï¼šç¬¬ä¸€ä¸ªæœ‰æˆ·å¤–åº§ä½å—ï¼Ÿ</li>
</ul>
<p>ç”¨æˆ·ç”¨æœ¯è¯­â€œç¬¬ä¸€ä¸ªâ€æ¥ç§°å‘¼â€œæˆ‘åº”å¾—â€ã€‚å…¶ä»–é¡ºåºæåŠçš„å†…å®¹å¯èƒ½åŒ…æ‹¬â€œç¬¬äºŒä¸ªâ€ï¼Œâ€œæœ€åä¸€ä¸ªâ€ï¼Œâ€œä»»ä½•â€æˆ–â€œ 3â€ã€‚</p>
<p>å½“å‘ç”¨æˆ·å±•ç¤ºå¯¹è±¡åˆ—è¡¨æ—¶ï¼Œé€šå¸¸ä¼šä½¿ç”¨åºè¨€æåŠã€‚ä¸ºäº†è§£å†³å¯¹å®é™…å¯¹è±¡çš„æåŠï¼Œæˆ‘ä»¬ä½¿ç”¨åœ¨<code>KnowledgeBase</code>ç±»ä¸­è®¾ç½®çš„é¡ºåºæåŠæ˜ å°„ ã€‚é»˜è®¤æ˜ å°„å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"1"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> l<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"2"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> l<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"3"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> l<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"4"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> l<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"5"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> l<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"6"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> l<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"7"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> l<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"8"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> l<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"9"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> l<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"10"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> l<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"ANY"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> random.choice(l<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token property">"LAST"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> l<span class="token punctuation">[</span>-<span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span></code></pre>
<p>é¡ºåºæåŠæ˜ å°„å°†å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚â€œ 1â€ï¼‰æ˜ å°„åˆ°åˆ—è¡¨ä¸­çš„å¯¹è±¡ï¼Œä¾‹å¦‚ï¼Œè¡¨ç¤ºç´¢å¼•å¤„çš„å¯¹è±¡ã€‚<code>lambda l: l[0]``0</code></p>
<p>ä¾‹å¦‚ï¼Œç”±äºåºå·æåŠæ˜ å°„ä¸åŒ…å«â€œç¬¬ä¸€ä¸ªâ€æ¡ç›®ï¼Œå› æ­¤ä½¿ç”¨<a href="#">å®ä½“åŒä¹‰è¯</a>å°†NLUæ•°æ®ä¸­çš„â€œç¬¬ä¸€ä¸ªâ€æ˜ å°„åˆ°â€œ 1â€éå¸¸é‡è¦ï¼š</p>
<pre class=" language-markdown"><code class="language-markdown">Does the <span class="token url">[first one](mention:1)</span> have <span class="token url">[outside seating](attribute:outside-seating)</span>?</code></pre>
<p>NERå°†â€œç¬¬ä¸€ä¸ªâ€æ£€æµ‹ä¸ºä¸€ä¸ª<code>mention</code>å®ä½“ï¼Œä½†å°†â€œ 1â€æ”¾å…¥<code>mention</code>æ’æ§½ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„æ“ä½œå¯ä»¥å°†<code>mention</code>ç©ºæ¡£å’Œé¡ºåºæåŠæ˜ å°„ä¸€èµ·ä½¿ç”¨ï¼Œä»¥å°†â€œç¬¬ä¸€ä¸ªâ€è§£æä¸ºå®é™…å¯¹è±¡â€œ I due forniâ€ã€‚</p>
<p>æ‚¨å¯ä»¥é€šè¿‡<code>set_ordinal_mention_mapping()</code>åœ¨<code>KnowledgeBase</code>å®ç°ä¸Š è°ƒç”¨è¯¥å‡½æ•°æ¥è¦†ç›–é¡ºåºæåŠæ˜ å°„ï¼ˆè¯·å‚é˜…<a href="#">è‡ªå®šä¹‰InMemoryKnowledgeBase</a>ï¼‰ã€‚</p>
<p><strong>å…¶ä»–æåŠ</strong></p>
<p>çœ‹ä¸€ä¸‹ä¸‹é¢çš„å¯¹è¯ï¼š</p>
<ul>
<li>ç”¨æˆ·ï¼šPastaBarçš„èœæ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>Botï¼šPastaBaræä¾›æ„å¤§åˆ©ç¾é£Ÿã€‚</li>
<li>ç”¨æˆ·ï¼šå®ƒæœ‰wifiå—ï¼Ÿ</li>
<li>Botï¼šæ˜¯çš„ã€‚</li>
<li>ç”¨æˆ·ï¼šä½ èƒ½ç»™æˆ‘ä¸€ä¸ªåœ°å€å—ï¼Ÿ</li>
</ul>
<p>åœ¨â€œæ˜¯å¦æœ‰wifiå—ï¼Ÿâ€é—®é¢˜ä¸­ï¼Œç”¨æˆ·ä½¿ç”¨â€œ itâ€ä¸€è¯æ¥æŒ‡ä»£â€œ PastaBarâ€ã€‚å¦‚æœNERå°†â€œ itâ€æ£€æµ‹ä¸ºå®ä½“<code>mention</code>ï¼Œåˆ™çŸ¥è¯†åº“æ“ä½œä¼šå°†å…¶è§£æä¸ºå¯¹è¯ä¸­æœ€åæåˆ°çš„å¯¹è±¡â€œ PastaBarâ€ã€‚</p>
<p>åœ¨ä¸‹ä¸€ä¸ªè¾“å…¥ä¸­ï¼Œç”¨æˆ·é—´æ¥å¼•ç”¨å¯¹è±¡â€œ PastaBarâ€ï¼Œè€Œä¸æ˜¯æ˜ç¡®æåŠå®ƒã€‚çŸ¥è¯†åº“æ“ä½œå°†æ£€æµ‹åˆ°ç”¨æˆ·æƒ³è¦è·å–ç‰¹å®šå±æ€§çš„å€¼ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ä¸ºåœ°å€ã€‚å¦‚æœNERæœªæ£€æµ‹åˆ°ä»»ä½•æåŠæˆ–å¯¹è±¡ï¼Œåˆ™è¯¥æ“ä½œå°†å‡å®šç”¨æˆ·æ­£åœ¨å¼•ç”¨æœ€è¿‘æåŠçš„å¯¹è±¡â€œ PastaBarâ€ã€‚</p>
<p>æ‚¨å¯ä»¥é€šè¿‡åœ¨åˆå§‹åŒ–æ“ä½œæ—¶å°†è®¾ç½®<code>use_last_object_mention</code>ä¸ºæ¥ç¦ç”¨æ­¤è¡Œä¸º<code>False</code>ã€‚</p>
<h3 id="å®šåˆ¶"><a href="#å®šåˆ¶" class="headerlink" title="å®šåˆ¶"></a>å®šåˆ¶</h3><h4 id="å®šåˆ¶ActionQueryKnowledgeBase"><a href="#å®šåˆ¶ActionQueryKnowledgeBase" class="headerlink" title="å®šåˆ¶ActionQueryKnowledgeBase"></a>å®šåˆ¶<code>ActionQueryKnowledgeBase</code></h4><p><code>ActionQueryKnowledgeBase</code>å¦‚æœè¦è‡ªå®šä¹‰æ¼«æ¸¸å™¨å¯¹ç”¨æˆ·è¯´çš„è¯ï¼Œå¯ä»¥è¦†ç›–ä»¥ä¸‹ä¸¤ä¸ªåŠŸèƒ½ï¼š</p>
<ul>
<li><code>utter_objects()</code></li>
<li><code>utter_attribute_value()</code></li>
</ul>
<p><code>utter_objects()</code>å½“ç”¨æˆ·è¯·æ±‚å¯¹è±¡åˆ—è¡¨æ—¶ä½¿ç”¨ã€‚ä¸€æ—¦æœºå™¨äººä»çŸ¥è¯†åº“ä¸­æ£€ç´¢äº†å¯¹è±¡ï¼Œå®ƒå°†é»˜è®¤ä»¥ä¸€æ¡æ¶ˆæ¯å“åº”ç”¨æˆ·ï¼Œå…¶æ ¼å¼å¦‚ä¸‹ï¼š</p>
<ul>
<li>æ‰¾åˆ°ä»¥ä¸‹ç±»å‹çš„é¤å…ç±»å‹çš„å¯¹è±¡ï¼š 1ï¼šæˆ‘åº”å¾—çš„ 2ï¼šPastaBar 3ï¼šBerlin Burrito Company</li>
</ul>
<p>æˆ–è€…ï¼Œå¦‚æœæ‰¾ä¸åˆ°ä»»ä½•å¯¹è±¡ï¼Œ</p>
<ul>
<li>æˆ‘æ‰¾ä¸åˆ°â€œé¤å…â€ç±»å‹çš„ä»»ä½•å¯¹è±¡ã€‚</li>
</ul>
<p>å¦‚æœè¦æ›´æ”¹å‘è¯æ ¼å¼ï¼Œåˆ™å¯ä»¥<code>utter_objects()</code>åœ¨æ“ä½œä¸­è¦†ç›–è¯¥æ–¹æ³•ã€‚</p>
<p>è¯¥åŠŸèƒ½<code>utter_attribute_value()</code>ç¡®å®šå½“ç”¨æˆ·è¦æ±‚æœ‰å…³å¯¹è±¡çš„ç‰¹å®šä¿¡æ¯æ—¶ï¼Œæœºå™¨äººä¼šè¯´äº›ä»€ä¹ˆã€‚</p>
<p>å¦‚æœåœ¨çŸ¥è¯†åº“ä¸­æ‰¾åˆ°äº†æ„Ÿå…´è¶£çš„å±æ€§ï¼Œåˆ™æ¼«æ¸¸å™¨å°†ä»¥ä»¥ä¸‹æ–¹å¼å›åº”ï¼š</p>
<ul>
<li>â€œæŸæ—ç‰ç±³ç…é¥¼å…¬å¸â€çš„å±æ€§â€œçƒ¹é¥ªâ€çš„å€¼ä¸ºâ€œå¢¨è¥¿å“¥â€ã€‚</li>
</ul>
<p>å¦‚æœæœªæ‰¾åˆ°æ‰€è¯·æ±‚å±æ€§çš„å€¼ï¼Œåˆ™æ¼«æ¸¸å™¨å°†ä»¥å“åº”</p>
<ul>
<li>æ‰¾ä¸åˆ°å¯¹è±¡â€œ Berlin Burrito Companyâ€çš„å±æ€§â€œ cuisineâ€çš„æœ‰æ•ˆå€¼ã€‚</li>
</ul>
<p>å¦‚æœè¦æ›´æ”¹è‡ªåŠ¨å‘å£°ï¼Œå¯ä»¥è¦†ç›–æ–¹æ³•<code>utter_attribute_value()</code>ã€‚</p>
<blockquote>
<p>æ³¨æ„</p>
<p>æˆ‘ä»¬çš„åšå®¢ä¸Šæœ‰ä¸€ä¸ª<a href="#">æ•™ç¨‹</a>ï¼Œä»‹ç»å¦‚ä½•åœ¨è‡ªå®šä¹‰æ“ä½œä¸­ä½¿ç”¨çŸ¥è¯†åº“ã€‚æœ¬æ•™ç¨‹è¯¦ç»†è§£é‡Šäº†åé¢çš„å®ç° <code>ActionQueryKnowledgeBase</code>ã€‚</p>
</blockquote>
<h4 id="åˆ›å»ºè‡ªå·±çš„çŸ¥è¯†åº“æ“ä½œ"><a href="#åˆ›å»ºè‡ªå·±çš„çŸ¥è¯†åº“æ“ä½œ" class="headerlink" title="åˆ›å»ºè‡ªå·±çš„çŸ¥è¯†åº“æ“ä½œ"></a>åˆ›å»ºè‡ªå·±çš„çŸ¥è¯†åº“æ“ä½œ</h4><p><code>ActionQueryKnowledgeBase</code>åº”è¯¥å¯ä»¥è®©æ‚¨è½»æ¾åœ°å¼€å§‹å°†çŸ¥è¯†åº“é›†æˆåˆ°æ‚¨çš„æ“ä½œä¸­ã€‚ä½†æ˜¯ï¼Œè¯¥æ“ä½œåªèƒ½å¤„ç†ä¸¤ç§ç”¨æˆ·è¯·æ±‚ï¼š</p>
<ul>
<li>ç”¨æˆ·å¸Œæœ›ä»çŸ¥è¯†åº“ä¸­è·å–å¯¹è±¡åˆ—è¡¨</li>
<li>ç”¨æˆ·æƒ³è¦è·å–ç‰¹å®šå¯¹è±¡çš„å±æ€§å€¼</li>
</ul>
<p>è¯¥æ“ä½œæ— æ³•åœ¨çŸ¥è¯†åº“ä¸­æ¯”è¾ƒå¯¹è±¡æˆ–è€ƒè™‘å¯¹è±¡ä¹‹é—´çš„å…³ç³»ã€‚æ­¤å¤–ï¼Œè§£å†³å¯¹è¯ä¸­å¯¹æœ€åæåˆ°çš„å¯¹è±¡çš„ä»»ä½•æåŠå¯èƒ½å¹¶ä¸æ€»æ˜¯æœ€ä½³çš„ã€‚</p>
<p>å¦‚æœè¦å¤„ç†æ›´å¤æ‚çš„ç”¨ä¾‹ï¼Œåˆ™å¯ä»¥ç¼–å†™è‡ªå·±çš„è‡ªå®šä¹‰æ“ä½œã€‚æˆ‘ä»¬åœ¨<code>rasa_sdk.knowledge_base.utils</code> ï¼ˆ<a target="_blank" rel="noopener" href="https://github.com/RasaHQ/rasa-sdk/tree/master/rasa_sdk/knowledge_base/">é“¾æ¥åˆ°ä»£ç </a>ï¼‰ä¸­æ·»åŠ äº†ä¸€äº›å¸®åŠ©ç¨‹åºåŠŸèƒ½ï¼Œä»¥åœ¨å®ç°è‡ªå·±çš„è§£å†³æ–¹æ¡ˆæ—¶ä¸ºæ‚¨æä¾›å¸®åŠ©ã€‚æˆ‘ä»¬å»ºè®®ä½¿ç”¨<code>KnowledgeBase</code>æ¥å£ï¼Œä»¥ä¾¿æ‚¨ä»å¯ä»¥åœ¨<code>ActionQueryKnowledgeBase</code> æ–°çš„è‡ªå®šä¹‰æ“ä½œæ—è¾¹ä½¿ç”¨ã€‚</p>
<p>å¦‚æœæ‚¨ç¼–å†™äº†è§£å†³ä¸Šè¿°ç”¨ä¾‹ä¹‹ä¸€æˆ–æ–°ç”¨ä¾‹çš„çŸ¥è¯†åº“æ“ä½œï¼Œè¯·åŠ¡å¿…åœ¨<a target="_blank" rel="noopener" href="https://forum.rasa.com/">è®ºå›</a>ä¸Šå‘Šè¯‰æˆ‘ä»¬ï¼</p>
<h4 id="è‡ªå®šä¹‰InMemoryKnowledgeBase"><a href="#è‡ªå®šä¹‰InMemoryKnowledgeBase" class="headerlink" title="è‡ªå®šä¹‰InMemoryKnowledgeBase"></a>è‡ªå®šä¹‰<code>InMemoryKnowledgeBase</code></h4><p>è¯¥ç±»<code>InMemoryKnowledgeBase</code>ç»§æ‰¿<code>KnowledgeBase</code>ã€‚æ‚¨å¯ä»¥<code>InMemoryKnowledgeBase</code>é€šè¿‡è¦†ç›–ä»¥ä¸‹åŠŸèƒ½æ¥è‡ªå®šä¹‰æ‚¨çš„ï¼š</p>
<ul>
<li><p><code>get_key_attribute_of_object()</code>ï¼šä¸ºäº†è·Ÿè¸ªç”¨æˆ·æœ€è¿‘åœ¨è°ˆè®ºä»€ä¹ˆå¯¹è±¡ï¼Œæˆ‘ä»¬å°†keyå±æ€§çš„å€¼å­˜å‚¨åœ¨ç‰¹å®šçš„æ’æ§½ä¸­ã€‚æ¯ä¸ªå¯¹è±¡éƒ½åº”å…·æœ‰å”¯ä¸€çš„é”®å±æ€§ï¼Œç±»ä¼¼äºå…³ç³»æ•°æ®åº“ä¸­çš„ä¸»é”®ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ç§å¯¹è±¡ç±»å‹çš„keyå±æ€§çš„åç§°éƒ½è®¾ç½®ä¸º<code>id</code>ã€‚æ‚¨å¯ä»¥é€šè¿‡è°ƒç”¨è¦†ç›–ç‰¹å®šå¯¹è±¡ç±»å‹çš„keyå±æ€§åç§° <code>set_key_attribute_of_object()</code>ã€‚</p>
</li>
<li><p><code>get_representation_function_of_object()</code>ï¼šè®©æˆ‘ä»¬ä¸“æ³¨äºä»¥ä¸‹é¤å…ï¼š</p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Donath"</span><span class="token punctuation">,</span>
    <span class="token property">"cuisine"</span><span class="token operator">:</span> <span class="token string">"Italian"</span><span class="token punctuation">,</span>
    <span class="token property">"outside-seating"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"price-range"</span><span class="token operator">:</span> <span class="token string">"mid-range"</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span></code></pre>
<p>å½“ç”¨æˆ·è¦æ±‚æ¼«æ¸¸å™¨åˆ—å‡ºä»»ä½•æ„å¤§åˆ©é¤å…æ—¶ï¼Œå®ƒä¸éœ€è¦é¤å…çš„æ‰€æœ‰è¯¦ç»†ä¿¡æ¯ã€‚ç›¸åï¼Œæ‚¨æƒ³æä¾›ä¸€ä¸ªæœ‰æ„ä¹‰çš„åç§°æ¥æ ‡è¯†é¤å…-åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¯¹è±¡çš„åç§°å³å¯ã€‚è¯¥å‡½æ•°<code>get_representation_function_of_object()</code>è¿”å›ä¸€ä¸ªlambdaå‡½æ•°ï¼Œè¯¥å‡½æ•°å°†ä¸Šè¿°é¤å…å¯¹è±¡æ˜ å°„ä¸ºå…¶åç§°ã€‚</p>
<pre><code>lambda obj: obj["name"]</code></pre>
<p>æœºå™¨äººåœ¨è°ˆè®ºç‰¹å®šå¯¹è±¡æ—¶éƒ½ä¼šä½¿ç”¨æ­¤åŠŸèƒ½ï¼Œä»¥ä¾¿å‘ç”¨æˆ·æ˜¾ç¤ºè¯¥å¯¹è±¡çš„æœ‰æ„ä¹‰çš„åç§°ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œlambdaå‡½æ•°è¿”å›<code>"name"</code>å¯¹è±¡å±æ€§çš„å€¼ã€‚å¦‚æœæ‚¨çš„å¯¹è±¡æ²¡æœ‰<code>"name"</code>å±æ€§ï¼Œæˆ–è€…è¯¥<code>"name"</code>å¯¹è±¡çš„æ¨¡æ£±ä¸¤å¯ï¼Œåˆ™åº”é€šè¿‡è°ƒç”¨ä¸ºè¯¥å¯¹è±¡ç±»å‹è®¾ç½®ä¸€ä¸ªæ–°çš„lambdaå‡½æ•° <code>set_representation_function_of_object()</code>ã€‚</p>
</li>
<li><p><code>set_ordinal_mention_mapping()</code>ï¼šéœ€è¦é¡ºåºæåŠæ˜ å°„æ‰èƒ½å°†é¡ºåºæåŠï¼ˆä¾‹å¦‚â€œç¬¬äºŒä¸ªâ€ï¼‰è§£æä¸ºåˆ—è¡¨ä¸­çš„å¯¹è±¡ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œåºæ•°æåŠæ˜ å°„å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"1"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> l<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"2"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> l<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"3"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> l<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"4"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> l<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"5"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> l<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"6"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> l<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"7"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> l<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"8"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> l<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"9"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> l<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"10"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> l<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"ANY"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> random.choice(l<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token property">"LAST"</span><span class="token operator">:</span> lambda l<span class="token operator">:</span> l<span class="token punctuation">[</span>-<span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span></code></pre>
<p>æ‚¨å¯ä»¥é€šè¿‡è°ƒç”¨å‡½æ•°å°†å…¶è¦†ç›–<code>set_ordinal_mention_mapping()</code>ã€‚å¦‚æœæ‚¨æƒ³äº†è§£æœ‰å…³å¦‚ä½•ä½¿ç”¨æ­¤æ˜ å°„çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹<a href="#">è§£å†³é—®é¢˜</a>ã€‚</p>
</li>
</ul>
<p>æœ‰å…³ä½¿ç”¨çš„æ–¹æ³•çš„ç¤ºä¾‹å®ç°ï¼Œè¯·å‚è§<a target="_blank" rel="noopener" href="https://github.com/RasaHQ/rasa/blob/master/examples/knowledgebasebot/actions.py">ç¤ºä¾‹bot</a>ï¼Œè¯¥ç¤ºä¾‹<code>InMemoryKnowledgeBase</code>ä½¿ç”¨è¯¥æ–¹æ³•<code>set_representation_function_of_object()</code> è¦†ç›–å¯¹è±¡ç±»å‹â€œ hotelâ€çš„é»˜è®¤è¡¨ç¤ºã€‚<code>InMemoryKnowledgeBase</code>æœ¬èº«çš„å®ç°å¯ä»¥åœ¨ <a target="_blank" rel="noopener" href="https://github.com/RasaHQ/rasa-sdk/tree/master/rasa_sdk/knowledge_base/">rasa-sdk</a>åŒ…ä¸­æ‰¾åˆ°ã€‚</p>
<h4 id="åˆ›å»ºè‡ªå·±çš„çŸ¥è¯†åº“"><a href="#åˆ›å»ºè‡ªå·±çš„çŸ¥è¯†åº“" class="headerlink" title="åˆ›å»ºè‡ªå·±çš„çŸ¥è¯†åº“"></a>åˆ›å»ºè‡ªå·±çš„çŸ¥è¯†åº“</h4><p>å¦‚æœæ‚¨æœ‰æ›´å¤šæ•°æ®ï¼Œæˆ–è€…æƒ³è¦ä½¿ç”¨æ›´å¤æ‚çš„æ•°æ®ç»“æ„ï¼ˆä¾‹å¦‚ï¼Œæ¶‰åŠä¸åŒå¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼‰ï¼Œåˆ™å¯ä»¥åˆ›å»ºè‡ªå·±çš„çŸ¥è¯†åº“å®ç°ã€‚åªæ˜¯ç»§æ‰¿<code>KnowledgeBase</code>å’Œå®æ–½æ–¹æ³•<code>get_objects()</code>ï¼Œ<code>get_object()</code>ä»¥åŠ <code>get_attributes_of_object()</code>ã€‚è¯¥<a target="_blank" rel="noopener" href="https://github.com/RasaHQ/rasa-sdk/tree/master/rasa_sdk/knowledge_base/">çŸ¥è¯†åŸºç¡€ä»£ç </a> æä¾›ä»€ä¹ˆè¿™äº›æ–¹æ³•åº”è¯¥åšçš„æ›´å¤šä¿¡æ¯ã€‚</p>
<p>æ‚¨è¿˜å¯ä»¥é€šè¿‡è°ƒæ•´â€œ<a href="#">è‡ªå®šä¹‰InMemoryKnowledgeBase</a> â€éƒ¨åˆ†ä¸­æåˆ°çš„æ–¹æ³•ï¼Œè¿›ä¸€æ­¥è‡ªå®šä¹‰çŸ¥è¯†åº“ ã€‚</p>
<blockquote>
<p>æ³¨æ„</p>
<p>æˆ‘ä»¬å†™äº†<a href="#">ä¸€ç¯‡åšå®¢æ–‡ç« </a> ï¼Œè§£é‡Šäº†å¦‚ä½•å»ºç«‹è‡ªå·±çš„çŸ¥è¯†åº“ã€‚</p>
</blockquote>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        æ–‡ç« ä½œè€…:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">daiyizheng</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        æ–‡ç« é“¾æ¥:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://yoursite.com/2020/10/05/rasa-wen-dang-zhi-nan-14/">http://yoursite.com/2020/10/05/rasa-wen-dang-zhi-nan-14/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        ç‰ˆæƒå£°æ˜:
                    </i>
                </span>
                <span class="reprint-info">
                    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ¥å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº
                    <a href="/about" target="_blank">daiyizheng</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>å¤åˆ¶æˆåŠŸï¼Œè¯·éµå¾ªæœ¬æ–‡çš„è½¬è½½è§„åˆ™</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">æŸ¥çœ‹</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Rasa/">
                                    <span class="chip bg-color">Rasa</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯åˆ†äº«ï¼</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">èµ</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">ä½ çš„èµè¯†æ˜¯æˆ‘å‰è¿›çš„åŠ¨åŠ›</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">æ”¯ä»˜å®</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">å¾® ä¿¡</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="æ”¯ä»˜å®æ‰“èµäºŒç»´ç ">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="å¾®ä¿¡æ‰“èµäºŒç»´ç ">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    #vcomments textarea {
        box-sizing: border-box;
        background: url("/medias/comment_bg.png") 100% 100% no-repeat;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #4cbf30;
        font-weight: 500;
        text-decoration: none;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>è¯„è®º</span>
    </div>
    <div id="vcomments" class="card-content" style="display: grid">
    </div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="/libs/valine/Valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        appId: '4UATY1Wl6PiOAJtLDeI11JPG-9Nh9j0Va',
        appKey: 'm8JJMe4Ok7crFRmTthEbo48R',
        notify: 'false' === 'true',
        verify: 'false' === 'true',
        visitor: 'true' === 'true',
        avatar: 'mm',
        pageSize: '10',
        lang: 'zh-cn',
        placeholder: 'just go go'
    });
</script>

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;ä¸Šä¸€ç¯‡</div>
            <div class="card">
                <a href="/2020/10/07/ben-di-duan-kou-ying-she-dao-gong-wang-jupyter-wei-li/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/10.jpg" class="responsive-img" alt="æœ¬åœ°ç«¯å£æ˜ å°„åˆ°å…¬ç½‘(jupyterä¸ºä¾‹)">
                        
                        <span class="card-title">æœ¬åœ°ç«¯å£æ˜ å°„åˆ°å…¬ç½‘(jupyterä¸ºä¾‹)</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            å†…ç½‘ç©¿é€
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2020-10-07
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E8%BF%90%E7%BB%B4/" class="post-category">
                                    è¿ç»´
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/ngork/">
                        <span class="chip bg-color">ngork</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                ä¸‹ä¸€ç¯‡&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2020/10/05/chatito-shi-yong-jian-dan-dsl-sheng-cheng-rasa-shu-ju-ji/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/20.jpg" class="responsive-img" alt="Chatito-ä½¿ç”¨ç®€å•DSLç”ŸæˆRasaæ•°æ®é›†">
                        
                        <span class="card-title">Chatito-ä½¿ç”¨ç®€å•DSLç”ŸæˆRasaæ•°æ®é›†</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            Chatitoæ•°æ®ç”Ÿæˆå·¥å…·
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2020-10-05
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/nlp/" class="post-category">
                                    nlp
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Rasa/">
                        <span class="chip bg-color">Rasa</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- ä»£ç å—åŠŸèƒ½ä¾èµ– -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- ä»£ç è¯­è¨€ -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- ä»£ç å—å¤åˆ¶ -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- ä»£ç å—æ”¶ç¼© -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


<!-- ä»£ç å—æŠ˜è¡Œ -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;ç›®å½•</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC æ‚¬æµ®æŒ‰é’®. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* ä¿®å¤æ–‡ç« å¡ç‰‡ div çš„å®½åº¦. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // åˆ‡æ¢TOCç›®å½•å±•å¼€æ”¶ç¼©çš„ç›¸å…³æ“ä½œ.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="song"
                   id="1297742167"
                   fixed='true'
                   autoplay='true'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="year">2019</span>
            <a href="/about" target="_blank">daiyizheng</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;æ€»è®¿é—®é‡:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;æ¬¡
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;æ€»è®¿é—®äººæ•°:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;äºº
            </span>
            
            <br>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/blinkfox" class="tooltipped" target="_blank" data-tooltip="è®¿é—®æˆ‘çš„GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1181062873@qq.com" class="tooltipped" target="_blank" data-tooltip="é‚®ä»¶è”ç³»æˆ‘" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1181062873" class="tooltipped" target="_blank" data-tooltip="QQè”ç³»æˆ‘: 1181062873" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS è®¢é˜…" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- æœç´¢é®ç½©æ¡† -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;æœç´¢</span>
            <input type="search" id="searchInput" name="s" placeholder="è¯·è¾“å…¥æœç´¢çš„å…³é”®å­—"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/search.xml", 'searchInput', 'searchResult');
});
</script>

    <!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
